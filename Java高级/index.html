



<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
        <meta name="author" content="WOC-BUG">
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="ja">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-4.6.3">
    
    
  <title>Lorem ipsum dolor sit amet</title>

    
      <link rel="stylesheet" href="../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans:300,400,400i,700%7CFira+Mono&display=fallback">
        <style>body,input{font-family:"Fira Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Fira Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#_1" tabindex="0" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Android Study Notes" aria-label="Android Study Notes" class="md-header-nav__button md-logo">
          
            <i class="md-icon">school</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Android Study Notes
            </span>
            <span class="md-header-nav__topic">
              
                Java高级
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/WOC-BUG/Android-Study-Notes/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    WOC-BUG/Android-Study-Notes
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href=".." class="md-tabs__link">
          简介
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../Java%E5%9F%BA%E7%A1%80/" class="md-tabs__link md-tabs__link--active">
          Java
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../kotlin%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="md-tabs__link">
          kotlin
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../Android%E5%9F%BA%E7%A1%80/" class="md-tabs__link">
          Android
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../Flutter/" class="md-tabs__link">
          Flutter
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../%E5%A4%A7%E8%AF%9D%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" class="md-tabs__link">
          Design Pattern
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../%E5%B7%A5%E4%BD%9C%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/" class="md-tabs__link">
          实践
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Android Study Notes" class="md-nav__button md-logo">
      
        <i class="md-icon">school</i>
      
    </a>
    Android Study Notes
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/WOC-BUG/Android-Study-Notes/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    WOC-BUG/Android-Study-Notes
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      简介
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        简介
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href=".." title="首页" class="md-nav__link">
      首页
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Java
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Java
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Java%E5%9F%BA%E7%A1%80/" title="Java基础" class="md-nav__link">
      Java基础
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Java%E8%BF%9B%E9%98%B6/" title="Java进阶" class="md-nav__link">
      Java进阶
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Java高级
      </label>
    
    <a href="./" title="Java高级" class="md-nav__link md-nav__link--active">
      Java高级
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    一、网络编程
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    （一）基本概念
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inetaddress" class="md-nav__link">
    （二）InetAddress
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#socket" class="md-nav__link">
    （三）Socket
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-tcp" class="md-nav__link">
    1. TCP编程
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    （1）字节流
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    （2）字符流
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-udp" class="md-nav__link">
    2. UDP编程
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3. 例题
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    （1）例题一
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    （2）例题二
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    二、项目
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    三、反射
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    （一）程序的三个阶段
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_2" class="md-nav__link">
    1. 阶段图
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-class" class="md-nav__link">
    2. Class类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-class" class="md-nav__link">
    3. 获取Class类对象
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1classforname" class="md-nav__link">
    （1）Class.forName("类的全类名")
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2class" class="md-nav__link">
    （2）类名.class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3getclass" class="md-nav__link">
    （3）对象.getClass()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    （4）类加载器
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5class" class="md-nav__link">
    （5）基本数据类型.class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6type" class="md-nav__link">
    （6）基本数据类型的包装类.TYPE
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-class" class="md-nav__link">
    4. 哪些类型有Class对象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5. 类加载过程
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_3" class="md-nav__link">
    （1）静态加载与动态加载
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_2" class="md-nav__link">
    （2）类加载过程图
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    （3）各阶段细节：
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    （二）反射基础语法
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#6-class" class="md-nav__link">
    6. 通过Class创建对象的方法
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    （三）反射性能
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_4" class="md-nav__link">
    1. 对比
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_3" class="md-nav__link">
    2. 优化
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    （四）例题
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_5" class="md-nav__link">
    1. 例一
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_4" class="md-nav__link">
    2. 例二
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Head%20First%20Java/" title="Head First Java" class="md-nav__link">
      Head First Java
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      kotlin
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        kotlin
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../kotlin%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="kotlin学习笔记" class="md-nav__link">
      kotlin学习笔记
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Android
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Android
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Android%E5%9F%BA%E7%A1%80/" title="Android基础" class="md-nav__link">
      Android基础
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../BLE%E4%BD%8E%E5%8A%9F%E8%80%97%E8%93%9D%E7%89%99%E9%80%9A%E4%BF%A1/" title="BLE低功耗蓝牙通信" class="md-nav__link">
      BLE低功耗蓝牙通信
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Flutter
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Flutter
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Flutter/" title="Flutter调研报告" class="md-nav__link">
      Flutter调研报告
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Dart/" title="Dart语言基础" class="md-nav__link">
      Dart语言基础
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Design Pattern
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Design Pattern
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../%E5%A4%A7%E8%AF%9D%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" title="大话设计模式" class="md-nav__link">
      大话设计模式
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      实践
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        实践
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../%E5%B7%A5%E4%BD%9C%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/" title="工作问题记录" class="md-nav__link">
      工作问题记录
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    一、网络编程
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    （一）基本概念
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inetaddress" class="md-nav__link">
    （二）InetAddress
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#socket" class="md-nav__link">
    （三）Socket
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-tcp" class="md-nav__link">
    1. TCP编程
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    （1）字节流
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    （2）字符流
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-udp" class="md-nav__link">
    2. UDP编程
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3. 例题
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    （1）例题一
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    （2）例题二
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    二、项目
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    三、反射
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    （一）程序的三个阶段
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_2" class="md-nav__link">
    1. 阶段图
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-class" class="md-nav__link">
    2. Class类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-class" class="md-nav__link">
    3. 获取Class类对象
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1classforname" class="md-nav__link">
    （1）Class.forName("类的全类名")
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2class" class="md-nav__link">
    （2）类名.class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3getclass" class="md-nav__link">
    （3）对象.getClass()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    （4）类加载器
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5class" class="md-nav__link">
    （5）基本数据类型.class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6type" class="md-nav__link">
    （6）基本数据类型的包装类.TYPE
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-class" class="md-nav__link">
    4. 哪些类型有Class对象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5. 类加载过程
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_3" class="md-nav__link">
    （1）静态加载与动态加载
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_2" class="md-nav__link">
    （2）类加载过程图
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    （3）各阶段细节：
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    （二）反射基础语法
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#6-class" class="md-nav__link">
    6. 通过Class创建对象的方法
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    （三）反射性能
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_4" class="md-nav__link">
    1. 对比
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_3" class="md-nav__link">
    2. 优化
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    （四）例题
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_5" class="md-nav__link">
    1. 例一
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_4" class="md-nav__link">
    2. 例二
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/WOC-BUG/Android-Study-Notes/edit/master/docs/Java高级.md" title="编辑此页" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Java高级</h1>
                
                <h2 id="_1">一、网络编程<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<h3 id="_2">（一）基本概念<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p><strong>网络：</strong>两台/多台设备通过物理设备连接起来。</p>
<p><strong>网络编程：</strong>数据通过网络从一台设备传输到另一台设备。</p>
<p><code>java.net</code>包提供了一系列类、接口，用于实现网络通信。</p>
<p><strong>ip地址：</strong>唯一标识网络中的每一台计算机。</p>
<p><code>ipv6</code>的长度是<code>ipv4</code>的四倍，为128字节，并用16进制表示。</p>
<p><img alt="" src="../img/ipv4.png" /></p>
<p><strong>域名：</strong><a href="http://www.baidu.com">www.baidu.com</a></p>
<p><strong>端口号：</strong>标识计算机上某个特定的网络程序。（网络开发中，尽量不要使用 <span><span class="MathJax_Preview">0-1024</span><script type="math/tex">0-1024</script></span> 的端口，因为他们基本已经被知名的服务占用）</p>
<p><strong>客户端和服务端均使用端口进行监听，客户端的端口是由<code>TCP/IP</code>来分配的随机端口，而服务端的端口是双方指定的。</strong></p>
<p><strong>协议：</strong></p>
<p><img alt="" src="../img/OSI.png" /></p>
<p><strong>TCP：</strong></p>
<ol>
<li>传输控制协议；</li>
<li>先建立TCP连接才能使用，传输前采用“三次握手”的方式，是可靠的；</li>
<li>TCP协议间通信的两个进程：客户端、服务端；</li>
<li>在连接中可进行大数据量的传输；</li>
<li>传输完毕后需要释放连接，效率低。</li>
</ol>
<p><strong>UDP：</strong></p>
<ol>
<li>用户数据报协议；</li>
<li>数据、源、目的三者封装成数据包，无需建立连接，是不可靠的；</li>
<li>数据报大小限制在<span><span class="MathJax_Preview">64K</span><script type="math/tex">64K</script></span>以内；</li>
<li>无连接，速度快。</li>
</ol>
<p><strong>控制台命令：</strong></p>
<p><code>ipconfig</code>：查看主机的<code>ip</code>情况；</p>
<p><code>netstat -an</code>：查看主机网络状况，包括端口监听情况和网络连接情况；</p>
<p><code>netstat -anb</code>：查看主机网络状况，包括监听情况、网络连接情况、监听程序；</p>
<p><code>netstat -anb | more</code>：可以分页显示；</p>
<p><code>netstat -anb | find /i "8888"</code>：从结果中筛选包含<code>8888</code>关键字的项。</p>
<p><img alt="" src="../img/netstat.png" /></p>
<h3 id="inetaddress">（二）InetAddress<a class="headerlink" href="#inetaddress" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 获取本机的InetAddress对象</span>
<span class="n">InetAddress</span> <span class="n">localHost</span> <span class="o">=</span> <span class="n">InetAddress</span><span class="p">.</span><span class="na">getLocalHost</span><span class="p">();</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">localHost</span><span class="p">);</span>  <span class="c1">// DESKTOP-U75NRR3/192.168.137.1</span>

<span class="c1">// 根据指定主机名获取InetAddress对象</span>
<span class="n">InetAddress</span> <span class="n">host</span> <span class="o">=</span> <span class="n">InetAddress</span><span class="p">.</span><span class="na">getByName</span><span class="p">(</span><span class="s">&quot;www.baidu.com&quot;</span><span class="p">);</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">host</span><span class="p">);</span>   <span class="c1">// www.baidu.com/110.242.68.4</span>

<span class="c1">// 根据InetAddress对象获取域名、ip地址</span>
<span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">host</span><span class="p">.</span><span class="na">getHostName</span><span class="p">();</span>
<span class="n">String</span> <span class="n">address</span> <span class="o">=</span> <span class="n">host</span><span class="p">.</span><span class="na">getHostAddress</span><span class="p">();</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s">&quot;\n&quot;</span> <span class="o">+</span> <span class="n">address</span><span class="p">);</span>
<span class="c1">// www.baidu.com</span>
<span class="c1">// 110.242.68.4</span>
</code></pre></div>
</td></tr></table>
<h3 id="socket">（三）Socket<a class="headerlink" href="#socket" title="Permanent link">&para;</a></h3>
<p><code>Socket</code>是两台机器间通信的端点，网络通信实际上就是<code>Socket</code>通信。</p>
<p>它允许程序把网络当场一个流，数据在两个<code>Socket</code>之间通过<code>IO</code>流传输（<code>socket.getInputStream()</code>和<code>socket.getOutputStream()</code>）。</p>
<h4 id="1-tcp">1. TCP编程<a class="headerlink" href="#1-tcp" title="Permanent link">&para;</a></h4>
<h5 id="1">（1）字节流<a class="headerlink" href="#1" title="Permanent link">&para;</a></h5>
<p><strong>客户端：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SocketTCPClient</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
        <span class="c1">// 连接本机的9999端口</span>
        <span class="n">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Socket</span><span class="p">(</span><span class="n">InetAddress</span><span class="p">.</span><span class="na">getLocalHost</span><span class="p">(),</span> <span class="mi">9999</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Client linking 9999 port....&quot;</span><span class="p">);</span>

        <span class="c1">// 发送消息</span>
        <span class="n">OutputStream</span> <span class="n">oStream</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">();</span>
        <span class="n">oStream</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="s">&quot;Hello,server!&quot;</span><span class="p">.</span><span class="na">getBytes</span><span class="p">());</span>
        <span class="n">socket</span><span class="p">.</span><span class="na">shutdownOutput</span><span class="p">();</span>    <span class="c1">// 一定要加这句，表示发送结束，否则会卡住</span>

        <span class="c1">// 接收消息</span>
        <span class="n">InputStream</span> <span class="n">iStream</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">();</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">buf</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1024</span><span class="o">]</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">((</span><span class="n">len</span> <span class="o">=</span> <span class="n">iStream</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">buf</span><span class="p">))</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="k">new</span> <span class="n">String</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">len</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="c1">// 关闭</span>
        <span class="n">oStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">iStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">socket</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;客户端退出&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><strong>服务端：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SocketTCPServer</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
        <span class="c1">// ServerSocket可以创建多个socket，被多个客户端连接</span>
        <span class="c1">// 9999端口不能被占用</span>
        <span class="n">ServerSocket</span> <span class="n">serverSocket</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ServerSocket</span><span class="p">(</span><span class="mi">9999</span><span class="p">);</span>

        <span class="c1">// 没有客户端连接9999端口时会阻塞，否则会返回socket对象</span>
        <span class="n">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="n">serverSocket</span><span class="p">.</span><span class="na">accept</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Server listening 9999 port...&quot;</span><span class="p">);</span>

        <span class="c1">// 接收消息</span>
        <span class="n">InputStream</span> <span class="n">iStream</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">();</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">buf</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1024</span><span class="o">]</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">((</span><span class="n">len</span> <span class="o">=</span> <span class="n">iStream</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">buf</span><span class="p">))</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="k">new</span> <span class="n">String</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">len</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="c1">// 回复消息</span>
        <span class="n">OutputStream</span> <span class="n">oStream</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">();</span>
        <span class="n">oStream</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="s">&quot;Hello,client!&quot;</span><span class="p">.</span><span class="na">getBytes</span><span class="p">());</span>
        <span class="n">socket</span><span class="p">.</span><span class="na">shutdownOutput</span><span class="p">();</span>    <span class="c1">// 一定要加这句，表示发送结束，否则会卡住</span>

        <span class="c1">// 关闭</span>
        <span class="n">iStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">oStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">socket</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">serverSocket</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;服务端退出&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h5 id="2">（2）字符流<a class="headerlink" href="#2" title="Permanent link">&para;</a></h5>
<p>需要使用转换流，将字节流转为字符流。</p>
<p><strong>客户端：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SocketTCPClient</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
        <span class="n">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Socket</span><span class="p">(</span><span class="n">InetAddress</span><span class="p">.</span><span class="na">getLocalHost</span><span class="p">(),</span> <span class="mi">9999</span><span class="p">);</span>

        <span class="c1">// 转换流：OutputStream 转 Writer</span>
        <span class="n">OutputStream</span> <span class="n">oStream</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">();</span>
        <span class="n">OutputStreamWriter</span> <span class="n">osWriter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OutputStreamWriter</span><span class="p">(</span><span class="n">oStream</span><span class="p">);</span>
        <span class="n">BufferedWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedWriter</span><span class="p">(</span><span class="n">osWriter</span><span class="p">);</span>

        <span class="n">writer</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="s">&quot;Hello, Server!&quot;</span><span class="p">);</span>
        <span class="n">writer</span><span class="p">.</span><span class="na">newLine</span><span class="p">();</span>
        <span class="n">writer</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="s">&quot;嘤嘤嘤...&quot;</span><span class="p">);</span>
        <span class="n">writer</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span>
        <span class="n">socket</span><span class="p">.</span><span class="na">shutdownOutput</span><span class="p">();</span>    <span class="c1">// 一定要加这行，否则服务端会一直等待接收信息</span>

        <span class="c1">// 转换流：InputStream 转 Reader</span>
        <span class="n">InputStream</span> <span class="n">iStream</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">();</span>
        <span class="n">InputStreamReader</span> <span class="n">isReader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InputStreamReader</span><span class="p">(</span><span class="n">iStream</span><span class="p">);</span>
        <span class="n">BufferedReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="p">(</span><span class="n">isReader</span><span class="p">);</span>

        <span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="n">reader</span><span class="p">.</span><span class="na">readLine</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>

        <span class="n">reader</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">writer</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">socket</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;客户端退出&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><strong>服务端：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SocketTCPServer</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
        <span class="n">ServerSocket</span> <span class="n">serverSocket</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ServerSocket</span><span class="p">(</span><span class="mi">9999</span><span class="p">);</span>
        <span class="n">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="n">serverSocket</span><span class="p">.</span><span class="na">accept</span><span class="p">();</span>

        <span class="c1">// 转换流：InputStream 转 Reader</span>
        <span class="n">InputStream</span> <span class="n">iStream</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">();</span>
        <span class="n">InputStreamReader</span> <span class="n">isReader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InputStreamReader</span><span class="p">(</span><span class="n">iStream</span><span class="p">);</span>
        <span class="n">BufferedReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="p">(</span><span class="n">isReader</span><span class="p">);</span>

        <span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">((</span><span class="n">str</span> <span class="o">=</span> <span class="n">reader</span><span class="p">.</span><span class="na">readLine</span><span class="p">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>

        <span class="c1">// 转换流：OutputStream 转 Writer</span>
        <span class="n">OutputStream</span> <span class="n">oStream</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">();</span>
        <span class="n">OutputStreamWriter</span> <span class="n">osWriter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OutputStreamWriter</span><span class="p">(</span><span class="n">oStream</span><span class="p">);</span>
        <span class="n">BufferedWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedWriter</span><span class="p">(</span><span class="n">osWriter</span><span class="p">);</span>

        <span class="n">writer</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="s">&quot;Hello,client!&quot;</span><span class="p">);</span>
        <span class="n">writer</span><span class="p">.</span><span class="na">newLine</span><span class="p">();</span>
        <span class="n">writer</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span>

        <span class="n">writer</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">reader</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">socket</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">serverSocket</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;服务端退出&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h4 id="2-udp">2. UDP编程<a class="headerlink" href="#2-udp" title="Permanent link">&para;</a></h4>
<p>数据、<code>ip</code>、对象等都被封装在<code>DatagramPacket</code>对象中，没有客户端、服务端之说，只有数据的发送端和接收端。</p>
<p><strong>发送方：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UDPSender</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
        <span class="c1">// 由于UDP既可以发送数据，又可以接收数据；</span>
        <span class="c1">// 而本程序的发送和接收端都在同一设备上；</span>
        <span class="c1">// 所以两边设置的端口最好不一样，便于区分。</span>
        <span class="n">DatagramSocket</span> <span class="n">socket</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DatagramSocket</span><span class="p">(</span><span class="mi">9998</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;发送方监听9998端口....&quot;</span><span class="p">);</span>

        <span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="s">&quot;bro,拉面以go贼?&quot;</span><span class="p">;</span>
        <span class="c1">// 由于本程序的发送和接收端都在同一设备上，所以可以使用 InetAddress.getLocalHost()</span>
        <span class="c1">// 但是在一般应用场景中，还是建议使用 InetAddress.getByName(&quot;&quot;)</span>
        <span class="n">DatagramPacket</span> <span class="n">packet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DatagramPacket</span><span class="p">(</span><span class="n">str</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(),</span>
                <span class="n">str</span><span class="p">.</span><span class="na">getBytes</span><span class="p">().</span><span class="na">length</span><span class="p">,</span>
                <span class="n">InetAddress</span><span class="p">.</span><span class="na">getByName</span><span class="p">(</span><span class="s">&quot;192.168.137.1&quot;</span><span class="p">),</span>
                <span class="mi">9999</span><span class="p">);</span>  <span class="c1">// 注意发送中文时的长度，一定是经过编码后的长度</span>
        <span class="n">socket</span><span class="p">.</span><span class="na">send</span><span class="p">(</span><span class="n">packet</span><span class="p">);</span>

        <span class="c1">// 接收回复</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">data</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1024</span><span class="o">]</span><span class="p">;</span>
        <span class="n">packet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DatagramPacket</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">.</span><span class="na">length</span><span class="p">);</span> <span class="c1">// 这里一定要重新new一个，否则接收的数据长度不一定对</span>
        <span class="n">socket</span><span class="p">.</span><span class="na">receive</span><span class="p">(</span><span class="n">packet</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">packet</span><span class="p">.</span><span class="na">getLength</span><span class="p">();</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">packet</span><span class="p">.</span><span class="na">getData</span><span class="p">();</span>
        <span class="n">String</span> <span class="n">msg</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;接收数据长度：&quot;</span> <span class="o">+</span> <span class="n">len</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;接收回复：&quot;</span> <span class="o">+</span> <span class="n">msg</span><span class="p">);</span>

        <span class="n">socket</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;发送端退出&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><strong>接收方：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UDPReceiver</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
        <span class="n">DatagramSocket</span> <span class="n">socket</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DatagramSocket</span><span class="p">(</span><span class="mi">9999</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;接收方监听9999端口....&quot;</span><span class="p">);</span>

        <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">64</span> <span class="o">*</span> <span class="mi">1024</span><span class="o">]</span><span class="p">;</span> <span class="c1">// UDP包最大为64K</span>
        <span class="n">DatagramPacket</span> <span class="n">packet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DatagramPacket</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span> <span class="n">bytes</span><span class="p">.</span><span class="na">length</span><span class="p">);</span>

        <span class="c1">// 接收信息，填充到packet中</span>
        <span class="c1">// 如果没有数据，将会阻塞，一直等待接收数据</span>
        <span class="n">socket</span><span class="p">.</span><span class="na">receive</span><span class="p">(</span><span class="n">packet</span><span class="p">);</span>

        <span class="c1">// 拆包</span>
        <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">packet</span><span class="p">.</span><span class="na">getLength</span><span class="p">();</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">data</span> <span class="o">=</span> <span class="n">packet</span><span class="p">.</span><span class="na">getData</span><span class="p">();</span>
        <span class="n">String</span> <span class="n">msg</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;接收数据长度：&quot;</span> <span class="o">+</span> <span class="n">packet</span><span class="p">.</span><span class="na">getLength</span><span class="p">());</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;接收数据：&quot;</span> <span class="o">+</span> <span class="n">msg</span><span class="p">);</span>

        <span class="c1">// 回复消息</span>
        <span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="s">&quot;走走走！&quot;</span><span class="p">;</span>
        <span class="n">packet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DatagramPacket</span><span class="p">(</span><span class="n">str</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(),</span>
                <span class="n">str</span><span class="p">.</span><span class="na">getBytes</span><span class="p">().</span><span class="na">length</span><span class="p">,</span>
                <span class="n">InetAddress</span><span class="p">.</span><span class="na">getByName</span><span class="p">(</span><span class="s">&quot;192.168.137.1&quot;</span><span class="p">),</span>
                <span class="mi">9998</span><span class="p">);</span>
        <span class="n">socket</span><span class="p">.</span><span class="na">send</span><span class="p">(</span><span class="n">packet</span><span class="p">);</span>

        <span class="n">socket</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;接收端退出&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h4 id="3">3. 例题<a class="headerlink" href="#3" title="Permanent link">&para;</a></h4>
<h5 id="1_1">（1）例题一<a class="headerlink" href="#1_1" title="Permanent link">&para;</a></h5>
<p>客户端向服务端发送一张图片，服务端返回消息。</p>
<p><strong>客户端：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
        <span class="n">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Socket</span><span class="p">(</span><span class="n">InetAddress</span><span class="p">.</span><span class="na">getLocalHost</span><span class="p">(),</span> <span class="mi">8888</span><span class="p">);</span>

        <span class="c1">// 创建读取文件</span>
        <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;e:/背景/5t5.jpg&quot;</span><span class="p">;</span>
        <span class="n">BufferedInputStream</span> <span class="n">biStream</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedInputStream</span><span class="p">(</span><span class="k">new</span> <span class="n">FileInputStream</span><span class="p">(</span><span class="n">path</span><span class="p">));</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span> <span class="o">=</span> <span class="n">StreamUtils</span><span class="p">.</span><span class="na">inputStreamToByteArray</span><span class="p">(</span><span class="n">biStream</span><span class="p">);</span>

        <span class="c1">// 获取网络输出流</span>
        <span class="n">OutputStream</span> <span class="n">oStream</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">();</span>
        <span class="n">oStream</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">bytes</span><span class="p">);</span>
        <span class="n">oStream</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span>
        <span class="n">socket</span><span class="p">.</span><span class="na">shutdownOutput</span><span class="p">();</span>

        <span class="c1">// 接收回复信息</span>
        <span class="n">InputStream</span> <span class="n">iStream</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">();</span>
        <span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="n">StreamUtils</span><span class="p">.</span><span class="na">inputStreamToString</span><span class="p">(</span><span class="n">iStream</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>

        <span class="c1">// 关闭流</span>
        <span class="n">iStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">biStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">oStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">socket</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;客户端关闭...&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><strong>服务端：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Server</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
        <span class="n">ServerSocket</span> <span class="n">serverSocket</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ServerSocket</span><span class="p">(</span><span class="mi">8888</span><span class="p">);</span>
        <span class="n">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="n">serverSocket</span><span class="p">.</span><span class="na">accept</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;服务端在8888端口监听...&quot;</span><span class="p">);</span>

        <span class="c1">// 读入byte[]数据</span>
        <span class="n">BufferedInputStream</span> <span class="n">biStream</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedInputStream</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">());</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span> <span class="o">=</span> <span class="n">StreamUtils</span><span class="p">.</span><span class="na">inputStreamToByteArray</span><span class="p">(</span><span class="n">biStream</span><span class="p">);</span>

        <span class="c1">// 输出到文件</span>
        <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="n">Server</span><span class="p">.</span><span class="na">class</span><span class="p">.</span><span class="na">getResource</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">).</span><span class="na">getPath</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;5t5.jpg&quot;</span><span class="p">;</span>
        <span class="n">BufferedOutputStream</span> <span class="n">boStream</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedOutputStream</span><span class="p">(</span><span class="k">new</span> <span class="n">FileOutputStream</span><span class="p">(</span><span class="n">path</span><span class="p">));</span>
        <span class="n">boStream</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">bytes</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;服务端图片接收成功！&quot;</span><span class="p">);</span>

        <span class="c1">// 回复信息</span>
        <span class="n">BufferedWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedWriter</span><span class="p">(</span><span class="k">new</span> <span class="n">OutputStreamWriter</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">()));</span>
        <span class="n">writer</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="s">&quot;服务端：收到!&quot;</span><span class="p">);</span>
        <span class="n">writer</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span>
        <span class="n">socket</span><span class="p">.</span><span class="na">shutdownOutput</span><span class="p">();</span>

        <span class="c1">// 关闭流</span>
        <span class="n">writer</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">boStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">biStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">socket</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">serverSocket</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;服务端关闭...&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><strong>工具类：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">StreamUtils</span> <span class="p">{</span>

    <span class="cm">/**</span>
<span class="cm">     * 输入流转byte[]</span>
<span class="cm">     *</span>
<span class="cm">     * @param iStream 输入流</span>
<span class="cm">     * @return byte[]</span>
<span class="cm">     * @throws IOException 输入输出异常</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">inputStreamToByteArray</span><span class="p">(</span><span class="n">InputStream</span> <span class="n">iStream</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
        <span class="n">ByteArrayOutputStream</span> <span class="n">baoStream</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ByteArrayOutputStream</span><span class="p">();</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">buf</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1024</span><span class="o">]</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">((</span><span class="n">len</span> <span class="o">=</span> <span class="n">iStream</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">buf</span><span class="p">))</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">baoStream</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">array</span> <span class="o">=</span> <span class="n">baoStream</span><span class="p">.</span><span class="na">toByteArray</span><span class="p">();</span>
        <span class="n">baoStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="k">return</span> <span class="n">array</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cm">/**</span>
<span class="cm">     * InputStream转String</span>
<span class="cm">     *</span>
<span class="cm">     * @param iStream 输入流</span>
<span class="cm">     * @return 字符串</span>
<span class="cm">     * @throws IOException 输入输出异常</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">inputStreamToString</span><span class="p">(</span><span class="n">InputStream</span> <span class="n">iStream</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
        <span class="n">BufferedInputStream</span> <span class="n">biStream</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedInputStream</span><span class="p">(</span><span class="n">iStream</span><span class="p">);</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">buf</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1024</span><span class="o">]</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">StringBuilder</span> <span class="n">str</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="p">();</span>
        <span class="k">while</span> <span class="p">((</span><span class="n">len</span> <span class="o">=</span> <span class="n">biStream</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">buf</span><span class="p">))</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">str</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="k">new</span> <span class="n">String</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">len</span><span class="p">)).</span><span class="na">append</span><span class="p">(</span><span class="s">&quot;\n&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">str</span><span class="p">.</span><span class="na">toString</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h5 id="2_1">（2）例题二<a class="headerlink" href="#2_1" title="Permanent link">&para;</a></h5>
<p>客户端向服务器发送要下载的文件名，服务端返回文件，客户端接收并保存。</p>
<p>（工具类<code>StreamUtils</code>同上例）</p>
<p><strong>客户端：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
        <span class="n">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">in</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;请输入文件名：&quot;</span><span class="p">);</span>
        <span class="n">String</span> <span class="n">fileName</span> <span class="o">=</span> <span class="n">scanner</span><span class="p">.</span><span class="na">next</span><span class="p">();</span>

        <span class="n">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Socket</span><span class="p">(</span><span class="n">InetAddress</span><span class="p">.</span><span class="na">getLocalHost</span><span class="p">(),</span> <span class="mi">6666</span><span class="p">);</span>
        <span class="n">OutputStream</span> <span class="n">os</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">();</span>
        <span class="n">os</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">fileName</span><span class="p">.</span><span class="na">getBytes</span><span class="p">());</span>
        <span class="n">os</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span>
        <span class="n">socket</span><span class="p">.</span><span class="na">shutdownOutput</span><span class="p">();</span>

        <span class="c1">// 读取返回的文件</span>
        <span class="n">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">();</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span> <span class="o">=</span> <span class="n">StreamUtils</span><span class="p">.</span><span class="na">inputStreamToByteArray</span><span class="p">(</span><span class="n">is</span><span class="p">);</span>

        <span class="c1">// 保存文件</span>
        <span class="n">BufferedOutputStream</span> <span class="n">bos</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedOutputStream</span><span class="p">(</span><span class="k">new</span> <span class="n">FileOutputStream</span><span class="p">(</span><span class="n">Server</span><span class="p">.</span><span class="na">class</span><span class="p">.</span><span class="na">getResource</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">).</span><span class="na">getPath</span><span class="p">()</span> <span class="o">+</span> <span class="n">fileName</span><span class="p">));</span>
        <span class="n">bos</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">bytes</span><span class="p">);</span>

        <span class="c1">// 关闭流</span>
        <span class="n">bos</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">is</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">os</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">socket</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;客户端退出&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><strong>服务端：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Server</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
        <span class="n">ServerSocket</span> <span class="n">serverSocket</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ServerSocket</span><span class="p">(</span><span class="mi">6666</span><span class="p">);</span>
        <span class="n">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="n">serverSocket</span><span class="p">.</span><span class="na">accept</span><span class="p">();</span>

        <span class="c1">// 获取客户端需求</span>
        <span class="n">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">();</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1024</span><span class="o">]</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">String</span> <span class="n">downloadFileName</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">((</span><span class="n">len</span> <span class="o">=</span> <span class="n">is</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">bytes</span><span class="p">))</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">downloadFileName</span> <span class="o">+=</span> <span class="k">new</span> <span class="n">String</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;下载文件名：&quot;</span> <span class="o">+</span> <span class="n">downloadFileName</span><span class="p">);</span>

        <span class="c1">// 从本地获取文件</span>
        <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;e:/背景/&quot;</span><span class="p">;</span>
        <span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">downloadFileName</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">file</span><span class="p">.</span><span class="na">exists</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">path</span> <span class="o">+=</span> <span class="s">&quot;5t5.jpg&quot;</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">path</span> <span class="o">+=</span> <span class="n">downloadFileName</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">BufferedInputStream</span> <span class="n">bis</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedInputStream</span><span class="p">(</span><span class="k">new</span> <span class="n">FileInputStream</span><span class="p">(</span><span class="n">path</span><span class="p">));</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">data</span> <span class="o">=</span> <span class="n">StreamUtils</span><span class="p">.</span><span class="na">inputStreamToByteArray</span><span class="p">(</span><span class="n">bis</span><span class="p">);</span>

        <span class="c1">// 向客户端发送文件</span>
        <span class="n">BufferedOutputStream</span> <span class="n">bos</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedOutputStream</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">());</span>
        <span class="n">bos</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
        <span class="n">bos</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span>
        <span class="n">socket</span><span class="p">.</span><span class="na">shutdownOutput</span><span class="p">();</span>

        <span class="c1">// 关闭流</span>
        <span class="n">bos</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">bis</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">socket</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">serverSocket</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;服务端退出&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h2 id="_3">二、项目<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<p><a href="https://github.com/WOC-BUG/Java-console-instant-messaging">Java控制台即时通讯系统</a></p>
<p>（注意，不同项目共用类进行网络传输时，该类所在的包名必须完全一致。因为序列化的对象会加上包名信息，直接使用会认为两者是不同的类。）</p>
<h2 id="_4">三、反射<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<h3 id="_5">（一）程序的三个阶段<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<h4 id="1_2">1. 阶段图<a class="headerlink" href="#1_2" title="Permanent link">&para;</a></h4>
<p><img alt="" src="../img/%E7%BC%96%E8%AF%91%E3%80%81%E7%B1%BB%E5%8A%A0%E8%BD%BD%E3%80%81%E8%BF%90%E8%A1%8C%E4%B8%89%E9%98%B6%E6%AE%B5.png" /></p>
<p>​      <code>Class.forName("全类名")</code>                           <code>类名.class</code>                                          <code>对象.getClass()</code></p>
<h4 id="2-class">2. Class类<a class="headerlink" href="#2-class" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><code>Class</code>也继承自<code>Object</code>；</p>
</li>
<li>
<p><code>Class</code>类对象是由系统创建的，而不是<code>new</code>出来的。<code>new</code>和反射的方法创建对象，底层都会进行类加载：</p>
</li>
</ul>
<p><img alt="" src="../img/ClassLoader.loadClass%28%29.png" /></p>
<ul>
<li>
<p>每个类都只会加载一次，在首次创建对象、调用类的静态方法/属性/代码块时；</p>
</li>
<li>
<p>通过<code>Class</code>对象可以得到一个类的所有信息；</p>
</li>
<li>
<p><code>Class</code>对象存放在堆，类的字节码二进制数据存放在方法区，又称为元数据。</p>
</li>
</ul>
<h4 id="3-class">3. 获取<code>Class</code>类对象<a class="headerlink" href="#3-class" title="Permanent link">&para;</a></h4>
<h5 id="1classforname">（1）Class.forName("类的全类名")<a class="headerlink" href="#1classforname" title="Permanent link">&para;</a></h5>
<p>已知类的全类名，且该类在类路径下，可以使用<code>Class.forName()</code>。可能抛出异常。</p>
<p><strong>适用于场景：</strong>配置文件中，读取类的全路径</p>
<h5 id="2class">（2）类名.class<a class="headerlink" href="#2class" title="Permanent link">&para;</a></h5>
<p>已知具体的类，通过类的<code>class</code>获取，该方式较为可靠。</p>
<p><strong>适用场景：</strong>参数传递</p>
<h5 id="3getclass">（3）对象.getClass()<a class="headerlink" href="#3getclass" title="Permanent link">&para;</a></h5>
<p>获取到的是类的运行类型，因为每个对象都会有引用指向其<code>Class</code>类对象，而<code>Class</code>类对象在将字节码加载到内存时记录了它的真正类型。</p>
<p><strong>适用场景：</strong>有对象实例的情况。</p>
<h5 id="4">（4）类加载器<a class="headerlink" href="#4" title="Permanent link">&para;</a></h5>
<p>在类加载阶段，会通过类加载器获取<code>Class</code>对象</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">Cat</span> <span class="n">cat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cat</span><span class="p">();</span>
<span class="n">ClassLoader</span> <span class="n">classLoader</span> <span class="o">=</span> <span class="n">cat</span><span class="p">.</span><span class="na">getClass</span><span class="p">().</span><span class="na">getClassLoader</span><span class="p">();</span>
<span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">cls</span> <span class="o">=</span> <span class="n">classLoader</span><span class="p">.</span><span class="na">loadClass</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
</code></pre></div>
</td></tr></table>
<h5 id="5class">（5）基本数据类型.class<a class="headerlink" href="#5class" title="Permanent link">&para;</a></h5>
<p>自动装箱成了其包装类。</p>
<h5 id="6type">（6）基本数据类型的包装类.TYPE<a class="headerlink" href="#6type" title="Permanent link">&para;</a></h5>
<p><code>int.class</code> 和 <code>Integer.TYPE</code>得到的Class 对象是同一个</p>
<p><strong>适用场景：</strong>基本数据类型的包装类</p>
<h4 id="4-class">4. 哪些类型有Class对象<a class="headerlink" href="#4-class" title="Permanent link">&para;</a></h4>
<ul>
<li>外部类、成员内部类、静态内部类、局部内部类、匿名内部类</li>
<li>接口</li>
<li>数组</li>
<li>枚举</li>
<li>注解</li>
<li>基本数据类型</li>
<li><code>void</code></li>
<li><code>Class</code>本身</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">Class</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">cls1</span> <span class="o">=</span> <span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">;</span>  <span class="c1">// 外部类</span>
<span class="n">Class</span><span class="o">&lt;</span><span class="n">Serializable</span><span class="o">&gt;</span> <span class="n">cls2</span> <span class="o">=</span> <span class="n">Serializable</span><span class="p">.</span><span class="na">class</span><span class="p">;</span>  <span class="c1">// 接口</span>
<span class="n">Class</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">[][]&gt;</span> <span class="n">cls3</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">[][]</span><span class="p">.</span><span class="na">class</span><span class="p">;</span>    <span class="c1">// 数组</span>
<span class="n">Class</span><span class="o">&lt;</span><span class="n">Thread</span><span class="p">.</span><span class="na">State</span><span class="o">&gt;</span> <span class="n">cls4</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">.</span><span class="na">State</span><span class="p">.</span><span class="na">class</span><span class="p">;</span>  <span class="c1">// 枚举</span>
<span class="n">Class</span><span class="o">&lt;</span><span class="n">Test</span><span class="o">&gt;</span> <span class="n">cls5</span> <span class="o">=</span> <span class="n">Test</span><span class="p">.</span><span class="na">class</span><span class="p">;</span>  <span class="c1">// 注解</span>
<span class="n">Class</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">cls6</span> <span class="o">=</span> <span class="kt">int</span><span class="p">.</span><span class="na">class</span><span class="p">;</span>    <span class="c1">// 基本数据类型</span>
<span class="n">Class</span><span class="o">&lt;</span><span class="n">Void</span><span class="o">&gt;</span> <span class="n">cls7</span> <span class="o">=</span> <span class="kt">void</span><span class="p">.</span><span class="na">class</span><span class="p">;</span>  <span class="c1">// void</span>
<span class="n">Class</span><span class="o">&lt;</span><span class="n">Class</span><span class="o">&gt;</span> <span class="n">cls8</span> <span class="o">=</span> <span class="n">Class</span><span class="p">.</span><span class="na">class</span><span class="p">;</span>    <span class="c1">// Class</span>
</code></pre></div>
</td></tr></table>
<h4 id="5">5. 类加载过程<a class="headerlink" href="#5" title="Permanent link">&para;</a></h4>
<h5 id="1_3">（1）静态加载与动态加载<a class="headerlink" href="#1_3" title="Permanent link">&para;</a></h5>
<p><strong>静态加载：</strong></p>
<p>编译时加载，如果找不到类则报错（即使在分支语句中运行不到，依旧会报错），依赖性较强。</p>
<p><code>new</code>、父类随子类加载、调用静态成员等是静态加载。</p>
<p><strong>动态加载：</strong></p>
<p>运行时加载，如果运行不到，就不会报错，依赖性降低。</p>
<p>反射是动态加载。</p>
<h5 id="2_2">（2）类加载过程图<a class="headerlink" href="#2_2" title="Permanent link">&para;</a></h5>
<p><img alt="" src="../img/%E7%B1%BB%E5%8A%A0%E8%BD%BD.png" /></p>
<p><img alt="" src="../img/%E7%B1%BB%E5%8A%A0%E8%BD%BD2.png" /></p>
<ul>
<li>加载和连接阶段是由<code>JVM</code>完成的。</li>
<li>注意和对象创建阶段区分开，类加载的初始化阶段只与静态成员有关。</li>
</ul>
<h5 id="3_1">（3）各阶段细节：<a class="headerlink" href="#3_1" title="Permanent link">&para;</a></h5>
<ol>
<li>
<p><strong>加载：</strong>将字节码从不同的数据源（<code>class</code>文件、<code>jar</code>包、网络）转化为二进制字节流加载到内存中（即，将数据加载到方法区），并生成一个代表该类的<code>Class</code>对象。</p>
</li>
<li>
<p><strong>连接：</strong></p>
</li>
<li>
<p><strong>验证：</strong>确保<code>Class</code>文件的字节流中的信息符合<code>JVM</code>规范，并且不会危害虚拟机自身安全。包括文件格式验证（是否以魔数<code>oxcafebabe</code>开头（字节码文件的开头是16进制的<code>cafebabe</code>八个字符））、元数据验证、字节码验证、符号引用验证等。</p>
<p>可以使用<code>-Xverify:none</code>来关闭大部分验证，从而缩短虚拟机类加载的时间。</p>
</li>
<li>
<p><strong>准备：</strong>为静态变量分配内存，并初始化值。其中，<code>static</code>类型分配默认值，<code>static final</code>类型直接赋值。</p>
<p><img alt="" src="../img/%E7%B1%BB%E5%8A%A0%E8%BD%BD-%E5%87%86%E5%A4%87%E9%98%B6%E6%AE%B5.png" /></p>
</li>
<li>
<p><strong>解析：</strong>虚拟机将常量池的符号引用替换为直接引用。（逻辑地址转为物理地址）</p>
</li>
<li>
<p><strong>初始化：</strong>执行<clinit>()方法，依次收集类中的所有静态变量的赋值操作、和静态代码块汇总的语句，进行合并，然后再初始化。虚拟机会保证该方法在多线程环境中被正确地加锁、同步（在源码的<code>loadClass()</code>中有·<code>synchronized</code>关键字）。</p>
</li>
</ol>
<h3 id="_6">（二）反射基础语法<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 通过全名获取类对象</span>
<span class="c1">// &lt;?&gt;表示不确定的Java类型，也可以去掉</span>
<span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">cls</span> <span class="o">=</span> <span class="n">Class</span><span class="p">.</span><span class="na">forName</span><span class="p">(</span><span class="s">&quot;com.cuc.rg.reflection.Cat&quot;</span><span class="p">);</span>

<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">cls</span><span class="p">);</span>    <span class="c1">// class com.cuc.rg.reflection.Cat</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">cls</span><span class="p">.</span><span class="na">getClass</span><span class="p">());</span> <span class="c1">// class java.lang.Class</span>


<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">cls</span><span class="p">.</span><span class="na">getName</span><span class="p">()</span><span class="err">）</span><span class="p">;</span>  <span class="c1">// 获取全类名</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">cls</span><span class="p">.</span><span class="na">getSimpleName</span><span class="p">()</span><span class="err">）</span><span class="p">;</span>    <span class="c1">// 获取简单类名</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">cls</span><span class="p">.</span><span class="na">getPackage</span><span class="p">());</span>   <span class="c1">// 获取包信息</span>

<span class="c1">// 创建对象</span>
<span class="n">Object</span> <span class="n">o</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">newInstance</span><span class="p">();</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;o的运行类型&quot;</span> <span class="o">+</span> <span class="n">o</span><span class="p">.</span><span class="na">getClass</span><span class="p">());</span>

<span class="c1">// 获取共有属性</span>
<span class="n">Field</span> <span class="n">age</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">getField</span><span class="p">(</span><span class="s">&quot;age&quot;</span><span class="p">);</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">age</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">o</span><span class="p">));</span>

<span class="c1">// 设置属性</span>
<span class="n">age</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

<span class="c1">// 获取所有公有属性(包括父类)</span>
<span class="n">Field</span><span class="o">[]</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">getFields</span><span class="p">();</span>
<span class="k">for</span> <span class="p">(</span><span class="n">Field</span> <span class="n">field</span> <span class="p">:</span> <span class="n">fields</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">field</span><span class="p">.</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;，&quot;</span> <span class="o">+</span> <span class="n">field</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">cat</span><span class="p">));</span>
<span class="p">}</span>
<span class="c1">// 获取所有属性，包括私有的</span>
<span class="n">Field</span><span class="o">[]</span> <span class="n">declaredFields</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">getDeclaredFields</span><span class="p">();</span>

<span class="c1">//以int形式返回修饰符</span>
<span class="c1">// 0 - 默认修饰符，1 - public，2 - private，4 - protected，8 - static，10 - final</span>
<span class="c1">// 组合关系会直接相加，如 public static 是 9</span>
<span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="n">field</span><span class="p">.</span><span class="na">getModifiers</span><span class="p">();</span> <span class="c1">// 属性类型</span>
<span class="kt">int</span> <span class="n">num2</span> <span class="o">=</span> <span class="n">method</span><span class="p">.</span><span class="na">getModifiers</span><span class="p">();</span>   <span class="c1">// 返回值类型</span>

<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">field</span><span class="p">.</span><span class="na">getType</span><span class="p">());</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">method</span><span class="p">.</span><span class="na">getReturnType</span><span class="p">());</span>

<span class="c1">// 调用方法</span>
<span class="n">Method</span> <span class="n">eat</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">getMethod</span><span class="p">(</span><span class="s">&quot;play&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="n">method</span><span class="p">.</span><span class="na">invoke</span><span class="p">(</span><span class="n">eat</span><span class="p">,</span> <span class="s">&quot;毛线团&quot;</span><span class="p">);</span>  <span class="c1">// 如果有返回值，一律返回Object</span>

<span class="c1">// 获取所有公有方法</span>
<span class="n">Method</span><span class="o">[]</span> <span class="n">methods</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">getMethods</span><span class="p">();</span>

<span class="c1">// 获取所有方法，包括私有的</span>
<span class="n">Method</span><span class="o">[]</span> <span class="n">declaredMethods</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">getDeclaredMethods</span><span class="p">();</span>

<span class="c1">// 获得形参数组信息</span>
<span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">parameterTypes</span> <span class="o">=</span> <span class="n">declaredMethods</span><span class="p">.</span><span class="na">getParameterTypes</span><span class="p">();</span>

<span class="c1">// 无参构造器</span>
<span class="n">Constructor</span> <span class="n">constructor1</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">getConstructor</span><span class="p">();</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">constructor1</span><span class="p">);</span>

<span class="c1">// 有参构造器</span>
<span class="n">Constructor</span> <span class="n">constructor2</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">getConstructor</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">constructor2</span><span class="p">);</span>

<span class="c1">// 获取本类所有构造器，不包含父类</span>
<span class="n">Constructor</span><span class="o">&lt;?&gt;[]</span> <span class="n">declaredConstructors</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">getDeclaredConstructor</span><span class="p">();</span>

<span class="c1">// 构造器的参数信息</span>
<span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">types</span> <span class="o">=</span> <span class="n">declaredConstructor</span><span class="p">.</span><span class="na">getParameterTypes</span><span class="p">();</span>

<span class="c1">// 获取父类信息</span>
<span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">superClass</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">getSuperClass</span><span class="p">();</span>

<span class="c1">// 获取接口信息                 </span>
<span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">interfaces</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">getInterface</span><span class="p">();</span> 

<span class="c1">// 获取注解信息                 </span>
<span class="n">Annotation</span><span class="o">[]</span> <span class="n">annotations</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">getAnnotations</span><span class="p">();</span>    
</code></pre></div>
</td></tr></table>
<h4 id="6-class">6. 通过<code>Class</code>创建对象的方法<a class="headerlink" href="#6-class" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">cls</span> <span class="o">=</span> <span class="n">Class</span><span class="p">.</span><span class="na">forName</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>

<span class="c1">// 1 直接创建，在Java9之后已经被弃用</span>
<span class="n">Object</span> <span class="n">cat1</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">newInstance</span><span class="p">();</span>

<span class="c1">// 2 公有构造器</span>
<span class="n">Constructor</span><span class="o">&lt;?&gt;</span> <span class="n">constructor1</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">getConstructor</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="n">Object</span> <span class="n">cat2</span> <span class="o">=</span> <span class="n">constructor1</span><span class="p">.</span><span class="na">newInstance</span><span class="p">(</span><span class="s">&quot;猫猫&quot;</span><span class="p">);</span>

<span class="c1">// 3 私有构造器</span>
<span class="n">Constructor</span><span class="o">&lt;?&gt;</span> <span class="n">constructor2</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">getDeclaredConstructor</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="kt">int</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="n">constructor2</span><span class="p">.</span><span class="na">setAccessible</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>   <span class="c1">// 允许暴力访问私有构造器，私有属性和方法同理</span>
<span class="n">Object</span> <span class="n">cat3</span> <span class="o">=</span> <span class="n">constructor2</span><span class="p">.</span><span class="na">newInstance</span><span class="p">(</span><span class="s">&quot;猫猫猫&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
</code></pre></div>
</td></tr></table>
<h3 id="_7">（三）反射性能<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<h4 id="1_4">1. 对比<a class="headerlink" href="#1_4" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Index</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">m1</span><span class="p">();</span>
        <span class="n">m2</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="c1">// 普通调用方法</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">m1</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">Cat</span> <span class="n">cat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cat</span><span class="p">();</span>
        <span class="kt">long</span> <span class="n">start</span> <span class="o">=</span> <span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">90000000</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">cat</span><span class="p">.</span><span class="na">eat</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="kt">long</span> <span class="n">end</span> <span class="o">=</span> <span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;m1()耗时：&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;毫秒&quot;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// 反射调用方法</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">m2</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="n">Class</span> <span class="n">cls</span> <span class="o">=</span> <span class="n">Class</span><span class="p">.</span><span class="na">forName</span><span class="p">(</span><span class="s">&quot;com.cuc.rg.reflection.Cat&quot;</span><span class="p">);</span>
            <span class="n">Object</span> <span class="n">o</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">newInstance</span><span class="p">();</span>
            <span class="n">Method</span> <span class="n">eat</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">getMethod</span><span class="p">(</span><span class="s">&quot;eat&quot;</span><span class="p">);</span>

            <span class="kt">long</span> <span class="n">start</span> <span class="o">=</span> <span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">90000000</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">eat</span><span class="p">.</span><span class="na">invoke</span><span class="p">(</span><span class="n">o</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="kt">long</span> <span class="n">end</span> <span class="o">=</span> <span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;m2()耗时：&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;毫秒&quot;</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/* 输出：</span>
<span class="cm">m1()耗时：8毫秒</span>
<span class="cm">m2()耗时：530毫秒</span>
<span class="cm">*/</span>
</code></pre></div>
</td></tr></table>
<h4 id="2_3">2. 优化<a class="headerlink" href="#2_3" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 在反射调用方法时，取消访问检测</span>
<span class="c1">// 能在一定程度上优化效率</span>
<span class="n">eat</span><span class="p">.</span><span class="na">setAccessible</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

<span class="cm">/* 输出：</span>
<span class="cm">m1()耗时：9毫秒</span>
<span class="cm">m2()耗时：232毫秒</span>
<span class="cm">*/</span>
</code></pre></div>
</td></tr></table>
<h3 id="_8">（四）例题<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<h4 id="1_5">1. 例一<a class="headerlink" href="#1_5" title="Permanent link">&para;</a></h4>
<p>使用反射创建<code>PrivateTest</code>对象，修改其私有属性<code>name</code>，并调用<code>getName</code>方法输出。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Index</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="p">{</span>

        <span class="c1">// 构造对象</span>
        <span class="n">Class</span><span class="o">&lt;</span><span class="n">PrivateTest</span><span class="o">&gt;</span> <span class="n">cls</span> <span class="o">=</span> <span class="n">PrivateTest</span><span class="p">.</span><span class="na">class</span><span class="p">;</span>
        <span class="n">Constructor</span><span class="o">&lt;?&gt;</span> <span class="n">constructor</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">getConstructor</span><span class="p">();</span>
        <span class="n">PrivateTest</span> <span class="n">test</span> <span class="o">=</span> <span class="p">(</span><span class="n">PrivateTest</span><span class="p">)</span> <span class="n">constructor</span><span class="p">.</span><span class="na">newInstance</span><span class="p">();</span>

        <span class="c1">// 获得私有属性，并修改</span>
        <span class="n">Field</span> <span class="n">name</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">getDeclaredField</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">);</span>
        <span class="n">name</span><span class="p">.</span><span class="na">setAccessible</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
        <span class="n">name</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="s">&quot;李四&quot;</span><span class="p">);</span>

        <span class="c1">// 获得方法并输出</span>
        <span class="n">Method</span> <span class="n">method</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">getMethod</span><span class="p">(</span><span class="s">&quot;getName&quot;</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">method</span><span class="p">.</span><span class="na">invoke</span><span class="p">(</span><span class="n">test</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">PrivateTest</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="nf">PrivateTest</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;张三&quot;</span><span class="p">;</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="p">;</span>
    <span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h4 id="2_4">2. 例二<a class="headerlink" href="#2_4" title="Permanent link">&para;</a></h4>
<p>使用反射打印<code>File</code>的所有构造器，使用<code>newInstance()</code>获取<code>File</code>对象，并在<code>e</code>盘创建文件。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Index</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="p">{</span>
        <span class="c1">// 打印构造器</span>
        <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">cls</span> <span class="o">=</span> <span class="n">Class</span><span class="p">.</span><span class="na">forName</span><span class="p">(</span><span class="s">&quot;java.io.File&quot;</span><span class="p">);</span>
        <span class="n">Constructor</span><span class="o">&lt;?&gt;[]</span> <span class="n">declaredConstructors</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">getDeclaredConstructors</span><span class="p">();</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">Constructor</span> <span class="n">constructor</span> <span class="p">:</span> <span class="n">declaredConstructors</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">constructor</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// 创建对象</span>
        <span class="n">Constructor</span><span class="o">&lt;?&gt;</span> <span class="n">constructor</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">getDeclaredConstructor</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
        <span class="n">Object</span> <span class="n">file</span> <span class="o">=</span> <span class="n">constructor</span><span class="p">.</span><span class="na">newInstance</span><span class="p">(</span><span class="s">&quot;e:/背景/test.txt&quot;</span><span class="p">);</span>

        <span class="c1">// 调用方法创建文件</span>
        <span class="n">Method</span> <span class="n">createNewFile</span> <span class="o">=</span> <span class="n">cls</span><span class="p">.</span><span class="na">getDeclaredMethod</span><span class="p">(</span><span class="s">&quot;createNewFile&quot;</span><span class="p">);</span>
        <span class="n">createNewFile</span><span class="p">.</span><span class="na">invoke</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>

    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
                
                  
                
                
                  
                  <hr>
                  <div class="md-source-date">
                    <small>
                      
                        最后更新: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">July 16, 2022 10:57:39</span>
                      
                    </small>
                  </div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Java%E8%BF%9B%E9%98%B6/" title="Java进阶" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  上一页
                </span>
                Java进阶
              </span>
            </div>
          </a>
        
        
          <a href="../Head%20First%20Java/" title="Head First Java" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  下一页
                </span>
                Head First Java
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/WOC-BUG" target="_blank" rel="noopener" title="github" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://github.com/YanhuiJessica" target="_blank" rel="noopener" title="github" class="md-footer-social__link fa fa-github"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c33a9706.js"></script>
      
        
        
          
          <script src="../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../assets/javascripts/lunr/lunr.ja.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.2.3",url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>