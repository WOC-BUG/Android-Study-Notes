



<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
        <meta name="author" content="WOC-BUG">
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="ja">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-4.6.3">
    
    
  <title>Lorem ipsum dolor sit amet</title>

    
      <link rel="stylesheet" href="../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans:300,400,400i,700%7CFira+Mono&display=fallback">
        <style>body,input{font-family:"Fira Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Fira Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#_1" tabindex="0" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Android Study Notes" aria-label="Android Study Notes" class="md-header-nav__button md-logo">
          
            <i class="md-icon">school</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Android Study Notes
            </span>
            <span class="md-header-nav__topic">
              
                Java进阶
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/WOC-BUG/Android-Study-Notes/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    WOC-BUG/Android-Study-Notes
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href=".." class="md-tabs__link">
          简介
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../Java%E5%9F%BA%E7%A1%80/" class="md-tabs__link md-tabs__link--active">
          Java
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../kotlin%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="md-tabs__link">
          kotlin
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../Android%E5%9F%BA%E7%A1%80/" class="md-tabs__link">
          Android
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../Flutter/" class="md-tabs__link">
          Flutter
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../%E5%A4%A7%E8%AF%9D%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" class="md-tabs__link">
          Design Pattern
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../%E5%B7%A5%E4%BD%9C%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/" class="md-tabs__link">
          实践
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Android Study Notes" class="md-nav__button md-logo">
      
        <i class="md-icon">school</i>
      
    </a>
    Android Study Notes
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/WOC-BUG/Android-Study-Notes/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    WOC-BUG/Android-Study-Notes
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      简介
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        简介
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href=".." title="首页" class="md-nav__link">
      首页
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Java
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Java
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Java%E5%9F%BA%E7%A1%80/" title="Java基础" class="md-nav__link">
      Java基础
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Java进阶
      </label>
    
    <a href="./" title="Java进阶" class="md-nav__link md-nav__link--active">
      Java进阶
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    一、工具
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    二、抽象
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    三、接口
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    （一）基本概念
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    （二）接口的多态特性
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1. 多态参数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. 多态数组
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3. 接口的多态传递现象
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    （三）继承与接口
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    四、内部类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    （一）局部内部类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    （二）匿名内部类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    （三）成员内部类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    （四）静态内部类
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    五、枚举
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    （一）自定义枚举
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enum" class="md-nav__link">
    （二）enum关键字实现
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    （三）常用方法
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#annotation" class="md-nav__link">
    六、注解（Annotation）
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#override" class="md-nav__link">
    （一）@Override
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deprecated" class="md-nav__link">
    （二）@Deprecated
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#suppresswarning" class="md-nav__link">
    （三）@SuppressWarning
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    （四）元注解
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-retention" class="md-nav__link">
    1. Retention
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-target" class="md-nav__link">
    2. Target
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-documented" class="md-nav__link">
    3. Documented
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-inherited" class="md-nav__link">
    4. Inherited
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    七、异常
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#try-catch" class="md-nav__link">
    （一）try-catch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    （二）异常分类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-error" class="md-nav__link">
    1. Error
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-exception" class="md-nav__link">
    2. Exception
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    （三）异常体系图
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#throws" class="md-nav__link">
    （四）throws
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    （五）自定义异常
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    （六）异常例题
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    八、常用类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    （一）包装类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    1. 装箱与拆箱
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-string" class="md-nav__link">
    2. 包装类与String相互转换
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    3. 例题
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string" class="md-nav__link">
    （二）String类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_2" class="md-nav__link">
    1. 特点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    2. 字符串连接的效率问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-string" class="md-nav__link">
    3. String的内存布局
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4. 例题
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stringbuffer" class="md-nav__link">
    （三）StringBuffer类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_3" class="md-nav__link">
    1. 特点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-stringbuffer" class="md-nav__link">
    2. StringBuffer的内存布局
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-stringbuffer" class="md-nav__link">
    3. StringBuffer常用方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_1" class="md-nav__link">
    4. 例题
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stringbuilder" class="md-nav__link">
    （四）StringBuilder类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    （五）日期类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-datesimpledateformat" class="md-nav__link">
    1. Date与SimpleDateFormat
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-calendar" class="md-nav__link">
    2. Calendar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-jdk8" class="md-nav__link">
    3. JDK8新增第三代日期
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    （六）例题
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_4" class="md-nav__link">
    1. 例一
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_2" class="md-nav__link">
    2. 例二
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    九、集合
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#collection" class="md-nav__link">
    （一）Collection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iterator" class="md-nav__link">
    （二）Iterator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list" class="md-nav__link">
    （三）List
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arraylist" class="md-nav__link">
    （四）ArrayList
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_5" class="md-nav__link">
    1. 扩容关键源码
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_3" class="md-nav__link">
    2. 常用方法
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vector" class="md-nav__link">
    （五）Vector
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linkedlist" class="md-nav__link">
    （六）LinkedList
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set" class="md-nav__link">
    （七）Set
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hashset" class="md-nav__link">
    （八）HashSet
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_6" class="md-nav__link">
    1. 构造器
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_4" class="md-nav__link">
    2. 常用方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-add" class="md-nav__link">
    3. add()方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_2" class="md-nav__link">
    4. 总结
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5. 例题
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linkedhashset" class="md-nav__link">
    （九）LinkedHashSet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#treeset" class="md-nav__link">
    （十）TreeSet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#map" class="md-nav__link">
    （十一）Map
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_7" class="md-nav__link">
    1. 常用方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_5" class="md-nav__link">
    2. 遍历方法
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hashmap" class="md-nav__link">
    （十二）HashMap
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_8" class="md-nav__link">
    1. 容器内元素的数据结构
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-hashmap" class="md-nav__link">
    2. 遍历HashMap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-hashmap" class="md-nav__link">
    3. HashMap内部结构图
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_3" class="md-nav__link">
    4. 添加元素源码
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_1" class="md-nav__link">
    5. 删除元素源码
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    6. 总结
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linkedhashmap" class="md-nav__link">
    （十三）LinkedHashMap
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_9" class="md-nav__link">
    1. 源码分析
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#treemap" class="md-nav__link">
    （十四）TreeMap
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-put" class="md-nav__link">
    1. put()源码分析
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_6" class="md-nav__link">
    2. 例题
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hashtable" class="md-nav__link">
    （十五）Hashtable
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_10" class="md-nav__link">
    1. 扩容机制源码
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#properties" class="md-nav__link">
    （十六）Properties
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    （十七）容器的边遍历边删除
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    十、泛型
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    （一）泛型优点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    （二）使用细节
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    （三） 使用方法
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#java" class="md-nav__link">
    十一、Java绘图
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    （一）基本语法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    （二）键盘事件监听
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    十二、线程
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    （一）并发与并行
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run" class="md-nav__link">
    （二）run()方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    （三）线程实现的方式
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#thread" class="md-nav__link">
    方式一、继承Thread
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runnable" class="md-nav__link">
    方式二、实现Runnable接口
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runnable_1" class="md-nav__link">
    （四） 以Runnable为例的代理模式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    （五）线程终止
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    （六）线程常用方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    （七）用户线程与守护线程
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    （八）线程状态
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synchronized" class="md-nav__link">
    十三、synchronized
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    （一）线程同步
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    （二）用法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    （三）锁分类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_11" class="md-nav__link">
    1. 互斥锁
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_43" class="md-nav__link">
    （四）死锁
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_44" class="md-nav__link">
    （五）释放锁
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_45" class="md-nav__link">
    （六）实例
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_12" class="md-nav__link">
    1. 例一
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_7" class="md-nav__link">
    2. 例二
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#io" class="md-nav__link">
    十四、IO流
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_46" class="md-nav__link">
    （一）文件
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_13" class="md-nav__link">
    1. 文件流
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_8" class="md-nav__link">
    2. 文件操作
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io_1" class="md-nav__link">
    （二）IO流分类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-inputstreamoutputstream" class="md-nav__link">
    1. InputStream与OutputStream
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1fileinputstream" class="md-nav__link">
    （1）FileInputStream
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2fileoutputstream" class="md-nav__link">
    （2）FileOutputStream
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_2" class="md-nav__link">
    （3）文件复制
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-readerwriter" class="md-nav__link">
    2. Reader与Writer
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1filereader" class="md-nav__link">
    （1）FileReader
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2filewriter" class="md-nav__link">
    （2）FileWriter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_3" class="md-nav__link">
    （3）文件复制
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_47" class="md-nav__link">
    （三）节点流和处理流
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-bufferedreaderbufferedwriter" class="md-nav__link">
    1. BufferedReader与BufferedWriter
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1bufferedreader" class="md-nav__link">
    （1）BufferedReader
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2bufferedwriter" class="md-nav__link">
    （2）BufferedWriter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_4" class="md-nav__link">
    （3）文件复制
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-objectinputstreamobjectoutputstream" class="md-nav__link">
    2. ObjectInputStream与ObjectOutputStream
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1objectinputstream" class="md-nav__link">
    （1）ObjectInputStream
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2objectinputstream" class="md-nav__link">
    （2）ObjectInputStream
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_5" class="md-nav__link">
    （3）细节说明
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-inputoutput" class="md-nav__link">
    3. 标准输入输出流Input与Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-inputstreamreaderoutputstreamwriter" class="md-nav__link">
    4. 转换流InputStreamReader与OutputStreamWriter
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1inputstreamreader" class="md-nav__link">
    （1）InputStreamReader
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2outputstreamwriter" class="md-nav__link">
    （2）OutputStreamWriter
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-printstreamprintwriter" class="md-nav__link">
    5. 打印流PrintStream与PrintWriter
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1printstream" class="md-nav__link">
    （1）PrintStream
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2printwriter" class="md-nav__link">
    （2）PrintWriter
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-properties" class="md-nav__link">
    6. Properties
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_48" class="md-nav__link">
    （四）习题
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_14" class="md-nav__link">
    1. 例一
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_9" class="md-nav__link">
    2. 例二
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_6" class="md-nav__link">
    3. 例三
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Java%E9%AB%98%E7%BA%A7/" title="Java高级" class="md-nav__link">
      Java高级
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Head%20First%20Java/" title="Head First Java" class="md-nav__link">
      Head First Java
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      kotlin
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        kotlin
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../kotlin%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="kotlin学习笔记" class="md-nav__link">
      kotlin学习笔记
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Android
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Android
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Android%E5%9F%BA%E7%A1%80/" title="Android基础" class="md-nav__link">
      Android基础
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../BLE%E4%BD%8E%E5%8A%9F%E8%80%97%E8%93%9D%E7%89%99%E9%80%9A%E4%BF%A1/" title="BLE低功耗蓝牙通信" class="md-nav__link">
      BLE低功耗蓝牙通信
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Flutter
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Flutter
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Flutter/" title="Flutter调研报告" class="md-nav__link">
      Flutter调研报告
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Dart/" title="Dart语言基础" class="md-nav__link">
      Dart语言基础
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Design Pattern
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Design Pattern
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../%E5%A4%A7%E8%AF%9D%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" title="大话设计模式" class="md-nav__link">
      大话设计模式
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      实践
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        实践
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../%E5%B7%A5%E4%BD%9C%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/" title="工作问题记录" class="md-nav__link">
      工作问题记录
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    一、工具
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    二、抽象
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    三、接口
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    （一）基本概念
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    （二）接口的多态特性
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1. 多态参数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. 多态数组
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3. 接口的多态传递现象
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    （三）继承与接口
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    四、内部类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    （一）局部内部类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    （二）匿名内部类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    （三）成员内部类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    （四）静态内部类
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    五、枚举
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    （一）自定义枚举
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enum" class="md-nav__link">
    （二）enum关键字实现
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    （三）常用方法
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#annotation" class="md-nav__link">
    六、注解（Annotation）
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#override" class="md-nav__link">
    （一）@Override
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deprecated" class="md-nav__link">
    （二）@Deprecated
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#suppresswarning" class="md-nav__link">
    （三）@SuppressWarning
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    （四）元注解
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-retention" class="md-nav__link">
    1. Retention
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-target" class="md-nav__link">
    2. Target
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-documented" class="md-nav__link">
    3. Documented
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-inherited" class="md-nav__link">
    4. Inherited
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    七、异常
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#try-catch" class="md-nav__link">
    （一）try-catch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    （二）异常分类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-error" class="md-nav__link">
    1. Error
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-exception" class="md-nav__link">
    2. Exception
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    （三）异常体系图
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#throws" class="md-nav__link">
    （四）throws
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    （五）自定义异常
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    （六）异常例题
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    八、常用类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    （一）包装类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    1. 装箱与拆箱
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-string" class="md-nav__link">
    2. 包装类与String相互转换
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    3. 例题
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string" class="md-nav__link">
    （二）String类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_2" class="md-nav__link">
    1. 特点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    2. 字符串连接的效率问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-string" class="md-nav__link">
    3. String的内存布局
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4. 例题
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stringbuffer" class="md-nav__link">
    （三）StringBuffer类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_3" class="md-nav__link">
    1. 特点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-stringbuffer" class="md-nav__link">
    2. StringBuffer的内存布局
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-stringbuffer" class="md-nav__link">
    3. StringBuffer常用方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_1" class="md-nav__link">
    4. 例题
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stringbuilder" class="md-nav__link">
    （四）StringBuilder类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    （五）日期类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-datesimpledateformat" class="md-nav__link">
    1. Date与SimpleDateFormat
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-calendar" class="md-nav__link">
    2. Calendar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-jdk8" class="md-nav__link">
    3. JDK8新增第三代日期
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    （六）例题
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_4" class="md-nav__link">
    1. 例一
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_2" class="md-nav__link">
    2. 例二
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    九、集合
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#collection" class="md-nav__link">
    （一）Collection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iterator" class="md-nav__link">
    （二）Iterator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list" class="md-nav__link">
    （三）List
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arraylist" class="md-nav__link">
    （四）ArrayList
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_5" class="md-nav__link">
    1. 扩容关键源码
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_3" class="md-nav__link">
    2. 常用方法
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vector" class="md-nav__link">
    （五）Vector
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linkedlist" class="md-nav__link">
    （六）LinkedList
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set" class="md-nav__link">
    （七）Set
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hashset" class="md-nav__link">
    （八）HashSet
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_6" class="md-nav__link">
    1. 构造器
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_4" class="md-nav__link">
    2. 常用方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-add" class="md-nav__link">
    3. add()方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_2" class="md-nav__link">
    4. 总结
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5. 例题
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linkedhashset" class="md-nav__link">
    （九）LinkedHashSet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#treeset" class="md-nav__link">
    （十）TreeSet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#map" class="md-nav__link">
    （十一）Map
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_7" class="md-nav__link">
    1. 常用方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_5" class="md-nav__link">
    2. 遍历方法
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hashmap" class="md-nav__link">
    （十二）HashMap
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_8" class="md-nav__link">
    1. 容器内元素的数据结构
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-hashmap" class="md-nav__link">
    2. 遍历HashMap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-hashmap" class="md-nav__link">
    3. HashMap内部结构图
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_3" class="md-nav__link">
    4. 添加元素源码
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_1" class="md-nav__link">
    5. 删除元素源码
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    6. 总结
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linkedhashmap" class="md-nav__link">
    （十三）LinkedHashMap
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_9" class="md-nav__link">
    1. 源码分析
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#treemap" class="md-nav__link">
    （十四）TreeMap
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-put" class="md-nav__link">
    1. put()源码分析
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_6" class="md-nav__link">
    2. 例题
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hashtable" class="md-nav__link">
    （十五）Hashtable
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_10" class="md-nav__link">
    1. 扩容机制源码
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#properties" class="md-nav__link">
    （十六）Properties
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    （十七）容器的边遍历边删除
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    十、泛型
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    （一）泛型优点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    （二）使用细节
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    （三） 使用方法
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#java" class="md-nav__link">
    十一、Java绘图
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    （一）基本语法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    （二）键盘事件监听
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    十二、线程
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    （一）并发与并行
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run" class="md-nav__link">
    （二）run()方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    （三）线程实现的方式
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#thread" class="md-nav__link">
    方式一、继承Thread
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runnable" class="md-nav__link">
    方式二、实现Runnable接口
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runnable_1" class="md-nav__link">
    （四） 以Runnable为例的代理模式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    （五）线程终止
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    （六）线程常用方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    （七）用户线程与守护线程
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    （八）线程状态
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synchronized" class="md-nav__link">
    十三、synchronized
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    （一）线程同步
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    （二）用法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    （三）锁分类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_11" class="md-nav__link">
    1. 互斥锁
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_43" class="md-nav__link">
    （四）死锁
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_44" class="md-nav__link">
    （五）释放锁
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_45" class="md-nav__link">
    （六）实例
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_12" class="md-nav__link">
    1. 例一
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_7" class="md-nav__link">
    2. 例二
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#io" class="md-nav__link">
    十四、IO流
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_46" class="md-nav__link">
    （一）文件
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_13" class="md-nav__link">
    1. 文件流
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_8" class="md-nav__link">
    2. 文件操作
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io_1" class="md-nav__link">
    （二）IO流分类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-inputstreamoutputstream" class="md-nav__link">
    1. InputStream与OutputStream
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1fileinputstream" class="md-nav__link">
    （1）FileInputStream
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2fileoutputstream" class="md-nav__link">
    （2）FileOutputStream
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_2" class="md-nav__link">
    （3）文件复制
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-readerwriter" class="md-nav__link">
    2. Reader与Writer
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1filereader" class="md-nav__link">
    （1）FileReader
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2filewriter" class="md-nav__link">
    （2）FileWriter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_3" class="md-nav__link">
    （3）文件复制
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_47" class="md-nav__link">
    （三）节点流和处理流
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-bufferedreaderbufferedwriter" class="md-nav__link">
    1. BufferedReader与BufferedWriter
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1bufferedreader" class="md-nav__link">
    （1）BufferedReader
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2bufferedwriter" class="md-nav__link">
    （2）BufferedWriter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_4" class="md-nav__link">
    （3）文件复制
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-objectinputstreamobjectoutputstream" class="md-nav__link">
    2. ObjectInputStream与ObjectOutputStream
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1objectinputstream" class="md-nav__link">
    （1）ObjectInputStream
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2objectinputstream" class="md-nav__link">
    （2）ObjectInputStream
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_5" class="md-nav__link">
    （3）细节说明
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-inputoutput" class="md-nav__link">
    3. 标准输入输出流Input与Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-inputstreamreaderoutputstreamwriter" class="md-nav__link">
    4. 转换流InputStreamReader与OutputStreamWriter
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1inputstreamreader" class="md-nav__link">
    （1）InputStreamReader
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2outputstreamwriter" class="md-nav__link">
    （2）OutputStreamWriter
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-printstreamprintwriter" class="md-nav__link">
    5. 打印流PrintStream与PrintWriter
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1printstream" class="md-nav__link">
    （1）PrintStream
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2printwriter" class="md-nav__link">
    （2）PrintWriter
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-properties" class="md-nav__link">
    6. Properties
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_48" class="md-nav__link">
    （四）习题
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_14" class="md-nav__link">
    1. 例一
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_9" class="md-nav__link">
    2. 例二
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_6" class="md-nav__link">
    3. 例三
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/WOC-BUG/Android-Study-Notes/edit/master/docs/Java进阶.md" title="编辑此页" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Java进阶</h1>
                
                <h2 id="_1">一、工具<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p><code>javac</code> 编译工具</p>
<p><code>javap</code> 反编译工具(从<code>class</code> 文件得到<code>java</code>文件)：</p>
<p><img alt="" src="../img/javap_enum.png" /></p>
<h2 id="_2">二、抽象<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>当父类方法不确定具体实现内容时，可以定义其为抽象方法。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Animal</span><span class="p">{</span>
    <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">eat</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><strong>注意：</strong></p>
<ol>
<li>包含抽象方法的类，必须声明为抽象类；</li>
<li>抽象方法没有方法体；</li>
<li>抽象类可以没有抽象方法；</li>
<li><code>abstract</code>只能修饰类和方法；</li>
<li>继承了抽象类的子类，必须实现其父类的所有抽象方法，除非它自己也声明为抽象类；</li>
<li><strong>抽象方法不能使用<code>private</code>、<code>final</code>、<code>static</code>，因为加了这三个关键字的方法无法被重写。</strong></li>
</ol>
<p><strong>应用：模板方法模式</strong></p>
<h2 id="_3">三、接口<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="_4">（一）基本概念<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>实现接口是对<code>java</code>单继承机制的补充，继承是满足<code>is-a</code>的关系，实现接口是满足<code>like-a</code>的关系。</p>
<ul>
<li>
<p><code>Jdk7</code>之前，接口中的所有方法都没有方法体；</p>
</li>
<li>
<p><code>Jdk8</code>之后，接口中可以有静态方法、默认方法（<code>default</code>修饰）；</p>
</li>
<li>
<p>接口中的抽象方法可以不加<code>abstract</code>关键字；</p>
</li>
<li>
<p>一个类可以实现多个接口；</p>
</li>
<li>
<p>接口不能继承类，只能<strong>继承</strong>其他接口，注意是<code>extends</code>关键字；</p>
</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">interface</span> <span class="nc">A</span><span class="p">{}</span>
<span class="kd">interface</span> <span class="nc">B</span><span class="p">{}</span>
<span class="kd">interface</span> <span class="nc">C</span> <span class="kd">extends</span> <span class="n">A</span><span class="p">,</span><span class="n">B</span> <span class="p">{}</span>
</code></pre></div>
</td></tr></table>
<ul>
<li>
<p>接口中的所有方法都是<code>public</code>的；</p>
</li>
<li>
<p>接口本身只能是<code>public</code>或默认的；</p>
</li>
<li>
<p>接口中的属性实际上隐藏了<code>static final</code>修饰符，因此必须初始化；</p>
</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">interface</span> <span class="nc">A</span><span class="p">{</span>
  <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="c1">// 等价于public static final n = 10;</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<ul>
<li>
<p>实现了接口的抽象类，可以不实现接口中的方法；</p>
</li>
<li>
<p><strong>接口在一定程度上实现代码的接口</strong>。</p>
</li>
</ul>
<h3 id="_5">（二）接口的多态特性<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<h4 id="1">1. 多态参数<a class="headerlink" href="#1" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">interface</span> <span class="nc">Usb</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="p">();</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">end</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">Camera</span> <span class="kd">implements</span> <span class="n">Usb</span> <span class="p">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="p">(){</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;相机开始工作&quot;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">stop</span><span class="p">(){</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;相机停止工作&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">Phone</span> <span class="kd">implements</span> <span class="n">Usb</span> <span class="p">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="p">(){</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;手机开始工作&quot;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">stop</span><span class="p">(){</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;手机停止工作&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">Computer</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">work</span><span class="p">(</span><span class="n">Usb</span> <span class="n">usb</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 传入接口</span>
        <span class="n">usb</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
        <span class="n">usb</span><span class="p">.</span><span class="na">stop</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h4 id="2">2. 多态数组<a class="headerlink" href="#2" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">interface</span> <span class="nc">Usb</span><span class="p">{}</span>
<span class="kd">class</span> <span class="nc">Camera</span> <span class="kd">implements</span> <span class="n">Usb</span><span class="p">{}</span>
<span class="kd">class</span> <span class="nc">Phone</span> <span class="kd">implements</span> <span class="n">Usb</span><span class="p">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">call</span><span class="p">(){</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;打电话...&quot;</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Index</span><span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Usb</span><span class="o">[]</span> <span class="n">usbs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Usb</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="p">;</span>
        <span class="n">usbs</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Phone</span><span class="p">();</span>
        <span class="n">usbs</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Camera</span><span class="p">();</span>

        <span class="k">for</span><span class="p">(</span><span class="n">Usb</span> <span class="n">i</span><span class="p">:</span> <span class="n">usbs</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="k">instanceof</span> <span class="n">Phone</span><span class="p">){</span>
                <span class="p">((</span><span class="n">Phone</span><span class="p">)</span><span class="n">i</span><span class="p">).</span><span class="na">call</span><span class="p">();</span> <span class="c1">// 向下转型</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h4 id="3">3. 接口的多态传递现象<a class="headerlink" href="#3" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">interface</span> <span class="nc">IA</span> <span class="p">{</span> 
    <span class="kt">void</span> <span class="nf">hi</span><span class="p">();</span>
<span class="p">}</span>
<span class="kd">interface</span> <span class="nc">IB</span> <span class="kd">extends</span> <span class="n">IA</span> <span class="p">{</span> <span class="p">}</span>
<span class="kd">class</span> <span class="nc">C</span> <span class="kd">implements</span> <span class="n">IB</span> <span class="p">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">hi</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
<span class="p">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Index</span><span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">IA</span> <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="n">C</span><span class="p">();</span>
        <span class="n">a</span><span class="p">.</span><span class="na">hi</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h3 id="_6">（三）继承与接口<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p><strong>继承与接口同时使用时，相同的属性必须明确其含义</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">interface</span> <span class="nc">A</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">B</span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">C</span> <span class="kd">extends</span> <span class="n">B</span> <span class="kd">implements</span> <span class="n">A</span><span class="p">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">printX</span><span class="p">(){</span>
        <span class="c1">// System.out.println(x);  // x is ambiguous</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="na">x</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="kd">super</span><span class="p">.</span><span class="na">x</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h2 id="_7">四、内部类<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<p><strong>类的五大成员：属性、方法、构造器、初始化块、内部类</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">class</span> <span class="nc">OuterOther</span><span class="p">{</span>   <span class="c1">// 外部其他类</span>

<span class="p">}</span>
<span class="kd">class</span> <span class="nc">Outer</span><span class="p">{</span>    <span class="c1">// 外部类</span>
    <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="c1">// 属性</span>
    <span class="n">Outer</span><span class="p">()</span> <span class="p">{</span>   <span class="c1">// 构造器</span>

    <span class="p">}</span>
    <span class="p">{</span>
        <span class="c1">// 初始化块</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="nf">getN</span><span class="p">(){</span> <span class="c1">// 方法</span>
        <span class="k">return</span> <span class="n">n</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">class</span> <span class="nc">Inner</span><span class="p">{</span>    <span class="c1">// 内部类</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h3 id="_8">（一）局部内部类<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">class</span> <span class="nc">OuterOther</span><span class="p">{</span>
    <span class="c1">// 5. 无法访问Inner</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nc">Outer</span><span class="p">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">m1</span><span class="p">()</span> <span class="p">{}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">m2</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">final</span> <span class="kd">class</span> <span class="nc">Inner</span><span class="p">{</span>  <span class="c1">// 3. 作用域仅在m2()中</span>
            <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="c1">// 6. 变量n重名</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">f1</span><span class="p">(){</span>
                <span class="c1">// 1. 直接访问外部类的所有成员</span>
                <span class="n">m1</span><span class="p">();</span>                

                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>  <span class="c1">// 6. 就近原则，输出20</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">n</span><span class="p">);</span> <span class="c1">// 内部类的n</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Outer</span><span class="p">.</span><span class="na">this</span><span class="p">.</span><span class="na">n</span><span class="p">);</span>   <span class="c1">// 6. 外部类的n，this为调用m2()的对象</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="p">{</span>
        <span class="kd">class</span> <span class="nc">Inner</span><span class="p">{</span>    <span class="c1">// 作用域仅在初始化块中</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">f1</span><span class="p">(){</span>
                <span class="n">m1</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">Inner</span> <span class="n">inner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Inner</span><span class="p">();</span> <span class="c1">// 4. 外部类通过创建实例访问</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<ol>
<li>能直接访问外部类的所有成员，包括私有属性；</li>
<li>不能添加访问修饰符，因为它相当于一个局部变量，<code>final</code>、<code>abstract</code>等可以添加；</li>
<li>作用域仅在方法/代码块中；</li>
<li>外部类通过创建内部类的实例调用方法；</li>
<li>外部其它类，不能访问局部内部类（因为它相当于一个局部变量）；</li>
<li>外部类和局部内部类的成员重名时，遵循就近原则，若想访问外部类的成员，可以使用<code>外部类名.this.成员</code>去访问；</li>
</ol>
<h3 id="_9">（二）匿名内部类<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">class</span> <span class="nc">Outer</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">method</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// 编译类型：IA</span>
        <span class="c1">// 运行类型：匿名内部类（底层会分配一个类名Outer$1）</span>
        <span class="n">IA</span> <span class="n">tiger</span> <span class="o">=</span> <span class="k">new</span> <span class="n">IA</span><span class="p">()</span> <span class="p">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">cry</span><span class="p">()</span> <span class="p">{</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;虎啸...&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">};</span>
        <span class="n">tiger</span><span class="p">.</span><span class="na">cry</span><span class="p">();</span>

        <span class="c1">// 编译类型：Father</span>
        <span class="c1">// 运行类型：匿名内部类（底层会分配一个类名Outer$2）</span>
        <span class="n">Father</span> <span class="n">father</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Father</span><span class="p">(</span><span class="s">&quot;Jack&quot;</span><span class="p">){</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="p">(){</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;匿名内部类重写test()&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">father</span><span class="p">.</span><span class="na">test</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">interface</span> <span class="nc">IA</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">cry</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">Father</span><span class="p">{</span>
    <span class="n">Father</span><span class="p">(</span><span class="n">String</span> <span class="n">name</span><span class="p">){</span> <span class="p">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="p">(){</span>

    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<ol>
<li>
<p>能直接访问外部类的所有成员，包括私有的；</p>
</li>
<li>
<p>不能添加访问修饰符，因为它相当于一个局部变量，<code>final</code>可以添加；</p>
</li>
<li>
<p>作用域仅在方法/代码块中；</p>
</li>
<li>
<p>本质是类，同时还是一个对象；</p>
</li>
</ol>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 接上例，也可以直接调用方法</span>
<span class="k">new</span> <span class="n">Father</span><span class="p">(</span><span class="s">&quot;Jack&quot;</span><span class="p">){</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="p">(){</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;匿名内部类重写test()&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}.</span><span class="na">test</span><span class="p">();</span>
</code></pre></div>
</td></tr></table>
<ol>
<li>
<p><code>jdk</code>底层会给匿名内部类分配名字：外部类名$编号；</p>
</li>
<li>
<p>匿名内部类只能使用一次（注意，不是说匿名内部类的对象）；</p>
</li>
<li>
<p>外部其它类，不能访问匿名内部类（因为它相当于一个局部变量）；</p>
</li>
<li>
<p>外部类和匿名内部类的成员重名时，遵循就近原则，若想访问外部类的成员，可以使用<code>外部类名.this.成员</code>去访问；</p>
</li>
<li>
<p>不能重写构造器。</p>
</li>
</ol>
<h3 id="_10">（三）成员内部类<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">class</span> <span class="nc">Outer</span><span class="p">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">Inner</span><span class="p">{</span>
      <span class="kt">void</span> <span class="nf">fun</span><span class="p">(){</span>
          <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">};</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">printInnerFun</span><span class="p">(){</span>
        <span class="n">Inner</span> <span class="n">inner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Inner</span><span class="p">();</span>
        <span class="n">inner</span><span class="p">.</span><span class="na">fun</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<ol>
<li>
<p>能直接访问外部类的所有成员，包括私有的；</p>
</li>
<li>
<p>本质是类，同时也是属性；因此，<strong>可以加访问修饰符，作用域为整个类体</strong>；</p>
</li>
<li>
<p>外部类访问成员内部类，可以通过创建对象；</p>
</li>
<li>
<p>外部其他类访问成员内部类：</p>
</li>
</ol>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 1. 通过外部类创建对象</span>
<span class="n">Outer</span> <span class="n">outer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Outer</span><span class="p">();</span>
<span class="n">Outer</span><span class="p">.</span><span class="na">Inner</span> <span class="n">inner</span> <span class="o">=</span> <span class="n">outer</span><span class="p">.</span><span class="na">new</span> <span class="nf">Inner</span><span class="p">();</span>

<span class="c1">// 2. 在外部类中编写方法，返回内部类对象</span>
<span class="kd">class</span> <span class="nc">Outer</span><span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="kd">public</span> <span class="n">Inner</span> <span class="nf">getInner</span><span class="p">(){</span>
     <span class="k">return</span> <span class="k">new</span> <span class="n">Inner</span><span class="p">();</span>
 <span class="p">}</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<ol>
<li>外部类和成员内部类的成员重名时，遵循就近原则，若想访问外部类的成员，可以使用<code>外部类名.this.成员</code>去访问。</li>
</ol>
<h3 id="_11">（四）静态内部类<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>可以访问外部类的所有静态成员，包括私有的；</p>
</li>
<li>
<p>本质是类，同时也是静态属性；因此，<strong>可以加访问修饰符，作用域为整个类体</strong>；</p>
</li>
<li>
<p>外部类访问静态内部类，可以通过创建对象；</p>
</li>
<li>
<p>外部其他类访问静态内部类：</p>
</li>
</ol>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 1. 通过类名直接访问</span>
<span class="n">Outer</span><span class="p">.</span><span class="na">Inner</span> <span class="n">inner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Outer</span><span class="p">.</span><span class="na">Inner</span><span class="p">();</span>

<span class="c1">//  2. 在外部类中编写方法，返回内部类对象</span>
<span class="kd">class</span> <span class="nc">Outer</span><span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="kd">public</span> <span class="n">Inner</span> <span class="nf">getInner</span><span class="p">(){</span>
     <span class="k">return</span> <span class="k">new</span> <span class="n">Inner</span><span class="p">();</span>
 <span class="p">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Inner</span> <span class="nf">getInner_</span><span class="p">(){</span>
     <span class="k">return</span> <span class="k">new</span> <span class="n">Inner</span><span class="p">();</span>
 <span class="p">}</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<ol>
<li>外部类和成员内部类的成员重名时，遵循就近原则，若想访问外部类的成员，可以使用<code>外部类名.成员</code>去访问。</li>
</ol>
<h2 id="_12">五、枚举<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h2>
<ol>
<li>一组有限常量的集合</li>
<li>不能修改</li>
</ol>
<h3 id="_13">（一）自定义枚举<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">class</span> <span class="nc">Season</span><span class="p">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">detail</span><span class="p">;</span>

    <span class="c1">// 固定几个public static对象</span>
    <span class="c1">// 加入final修饰符优化</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Season</span> <span class="n">SPRING</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Season</span><span class="p">(</span><span class="s">&quot;春天&quot;</span><span class="p">,</span><span class="s">&quot;花&quot;</span><span class="p">);</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Season</span> <span class="n">SUMMER</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Season</span><span class="p">(</span><span class="s">&quot;夏天&quot;</span><span class="p">,</span><span class="s">&quot;西瓜&quot;</span><span class="p">);</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Season</span> <span class="n">AUTUMN</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Season</span><span class="p">(</span><span class="s">&quot;秋天&quot;</span><span class="p">,</span><span class="s">&quot;枫叶&quot;</span><span class="p">);</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Season</span> <span class="n">WINTER</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Season</span><span class="p">(</span><span class="s">&quot;冬天&quot;</span><span class="p">,</span><span class="s">&quot;雪&quot;</span><span class="p">);</span>

    <span class="c1">// 私有化构造器，避免多余的对象产生</span>
    <span class="kd">private</span> <span class="nf">Season</span><span class="p">(</span><span class="n">String</span> <span class="n">name</span><span class="p">,</span><span class="n">String</span> <span class="n">detail</span><span class="p">){</span>
        <span class="k">this</span><span class="p">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">detail</span> <span class="o">=</span> <span class="n">detail</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// 去除set方法，避免修改属性</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getDetail</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">detail</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h3 id="enum">（二）enum关键字实现<a class="headerlink" href="#enum" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">enum</span> <span class="n">Season</span><span class="p">{</span>

    <span class="c1">// 必须写在最前面，且必须用逗号隔开</span>
    <span class="n">SPRING</span><span class="p">(</span><span class="s">&quot;春天&quot;</span><span class="p">,</span><span class="s">&quot;温暖&quot;</span><span class="p">),</span>
    <span class="n">SUMMER</span><span class="p">(</span><span class="s">&quot;夏天&quot;</span><span class="p">,</span><span class="s">&quot;西瓜&quot;</span><span class="p">),</span>
    <span class="n">AUTUMN</span><span class="p">(</span><span class="s">&quot;秋天&quot;</span><span class="p">,</span><span class="s">&quot;凉爽&quot;</span><span class="p">),</span>
    <span class="n">WINTER</span><span class="p">(</span><span class="s">&quot;冬天&quot;</span><span class="p">,</span><span class="s">&quot;雪&quot;</span><span class="p">);</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">detail</span><span class="p">;</span>

    <span class="c1">// 私有化构造器，避免多余的对象产生</span>
    <span class="kd">private</span> <span class="nf">Season</span><span class="p">(</span><span class="n">String</span> <span class="n">name</span><span class="p">,</span><span class="n">String</span> <span class="n">detail</span><span class="p">){</span>
        <span class="k">this</span><span class="p">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">detail</span> <span class="o">=</span> <span class="n">detail</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// 去除set方法，避免修改属性</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getDetail</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">detail</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p>如果是无参构造可以简写为：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 无参构造的四个Season对象</span>
<span class="kd">enum</span> <span class="n">Season</span><span class="p">{</span>
    <span class="n">SPRING</span><span class="p">,</span><span class="n">SUMMER</span><span class="p">,</span><span class="n">AUTUMN</span><span class="p">,</span><span class="n">WINTER</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><strong>例题：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">enum</span> <span class="n">Gender</span><span class="p">{</span>
    <span class="n">BOY</span><span class="p">,</span><span class="n">GIRL</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// enum 类的 toString() 方法返回的是枚举项的 name</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Gender</span><span class="p">.</span><span class="na">BOY</span><span class="p">);</span> <span class="c1">// 输出BOY</span>
</code></pre></div>
</td></tr></table>
<h3 id="_14">（三）常用方法<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<p><img alt="" src="../img/enum_method.png" /></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">Season</span> <span class="n">autumn</span> <span class="o">=</span> <span class="n">Season</span><span class="p">.</span><span class="na">AUTUMN</span><span class="p">;</span>
<span class="n">Season</span> <span class="n">summer</span> <span class="o">=</span> <span class="n">Season</span><span class="p">.</span><span class="na">SUMMER</span><span class="p">;</span>

<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">autumn</span><span class="p">.</span><span class="na">ordinal</span><span class="p">());</span>   <span class="c1">// 输出2，下标从0开始</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">autumn</span><span class="p">.</span><span class="na">name</span><span class="p">());</span>  <span class="c1">// 输出AUTUMN</span>
<span class="n">Season</span><span class="o">[]</span> <span class="n">values</span> <span class="o">=</span> <span class="n">autumn</span><span class="p">.</span><span class="na">values</span><span class="p">();</span>  <span class="c1">//返回所有枚举项</span>
<span class="n">Season</span> <span class="n">autumn2</span> <span class="o">=</span> <span class="n">Season</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="s">&quot;AUTUMN&quot;</span><span class="p">);</span>  <span class="c1">// 按名称返回对应枚举项，autumn2和autumn是同一个对象</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">summer</span><span class="p">.</span><span class="na">compareTo</span><span class="p">(</span><span class="n">autumn</span><span class="p">));</span>   <span class="c1">// 输出-1，是两个的序号相减的结果</span>
</code></pre></div>
</td></tr></table>
<p><strong>注意：<code>enum</code>有隐式继承<code>Enum</code>类，因此不能继承其他类，但是可以实现接口。</strong></p>
<h2 id="annotation">六、注解（Annotation）<a class="headerlink" href="#annotation" title="Permanent link">&para;</a></h2>
<p>又称为元数据(<code>Metadata</code>)</p>
<h3 id="override">（一）@Override<a class="headerlink" href="#override" title="Permanent link">&para;</a></h3>
<p>用于重写父类方法</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nd">@Target</span><span class="p">(</span><span class="n">ElementType</span><span class="p">.</span><span class="na">METHOD</span><span class="p">)</span> <span class="c1">// 限制注解使用在哪些元素上</span>
<span class="nd">@Retention</span><span class="p">(</span><span class="n">RetentionPolicy</span><span class="p">.</span><span class="na">SOURCE</span><span class="p">)</span>  <span class="c1">// 限制注解只保留在源文件，其他选项有:CLASS、RUNTIME</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="n">Override</span> <span class="p">{</span>    <span class="c1">// @interface表示是注解，不是接口</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><code>Target</code>和<code>Retention</code>是修饰注解的注解，称为元注解。</p>
<h3 id="deprecated">（二）@Deprecated<a class="headerlink" href="#deprecated" title="Permanent link">&para;</a></h3>
<ul>
<li>表示某个元素（类、方法等）已过时，不推荐使用</li>
<li>可以用于版本升级时的过渡</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nd">@Documented</span> <span class="c1">// 表示该注解应当被javadoc工具记录</span>
<span class="nd">@Retention</span><span class="p">(</span><span class="n">RetentionPolicy</span><span class="p">.</span><span class="na">RUNTIME</span><span class="p">)</span>
<span class="nd">@Target</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="p">{</span><span class="n">CONSTRUCTOR</span><span class="p">,</span> <span class="n">FIELD</span><span class="p">,</span> <span class="n">LOCAL_VARIABLE</span><span class="p">,</span> <span class="n">METHOD</span><span class="p">,</span> <span class="n">PACKAGE</span><span class="p">,</span> <span class="n">MODULE</span><span class="p">,</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">TYPE</span><span class="p">})</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="n">Deprecated</span> <span class="p">{</span>
    <span class="cm">/**</span>
<span class="cm">     * Returns the version in which the annotated element became deprecated.</span>
<span class="cm">     * The version string is in the same format and namespace as the value of</span>
<span class="cm">     * the {@code @since} javadoc tag. The default value is the empty</span>
<span class="cm">     * string.</span>
<span class="cm">     *</span>
<span class="cm">     * @return the version string</span>
<span class="cm">     * @since 9</span>
<span class="cm">     */</span>
    <span class="n">String</span> <span class="nf">since</span><span class="p">()</span> <span class="k">default</span> <span class="s">&quot;&quot;</span><span class="p">;</span>

    <span class="cm">/**</span>
<span class="cm">     * Indicates whether the annotated element is subject to removal in a</span>
<span class="cm">     * future version. The default value is {@code false}.</span>
<span class="cm">     *</span>
<span class="cm">     * @return whether the element is subject to removal</span>
<span class="cm">     * @since 9</span>
<span class="cm">     */</span>
    <span class="kt">boolean</span> <span class="nf">forRemoval</span><span class="p">()</span> <span class="k">default</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h3 id="suppresswarning">（三）@SuppressWarning<a class="headerlink" href="#suppresswarning" title="Permanent link">&para;</a></h3>
<p>抑制（不显示）编译器警告</p>
<p>常用警告类型：</p>
<ol>
<li><code>unchecked</code>未检查的警告</li>
<li><code>rawtypes</code>没有指定泛型的警告</li>
<li><code>unused</code>没有使用某个变量的警告</li>
<li><code>all</code>所有警告</li>
</ol>
<p>点击左侧黄色提醒，即可快速添加<code>SupressWarning</code></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nd">@Target</span><span class="p">({</span><span class="n">TYPE</span><span class="p">,</span> <span class="n">FIELD</span><span class="p">,</span> <span class="n">METHOD</span><span class="p">,</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">CONSTRUCTOR</span><span class="p">,</span> <span class="n">LOCAL_VARIABLE</span><span class="p">,</span> <span class="n">MODULE</span><span class="p">})</span>
<span class="nd">@Retention</span><span class="p">(</span><span class="n">RetentionPolicy</span><span class="p">.</span><span class="na">SOURCE</span><span class="p">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="n">SuppressWarnings</span> <span class="p">{</span>
    <span class="cm">/**</span>
<span class="cm">     * The set of warnings that are to be suppressed by the compiler in the</span>
<span class="cm">     * annotated element.  Duplicate names are permitted.  The second and</span>
<span class="cm">     * successive occurrences of a name are ignored.  The presence of</span>
<span class="cm">     * unrecognized warning names is &lt;i&gt;not&lt;/i&gt; an error: Compilers must</span>
<span class="cm">     * ignore any warning names they do not recognize.  They are, however,</span>
<span class="cm">     * free to emit a warning if an annotation contains an unrecognized</span>
<span class="cm">     * warning name.</span>
<span class="cm">     *</span>
<span class="cm">     * &lt;p&gt; The string {@code &quot;unchecked&quot;} is used to suppress</span>
<span class="cm">     * unchecked warnings. Compiler vendors should document the</span>
<span class="cm">     * additional warning names they support in conjunction with this</span>
<span class="cm">     * annotation type. They are encouraged to cooperate to ensure</span>
<span class="cm">     * that the same names work across multiple compilers.</span>
<span class="cm">     * @return the set of warnings to be suppressed</span>
<span class="cm">     */</span>
    <span class="n">String</span><span class="o">[]</span> <span class="nf">value</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h3 id="_15">（四）元注解<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<h4 id="1-retention">1. Retention<a class="headerlink" href="#1-retention" title="Permanent link">&para;</a></h4>
<p>用于指定注解可以保留的时长</p>
<p>参数：</p>
<p>1)<code>RetentionPolicy.SOURCE</code>：注解只保留在源文件中</p>
<p>2) <code>RetentionPolicy.CLASS</code>：注解保留到编译后，记录在<code>class</code>文件中</p>
<p>3) <code>RetentionPolicy.RUNTIME</code>：注解保留到运行时，程序可以通过反射获取该注解</p>
<h4 id="2-target">2. Target<a class="headerlink" href="#2-target" title="Permanent link">&para;</a></h4>
<p>指定能够修饰的程序元素：类、方法、局部变量、属性、构造器、参数、包、模块等</p>
<h4 id="3-documented">3. Documented<a class="headerlink" href="#3-documented" title="Permanent link">&para;</a></h4>
<p>指定当前注解能被<code>javadoc</code>提取成文档</p>
<h4 id="4-inherited">4. Inherited<a class="headerlink" href="#4-inherited" title="Permanent link">&para;</a></h4>
<p>被修饰的注解将具有继承性，若某个类的注解被<code>Inherited</code>修饰，则它的子类自动具有该注解</p>
<h2 id="_16"><font color='red'>七、异常</font><a class="headerlink" href="#_16" title="Permanent link">&para;</a></h2>
<h3 id="try-catch">（一）try-catch<a class="headerlink" href="#try-catch" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="k">try</span> <span class="p">{</span>
    <span class="c1">// 可能出错的代码块</span>
<span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="n">NullPointerException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 异常发生时会直接进入catch块，不执行异常后面的代码；若没有异常则不会进入</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
<span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="n">ArithmeticException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
<span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>   <span class="c1">// 子类异常要写在父类异常前面</span>
    <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
<span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
    <span class="c1">// 不管有没有发生异常，必定执行的代码</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><code>catch</code>也可以不写：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="k">try</span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">n1</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">n2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">n1</span> <span class="o">/</span> <span class="n">n2</span><span class="p">);</span>
<span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;finally&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;程序继续执行&quot;</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm">输出：</span>
<span class="cm">finally</span>
<span class="cm">*/</span>
</code></pre></div>
</td></tr></table>
<p>虽然<code>finally</code>执行了，但是没有捕获异常，不会输出后面的内容。</p>
<h3 id="_17">（二）异常分类<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<div>
<div class="MathJax_Preview"> 异常\left\{ \begin{aligned} Error \\ Exception \end{aligned} \right. </div>
<script type="math/tex; mode=display"> 异常\left\{ \begin{aligned} Error \\ Exception \end{aligned} \right. </script>
</div>
<h4 id="1-error">1. Error<a class="headerlink" href="#1-error" title="Permanent link">&para;</a></h4>
<p><code>Java</code>虚拟机无法解决的严重错误，会导致程序崩溃：<code>JVM</code>系统内部错误、资源耗尽等。</p>
<div>
<div class="MathJax_Preview"> Error\left\{ \begin{aligned} StackOverFlow \\ OutOfMemory \end{aligned} \right. </div>
<script type="math/tex; mode=display"> Error\left\{ \begin{aligned} StackOverFlow \\ OutOfMemory \end{aligned} \right. </script>
</div>
<h4 id="2-exception">2. Exception<a class="headerlink" href="#2-exception" title="Permanent link">&para;</a></h4>
<p>其他编程错误，或偶然的外在因素导致的一般性问题：空指针访问、读取不存在的文件、网络中断等。</p>
<div>
<div class="MathJax_Preview"> Exception \left\{ \begin{aligned} 1) 运行时异常（默认throws抛给父类，直到JVM） \\ 2) 编译时异常（必须用try-catch或throws处理） \end{aligned} \right. </div>
<script type="math/tex; mode=display"> Exception \left\{ \begin{aligned} 1) 运行时异常（默认throws抛给父类，直到JVM） \\ 2) 编译时异常（必须用try-catch或throws处理） \end{aligned} \right. </script>
</div>
<div>
<div class="MathJax_Preview"> 1) 运行时异常\left\{ \begin{aligned} NullPointerException （空指针异常） \\ ClassCastException （类型转换异常） \\ NumberFormatException （数字格式异常） \\ ArrayIndexOutOfBoundsException （数组越界异常） \\ ArithmeticException（算术运算异常） \end{aligned} \right. </div>
<script type="math/tex; mode=display"> 1) 运行时异常\left\{ \begin{aligned} NullPointerException （空指针异常） \\ ClassCastException （类型转换异常） \\ NumberFormatException （数字格式异常） \\ ArrayIndexOutOfBoundsException （数组越界异常） \\ ArithmeticException（算术运算异常） \end{aligned} \right. </script>
</div>
<div>
<div class="MathJax_Preview"> 2) 编译时异常 \left\{ \begin{aligned} FileNotFoundException （找不到文件异常） \\ ClassNotFoundException （找不到类异常） \\ IOException （文件异常） \\ SQLException （数据库异常） \\ EOFException （操作文件到文件末尾） \\ IllegalArgumentException （参数异常） \end{aligned} \right. </div>
<script type="math/tex; mode=display"> 2) 编译时异常 \left\{ \begin{aligned} FileNotFoundException （找不到文件异常） \\ ClassNotFoundException （找不到类异常） \\ IOException （文件异常） \\ SQLException （数据库异常） \\ EOFException （操作文件到文件末尾） \\ IllegalArgumentException （参数异常） \end{aligned} \right. </script>
</div>
<h3 id="_18">（三）异常体系图<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<p><img alt="" src="../img/Throwable.png" /></p>
<h3 id="throws">（四）throws<a class="headerlink" href="#throws" title="Permanent link">&para;</a></h3>
<ul>
<li>将错误抛出给调用自己的方法，直到抛给<code>JVM</code>（若程序员没有显示地处理异常，默认使用<code>throws</code>）</li>
<li><code>throws</code>可以抛出一系列异常</li>
<li><code>throws</code>抛出的异常可以是发生异常的父类</li>
</ul>
<p><img alt="" src="../img/throws.png" /></p>
<ol>
<li>子类重写父类方法时，抛出的异常必须是<strong>父类异常</strong>或<strong>父类异常的子类</strong>；</li>
<li><code>try-catch</code>和<code>throws</code>二选一，有了<code>try-catch</code>可以不必写<code>throws</code>;</li>
<li>注意，子类抛出的编译时异常，父类一定要处理或继续抛出，而运行异常不用，因为有默认处理机制。</li>
</ol>
<table>
<thead>
<tr>
<th>区别</th>
<th>定义</th>
<th>位置</th>
<th>后面跟的东西</th>
</tr>
</thead>
<tbody>
<tr>
<td>throws</td>
<td>异常处理的方式</td>
<td>方法签名后</td>
<td>异常类型</td>
</tr>
<tr>
<td>throw</td>
<td>生成异常对象</td>
<td>方法体中</td>
<td>异常对象</td>
</tr>
</tbody>
</table>
<h3 id="_19">（五）自定义异常<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Index</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">age</span> <span class="o">=</span> <span class="mi">150</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">age</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">age</span> <span class="o">&lt;=</span> <span class="mi">120</span><span class="p">)){</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">AgeException</span><span class="p">(</span><span class="s">&quot;年龄需要在0到120岁之间！&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;年龄正确！&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">AgeException</span> <span class="kd">extends</span> <span class="n">RuntimeException</span> <span class="p">{</span>
    <span class="n">AgeException</span><span class="p">(</span><span class="n">String</span> <span class="n">message</span><span class="p">){</span>
        <span class="kd">super</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p>抛出效果：</p>
<p><img alt="" src="../img/age_exception.png" /></p>
<p>注意，自定义异常一般都继承<code>RuntimeException</code>，如果继承编译时异常还要手动抛出，比较麻烦。</p>
<h3 id="_20">（六）异常例题<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h3>
<p>例一：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="k">try</span> <span class="p">{</span>
    <span class="n">String</span><span class="o">[]</span> <span class="n">arr</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span><span class="p">;</span>   <span class="c1">// 1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">arr</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">))</span> <span class="p">{</span>   <span class="c1">// 2</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">arr</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">arr</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span> <span class="o">=</span> <span class="s">&quot;world&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">ArrayIndexOutOfBoundsException</span> <span class="n">e</span><span class="p">){</span>
    <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">NullPointerException</span> <span class="n">e</span><span class="p">){</span>   <span class="c1">// 3</span>
    <span class="k">return</span> <span class="mi">3</span><span class="p">;</span>   <span class="c1">// 4</span>
<span class="p">}</span> <span class="k">finally</span> <span class="p">{</span> <span class="c1">// 5</span>
    <span class="k">return</span> <span class="mi">4</span><span class="p">;</span>   <span class="c1">// 6</span>
<span class="p">}</span>

<span class="c1">// 返回4</span>
</code></pre></div>
</td></tr></table>
<p>例二：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">try</span> <span class="p">{</span>
    <span class="n">i</span><span class="o">++</span><span class="p">;</span>
    <span class="n">String</span><span class="o">[]</span> <span class="n">arr</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">arr</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">arr</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">arr</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span> <span class="o">=</span> <span class="s">&quot;world&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">i</span><span class="p">;</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">ArrayIndexOutOfBoundsException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">i</span><span class="p">;</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">NullPointerException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">++</span><span class="n">i</span><span class="p">;</span>     <span class="c1">// 临时保存i的值：int tmp = i;</span>
<span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
    <span class="o">++</span><span class="n">i</span><span class="p">;</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;i = &quot;</span> <span class="o">+</span> <span class="n">i</span><span class="p">);</span> <span class="c1">// i = 4</span>
<span class="p">}</span>

<span class="c1">// 输出i = 4，返回3</span>
</code></pre></div>
</td></tr></table>
<p>例三：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="n">func</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">);</span>
    <span class="p">}</span><span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">){</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;C&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;D&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">func</span><span class="p">(){</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;B&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/* 输出：</span>
<span class="cm">B</span>
<span class="cm">C</span>
<span class="cm">D</span>
<span class="cm">*/</span>
</code></pre></div>
</td></tr></table>
<p>习题：</p>
<p>让用户输入一个整数，如果输入的不是整数，就一直重新输入。要求用异常实现。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">in</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="n">scanner</span><span class="p">.</span><span class="na">next</span><span class="p">();</span>
            <span class="n">num</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">NumberFormatException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;你输入的不是整数&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;你输入的是：&quot;</span> <span class="o">+</span> <span class="n">num</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p>如果输入正确，则直接<code>break</code>，否则会被<code>catch</code>，继续进入循环。</p>
<h2 id="_21">八、常用类<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h2>
<h3 id="_22">（一）包装类<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>基本数据类型</th>
<th>包装类</th>
</tr>
</thead>
<tbody>
<tr>
<td>boolean</td>
<td>Boolean</td>
</tr>
<tr>
<td>char</td>
<td>Character</td>
</tr>
<tr>
<td>byte</td>
<td>Byte</td>
</tr>
<tr>
<td>short</td>
<td>Short</td>
</tr>
<tr>
<td>int</td>
<td>Integer</td>
</tr>
<tr>
<td>long</td>
<td>Long</td>
</tr>
<tr>
<td>float</td>
<td>Float</td>
</tr>
<tr>
<td>double</td>
<td>Double</td>
</tr>
</tbody>
</table>
<p><strong>Boolean和Character类结构图：</strong></p>
<p><img alt="" src="../img/Boolean.png" /></p>
<p><strong>其余包装类结构图如下：</strong></p>
<p><img alt="" src="../img/wrapper.png" /></p>
<h4 id="1_1">1. 装箱与拆箱<a class="headerlink" href="#1_1" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>

<span class="c1">// 手动装箱</span>
<span class="n">Integer</span> <span class="n">integer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Integer</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="n">Integer</span> <span class="n">integer2</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>

<span class="c1">// 手动拆箱</span>
<span class="kt">int</span> <span class="n">n2</span> <span class="o">=</span> <span class="n">integer</span><span class="p">.</span><span class="na">intValue</span><span class="p">();</span>


<span class="c1">// jdk5以后</span>
<span class="c1">// 自动装箱</span>
<span class="n">Integer</span> <span class="n">integer3</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span>   <span class="c1">// 底层使用了Integer.valueOf(n);</span>

<span class="c1">// 自动拆箱</span>
<span class="kt">int</span> <span class="n">n3</span> <span class="o">=</span> <span class="n">integer</span><span class="p">;</span>   <span class="c1">// 底层使用了integer.intValue()</span>
</code></pre></div>
</td></tr></table>
<h4 id="2-string">2. 包装类与String相互转换<a class="headerlink" href="#2-string" title="Permanent link">&para;</a></h4>
<p><strong>包装类转String：</strong></p>
<ol>
<li><code>String str = n + "";</code></li>
<li><code>String str = n.toSting();</code></li>
<li><code>String str = String.valueOf(n);</code></li>
</ol>
<p><strong>String转包装类：</strong></p>
<ol>
<li>
<p><code>Integer n = Integer.parseInt(str);</code></p>
</li>
<li>
<p><code>Integer n = new Integer(str);</code></p>
</li>
</ol>
<h4 id="3_1">3. 例题<a class="headerlink" href="#3_1" title="Permanent link">&para;</a></h4>
<p><strong>例1：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 1</span>
<span class="n">Object</span> <span class="n">obj</span> <span class="o">=</span> <span class="kc">true</span><span class="o">?</span><span class="k">new</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span><span class="k">new</span> <span class="n">Double</span><span class="p">(</span><span class="mf">2.0</span><span class="p">);</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span>
<span class="c1">// 输出 1.0</span>
<span class="c1">// 因为三元运算符是一个整体，要把类型转换为范围大的</span>

<span class="c1">// 2</span>
<span class="n">Object</span> <span class="n">obj</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="kc">true</span><span class="p">){</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Double</span><span class="p">(</span><span class="mf">2.0</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span>
<span class="c1">// 输出 1</span>
</code></pre></div>
</td></tr></table>
<p><strong>例2：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 1</span>
<span class="n">Integer</span> <span class="n">n1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">Integer</span> <span class="n">n2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">n1</span> <span class="o">==</span> <span class="n">n2</span><span class="p">);</span>   <span class="c1">// false</span>

<span class="c1">// 2</span>
<span class="n">Integer</span> <span class="n">n3</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">Integer</span> <span class="n">n4</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">n3</span> <span class="o">==</span> <span class="n">n4</span><span class="p">);</span>   <span class="c1">// true</span>

<span class="c1">// 3</span>
<span class="n">Integer</span> <span class="n">n5</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span>
<span class="n">Integer</span> <span class="n">n6</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">n5</span> <span class="o">==</span> <span class="n">n6</span><span class="p">);</span>   <span class="c1">// false</span>
</code></pre></div>
</td></tr></table>
<p>查看源码可知，自动装箱调用了<code>valueOf()</code>方法：</p>
<p><img alt="" src="../img/valueof.png" /></p>
<p><span><span class="MathJax_Preview">[-128,127]</span><script type="math/tex">[-128,127]</script></span>范围内的数，返回的是<code>cache</code>数组中的值，因此地址一样；范围外的数是直接<code>new</code>的<code>Integer</code>对象。</p>
<p><strong>例3：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">Integer</span> <span class="n">n1</span> <span class="o">=</span> <span class="mi">127</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">n2</span> <span class="o">=</span> <span class="mi">127</span><span class="p">;</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">n1</span> <span class="o">==</span> <span class="n">n2</span><span class="p">);</span>   <span class="c1">// true</span>

<span class="kt">int</span> <span class="n">n3</span> <span class="o">=</span> <span class="mi">127</span><span class="p">;</span>
<span class="n">Integer</span> <span class="n">n4</span> <span class="o">=</span> <span class="mi">127</span><span class="p">;</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">n3</span> <span class="o">==</span> <span class="n">n4</span><span class="p">);</span>   <span class="c1">// true</span>
</code></pre></div>
</td></tr></table>
<p>主要有基本数据类型，判断的就是值是否相等。</p>
<h3 id="string"><font color='red'>（二）String类</font><a class="headerlink" href="#string" title="Permanent link">&para;</a></h3>
<h4 id="1_2">1. 特点<a class="headerlink" href="#1_2" title="Permanent link">&para;</a></h4>
<p><img alt="" src="../img/string.png" /></p>
<ul>
<li>实现了<code>Serializabele</code>接口可以串行化，可用于网络传输；</li>
<li>实现了<code>Comparable</code>接口可以相互比较；</li>
<li><code>String name = "Kun";</code>中的<code>"Kun"</code>是常量，保存在常量池中，再由<code>name</code>指向；</li>
<li><code>String</code>类中有一个属性用于存放字符串：<code>private final char value[]</code>，<code>value[]</code>是一个<code>final</code>类型，说明它的地址不可以修改；</li>
<li>对字符串做大量修改时，尽量不要使用<code>String</code>。</li>
</ul>
<h4 id="2_1">2. 字符串连接的效率问题<a class="headerlink" href="#2_1" title="Permanent link">&para;</a></h4>
<ol>
<li><code>String str = "Hello"+"World";</code>时，会直接从常量池中获取并连接；</li>
<li><code>String str = str1 + str2;</code>时，在<code>JDK8</code>中，会创建<code>StringBuilder</code>对象并使用append进行连接，连接结束后再通过<code>toStrnig()</code>方法返回String，因此效率极低；而<code>JDK9</code>中，直接通过<code>makeConcatWithConstants</code>方法连接字符串，对其进行了一定优化。</li>
</ol>
<h4 id="3-string">3. String的内存布局<a class="headerlink" href="#3-string" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>String str = "Hello"</strong></li>
</ul>
<p><code>str</code>直接指向常量池中的地址。</p>
<p><img alt="" src="../img/JVM%E5%86%85%E5%AD%98_String.png" /></p>
<ul>
<li><strong>String str = new String("Hello")</strong></li>
</ul>
<p>堆中开辟空间，<code>str</code>指向堆，对象内的<code>value</code>属性指向常量池中的地址。</p>
<p><img alt="" src="../img/JVM%E5%86%85%E5%AD%98_String2.png" /></p>
<h4 id="4">4. 例题<a class="headerlink" href="#4" title="Permanent link">&para;</a></h4>
<p><strong>例1：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">a</span> <span class="o">=</span> <span class="s">&quot;abc&quot;</span><span class="p">;</span>
<span class="n">String</span> <span class="n">b</span> <span class="o">=</span> <span class="s">&quot;abc&quot;</span><span class="p">;</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">b</span><span class="p">));</span>    <span class="c1">// true</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">);</span> <span class="c1">// true</span>
</code></pre></div>
</td></tr></table>
<p><strong>例2：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">a</span> <span class="o">=</span> <span class="s">&quot;hello&quot;</span><span class="p">;</span>
<span class="n">String</span> <span class="n">b</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">);</span>

<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">b</span><span class="p">));</span>    <span class="c1">// true</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">);</span> <span class="c1">// false</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">.</span><span class="na">intern</span><span class="p">());</span>    <span class="c1">// true</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">b</span> <span class="o">==</span> <span class="n">b</span><span class="p">.</span><span class="na">intern</span><span class="p">());</span>    <span class="c1">// false</span>
</code></pre></div>
</td></tr></table>
<p><code>intern()</code>方法：返回常量池中该字符串的地址；若没有，就将其添加到池中，再返回地址。以上面的图为例，<code>str</code>的地址是<code>ox33</code>，该方法返回的是<code>0x99</code>。</p>
<p><strong>例3：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">a</span> <span class="o">=</span> <span class="s">&quot;hello&quot;</span><span class="p">;</span>
<span class="n">String</span> <span class="n">b</span> <span class="o">=</span> <span class="s">&quot;hi&quot;</span><span class="p">;</span>
<span class="c1">// 产生了2个对象</span>
<span class="c1">// （这里把引用指向的空间算成一个对象）</span>

<span class="n">String</span> <span class="n">c</span> <span class="o">=</span> <span class="s">&quot;Hello&quot;</span> <span class="o">+</span> <span class="s">&quot;World&quot;</span><span class="p">;</span>
<span class="c1">// 产生了1个对象</span>
<span class="c1">// 编译器会优化为&quot;HelloWord&quot;</span>

<span class="n">String</span> <span class="n">d</span> <span class="o">=</span> <span class="s">&quot;Hello&quot;</span><span class="p">;</span>
<span class="n">String</span> <span class="n">e</span> <span class="o">=</span> <span class="s">&quot;World&quot;</span><span class="p">;</span>
<span class="n">String</span> <span class="n">f</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="n">e</span><span class="p">;</span>
<span class="c1">// 产生了4个对象</span>
<span class="c1">// 1. d 和 e 各占一个对象</span>
<span class="c1">// 2. 创建了一个StringBuilder对象builder</span>
<span class="c1">// 3. 该对象通过两次执行append()方法，连接字符串HelloWorld</span>
<span class="c1">// 4. f = builder.toString();创建了一个String对象</span>
</code></pre></div>
</td></tr></table>
<p><strong>例4：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Index</span> <span class="p">{</span>
    <span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
    <span class="kt">char</span><span class="o">[]</span> <span class="n">ch</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="o">[]</span><span class="p">{</span><span class="sc">&#39;j&#39;</span><span class="p">,</span> <span class="sc">&#39;a&#39;</span><span class="p">,</span> <span class="sc">&#39;v&#39;</span><span class="p">,</span> <span class="sc">&#39;a&#39;</span><span class="p">};</span>     <span class="c1">// 只有这种写法才能直接输出char[]</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Index</span> <span class="n">index</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Index</span><span class="p">();</span>
        <span class="n">index</span><span class="p">.</span><span class="na">change</span><span class="p">(</span><span class="n">index</span><span class="p">.</span><span class="na">str</span><span class="p">,</span> <span class="n">index</span><span class="p">.</span><span class="na">ch</span><span class="p">);</span>

        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">index</span><span class="p">.</span><span class="na">str</span> <span class="o">+</span> <span class="s">&quot; &quot;</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">index</span><span class="p">.</span><span class="na">ch</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">change</span><span class="p">(</span><span class="n">String</span> <span class="n">str</span><span class="p">,</span> <span class="kt">char</span><span class="o">[]</span> <span class="n">ch</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">str</span> <span class="o">=</span> <span class="s">&quot;java&quot;</span><span class="p">;</span>
        <span class="n">ch</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="sc">&#39;h&#39;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// 输出：hello hava</span>
</code></pre></div>
</td></tr></table>
<p><strong>例4过程分析如下：</strong></p>
<ol>
<li>没有执行<code>change()</code>方法前，<code>main</code>方法中的<code>index</code>引用指向堆中的对象。</li>
<li>对象中有<code>str</code>和<code>ch</code>两个引用，<code>str</code>指向堆中的<code>String</code>对象，<code>ch</code>指向堆中的<code>char[]</code>对象。</li>
<li><code>String</code>对象指向常量池中的<code>hello</code>常量，而<code>char[]</code>对象中直接保存了字符值。</li>
</ol>
<p><img alt="" src="../img/String%E4%BE%8B%E9%A2%981.png" /></p>
<ol>
<li>执行了<code>change</code>方法后，栈中新增栈帧，传入的<code>str</code>和<code>ch</code>引用被拷贝到方法中成为局部变量。</li>
<li>局部变量<code>str</code>直接指向常量池中的<code>java</code>常量，局部变量<code>ch</code>修改了堆中的字符。</li>
</ol>
<p><img alt="" src="../img/String%E4%BE%8B%E9%A2%982.png" /></p>
<ol>
<li>回到<code>main</code>方法后，堆中的<code>str</code>依旧指向<code>hello</code>，<code>ch</code>所指向的字符数组内容已经被改变。</li>
</ol>
<p>（注意，<code>final char[]</code>表示引用保存的地址不可修改，而不是内容）</p>
<h3 id="stringbuffer">（三）StringBuffer类<a class="headerlink" href="#stringbuffer" title="Permanent link">&para;</a></h3>
<h4 id="1_3">1. 特点<a class="headerlink" href="#1_3" title="Permanent link">&para;</a></h4>
<ul>
<li>父类中有一个字符数组变量<code>char[] value</code>，保存在堆中而不是常量池中；</li>
<li><code>StringBuffer</code>类是<code>final</code>的，不能被继承；</li>
<li>可以快速修改内容，不必每次更新地址，只有空间不够时才需要更新地址，效率高。</li>
</ul>
<h4 id="2-stringbuffer">2. <code>StringBuffer</code>的内存布局<a class="headerlink" href="#2-stringbuffer" title="Permanent link">&para;</a></h4>
<p><img alt="" src="../img/JVM%E5%86%85%E5%AD%98_StringBuffer.png" /></p>
<h4 id="3-stringbuffer">3. <code>StringBuffer</code>常用方法<a class="headerlink" href="#3-stringbuffer" title="Permanent link">&para;</a></h4>
<p><strong>构造器的使用方法：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">StringBuffer</span> <span class="n">sb1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="p">();</span>  <span class="c1">// 默认开辟一个长度为16的char数组</span>

<span class="n">StringBuffer</span> <span class="n">sb2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>   <span class="c1">// 开辟一个长度为[100]+16的char数组</span>

<span class="n">StringBuffer</span> <span class="n">sb3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">);</span>   <span class="c1">// 开辟一个长度为[hello].length的char数组</span>
</code></pre></div>
</td></tr></table>
<p><strong><code>String</code>和<code>StringBuffer</code>相互转换：</strong></p>
<ol>
<li><code>String</code> 转 <code>StringBuffer</code>：</li>
</ol>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="s">&quot;hello&quot;</span><span class="p">;</span>

<span class="c1">// 方法1</span>
<span class="n">StringBuffer</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>    <span class="c1">// 对str本身没有影响</span>
<span class="c1">// 方法2</span>
<span class="n">StringBuffer</span> <span class="n">sb2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="p">();</span>
<span class="n">sb2</span> <span class="o">=</span> <span class="n">sb2</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
</code></pre></div>
</td></tr></table>
<ol>
<li><code>StringBuffer</code> 转 <code>String</code>：</li>
</ol>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">StringBuffer</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="p">(</span><span class="s">&quot;Hello World&quot;</span><span class="p">);</span>

<span class="c1">// 方法1</span>
<span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="n">sb</span><span class="p">.</span><span class="na">toString</span><span class="p">();</span>
<span class="c1">// 方法2</span>
<span class="n">String</span> <span class="n">str2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="p">(</span><span class="n">sb</span><span class="p">);</span>
</code></pre></div>
</td></tr></table>
<p><strong>增删改查插：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">StringBuffer</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="p">(</span><span class="s">&quot;Hello World&quot;</span><span class="p">);</span>
<span class="c1">// 增</span>
<span class="n">sb</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="s">&quot;!!!&quot;</span><span class="p">);</span>   <span class="c1">// Hello World!!!</span>
<span class="c1">// 插</span>
<span class="n">sb</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s">&quot;hi&quot;</span><span class="p">);</span>  <span class="c1">// Hehillo World!!!</span>
<span class="c1">// 删</span>
<span class="n">sb</span><span class="p">.</span><span class="na">delete</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span> <span class="c1">// Helo World!!!</span>
<span class="c1">// 改 </span>
<span class="n">sb</span><span class="p">.</span><span class="na">replace</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="s">&quot;hahaha&quot;</span><span class="p">);</span>   <span class="c1">// Helohahaharld!!!</span>
<span class="c1">// 查</span>
<span class="n">sb</span><span class="p">.</span><span class="na">indexOf</span><span class="p">(</span><span class="s">&quot;ha&quot;</span><span class="p">);</span>   <span class="c1">// 4</span>
</code></pre></div>
</td></tr></table>
<h4 id="4_1">4. 例题<a class="headerlink" href="#4_1" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">StringBuffer</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="p">();</span>
<span class="n">sb</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>    <span class="c1">// 这里要看源码！源码中把null转换成了{&#39;n&#39;,&#39;u&#39;,&#39;l&#39;,&#39;l&#39;}存储</span>

<span class="n">StringBuffer</span> <span class="n">sb2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>  <span class="c1">// 底层调用了super(str.length() + 16)，因此会抛出空指针异常</span>
</code></pre></div>
</td></tr></table>
<h3 id="stringbuilder">（四）StringBuilder类<a class="headerlink" href="#stringbuilder" title="Permanent link">&para;</a></h3>
<ul>
<li>与<code>StringBuffer</code>类似，是可变字符序列；</li>
<li><code>StringBuilder</code>是<code>final</code>的，不能被继承；</li>
<li>可用的方法和<code>StringBuffer</code>一样，但是它适用于单线程，没有<code>synchronized</code>同步，因此是线程不安全的。</li>
</ul>
<h3 id="_23">（五）日期类<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h3>
<h4 id="1-datesimpledateformat">1. <code>Date</code>与<code>SimpleDateFormat</code><a class="headerlink" href="#1-datesimpledateformat" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">SimpleDateFormat</span> <span class="n">simpleDateFormat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SimpleDateFormat</span><span class="p">(</span><span class="s">&quot;yyyy年MM月dd日 hh:mm:ss E&quot;</span><span class="p">);</span>
</code></pre></div>
</td></tr></table>
<ol>
<li>将<code>Date</code>转为固定格式的<code>String</code></li>
</ol>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">Date</span> <span class="n">date</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Date</span><span class="p">();</span>
<span class="n">String</span> <span class="n">dateStr</span> <span class="o">=</span> <span class="n">simpleDateFormat</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="n">date</span><span class="p">);</span>
</code></pre></div>
</td></tr></table>
<ol>
<li>将格式化<code>String</code>转换回<code>Date</code></li>
</ol>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="s">&quot;1996年01月01日 10:20:35 星期五&quot;</span><span class="p">;</span>
<span class="n">Date</span> <span class="n">date</span> <span class="o">=</span> <span class="n">simpleDateFormat</span><span class="p">.</span><span class="na">parse</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
</code></pre></div>
</td></tr></table>
<h4 id="2-calendar">2. Calendar<a class="headerlink" href="#2-calendar" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><code>Calendar</code>是抽象类</p>
</li>
<li>
<p>可以通过<code>getInstance()</code>获得实例</p>
</li>
</ol>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">Calendar</span> <span class="n">c</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Calendar</span><span class="p">.</span><span class="na">getInstance</span><span class="p">();</span>

<span class="c1">// 注意，由于要和对象关联起来，因此通过get的方式获取</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="na">YEAR</span><span class="p">));</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="na">MonTh</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span> <span class="c1">// 月份默认从0开始，所以要+1</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="na">DAY_OF_MONTH</span><span class="p">));</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="na">HOUR</span><span class="p">));</span>    <span class="c1">// 默认是12进制</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="na">HOUR_OF_DAY</span><span class="p">));</span> <span class="c1">// 24进制的小时</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="na">MINUTE</span><span class="p">));</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="na">SECOND</span><span class="p">));</span>

<span class="c1">// 便于自由组合</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="na">YEAR</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;-&quot;</span> <span class="o">+</span> 
                   <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="na">MonTh</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;-&quot;</span> <span class="o">+</span> 
                   <span class="n">c</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="na">DAY_OF_MONTH</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> 
                   <span class="n">c</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="na">HOUR_OF_DAY</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span> 
                   <span class="n">c</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="na">MINUTE</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span> 
                   <span class="n">c</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="na">SECOND</span><span class="p">));</span>
</code></pre></div>
</td></tr></table>
<p><strong>Date和Calendar存在的问题：</strong></p>
<ol>
<li>日期、时间相关的类应当是不可变的；</li>
<li><code>Date</code>年份从1990年开始，月份从0开始不合理；</li>
<li>格式化只对<code>Date</code>可用，<code>Calendar</code>无法使用；</li>
<li>线程不安全。</li>
</ol>
<h4 id="3-jdk8">3. JDK8新增第三代日期<a class="headerlink" href="#3-jdk8" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 构造</span>
<span class="n">LocalDateTime</span> <span class="n">now</span> <span class="o">=</span> <span class="n">LocalDateTime</span><span class="p">.</span><span class="na">now</span><span class="p">();</span>    <span class="c1">// 可以获取年月日时分秒</span>
<span class="n">LocalDate</span> <span class="n">now2</span> <span class="o">=</span> <span class="n">LocalDate</span><span class="p">.</span><span class="na">now</span><span class="p">();</span>   <span class="c1">// 可以获取年月日</span>
<span class="n">LocalTime</span> <span class="n">now3</span> <span class="o">=</span> <span class="n">LocalTime</span><span class="p">.</span><span class="na">now</span><span class="p">();</span>   <span class="c1">// 可以获取时分秒</span>

<span class="c1">// 方法</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">now</span><span class="p">);</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">now</span><span class="p">.</span><span class="na">getYear</span><span class="p">());</span>  <span class="c1">// 2022</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">now</span><span class="p">.</span><span class="na">getMonth</span><span class="p">());</span> <span class="c1">// JUNE</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">now</span><span class="p">.</span><span class="na">getMonthValue</span><span class="p">());</span>    <span class="c1">// 6</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">now</span><span class="p">.</span><span class="na">getDayOfMonth</span><span class="p">());</span>    <span class="c1">// 25</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">now</span><span class="p">.</span><span class="na">getHour</span><span class="p">());</span>  <span class="c1">// 17</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">now</span><span class="p">.</span><span class="na">getMinute</span><span class="p">());</span>    <span class="c1">// 6</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">now</span><span class="p">.</span><span class="na">getSecond</span><span class="p">());</span>    <span class="c1">// 46</span>


<span class="c1">// 格式化</span>
<span class="n">DateTimeFormatter</span> <span class="n">formatter</span> <span class="o">=</span> <span class="n">DateTimeFormatter</span><span class="p">.</span><span class="na">ofPattern</span><span class="p">(</span><span class="s">&quot;yyyy年MM月dd日 HH:mm:dd&quot;</span><span class="p">);</span>
<span class="n">String</span> <span class="n">dateStr</span> <span class="o">=</span> <span class="n">formatter</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="n">now</span><span class="p">);</span>

<span class="c1">// 时间戳</span>
<span class="n">Instant</span> <span class="n">nowX</span> <span class="o">=</span> <span class="n">Instant</span><span class="p">.</span><span class="na">now</span><span class="p">();</span>
<span class="n">Date</span> <span class="n">date</span> <span class="o">=</span> <span class="n">Date</span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">nowX</span><span class="p">);</span>    <span class="c1">// Instant转Date</span>
<span class="n">Instant</span> <span class="n">nowY</span> <span class="o">=</span> <span class="n">date</span><span class="p">.</span><span class="na">toInstant</span><span class="p">();</span>    <span class="c1">// Date转Instant</span>
</code></pre></div>
</td></tr></table>
<h3 id="_24">（六）例题<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h3>
<h4 id="1_4">1. 例一<a class="headerlink" href="#1_4" title="Permanent link">&para;</a></h4>
<p>定义一个<code>Book</code>类，包含书名、价格两个属性，使用接口对其进行排序。</p>
<p><strong>接口：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">SortBook</span> <span class="p">{</span>
    <span class="kt">double</span> <span class="nf">sortBook</span><span class="p">(</span><span class="n">Book</span> <span class="n">a</span><span class="p">,</span> <span class="n">Book</span> <span class="n">b</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><strong>Book类：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Book</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">bookName</span><span class="p">;</span>
    <span class="kd">private</span> <span class="kt">double</span> <span class="n">price</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">Book</span><span class="p">(</span><span class="n">String</span> <span class="n">bookName</span><span class="p">,</span> <span class="kt">double</span> <span class="n">price</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">bookName</span> <span class="o">=</span> <span class="n">bookName</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">price</span> <span class="o">=</span> <span class="n">price</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">sortBooks</span><span class="p">(</span><span class="n">Book</span><span class="o">[]</span> <span class="n">books</span><span class="p">,</span> <span class="n">SortBook</span> <span class="n">sb</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">books</span><span class="p">.</span><span class="na">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">books</span><span class="p">.</span><span class="na">length</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">sb</span><span class="p">.</span><span class="na">sortBook</span><span class="p">(</span><span class="n">books</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">,</span> <span class="n">books</span><span class="o">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="o">]</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">Book</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">books</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">;</span>
                    <span class="n">books</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="n">books</span><span class="o">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="o">]</span><span class="p">;</span>
                    <span class="n">books</span><span class="o">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">printBooks</span><span class="p">(</span><span class="n">Book</span><span class="o">[]</span> <span class="n">books</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">Book</span> <span class="n">book</span> <span class="p">:</span> <span class="n">books</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">book</span><span class="p">.</span><span class="na">getBookName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot; , &quot;</span> <span class="o">+</span> <span class="n">book</span><span class="p">.</span><span class="na">getPrice</span><span class="p">());</span>
        <span class="p">}</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;======================&quot;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getBookName</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">bookName</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">getPrice</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">price</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><strong>Main方法：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Index</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Book</span><span class="o">[]</span> <span class="n">books</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Book</span><span class="o">[</span><span class="mi">5</span><span class="o">]</span><span class="p">;</span>
        <span class="n">books</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Book</span><span class="p">(</span><span class="s">&quot;母猪的产后护理&quot;</span><span class="p">,</span> <span class="mf">20.6</span><span class="p">);</span>
        <span class="n">books</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Book</span><span class="p">(</span><span class="s">&quot;星火英语&quot;</span><span class="p">,</span> <span class="mf">32.6</span><span class="p">);</span>
        <span class="n">books</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Book</span><span class="p">(</span><span class="s">&quot;Android开发从入门到精通&quot;</span><span class="p">,</span> <span class="mf">70.5</span><span class="p">);</span>
        <span class="n">books</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Book</span><span class="p">(</span><span class="s">&quot;计算机网络&quot;</span><span class="p">,</span> <span class="mf">56.1</span><span class="p">);</span>
        <span class="n">books</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Book</span><span class="p">(</span><span class="s">&quot;深网&quot;</span><span class="p">,</span> <span class="mf">34.2</span><span class="p">);</span>

        <span class="n">sortBooks</span><span class="p">(</span><span class="n">books</span><span class="p">,</span> <span class="k">new</span> <span class="n">SortBook</span><span class="p">()</span> <span class="p">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">double</span> <span class="nf">sortBook</span><span class="p">(</span><span class="n">Book</span> <span class="n">a</span><span class="p">,</span> <span class="n">Book</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="na">getPrice</span><span class="p">()</span> <span class="o">-</span> <span class="n">b</span><span class="p">.</span><span class="na">getPrice</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">});</span>
        <span class="n">printBooks</span><span class="p">(</span><span class="n">books</span><span class="p">);</span>

        <span class="n">sortBooks</span><span class="p">(</span><span class="n">books</span><span class="p">,</span> <span class="k">new</span> <span class="n">SortBook</span><span class="p">()</span> <span class="p">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">double</span> <span class="nf">sortBook</span><span class="p">(</span><span class="n">Book</span> <span class="n">a</span><span class="p">,</span> <span class="n">Book</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">b</span><span class="p">.</span><span class="na">getPrice</span><span class="p">()</span> <span class="o">-</span> <span class="n">a</span><span class="p">.</span><span class="na">getPrice</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">});</span>
        <span class="n">printBooks</span><span class="p">(</span><span class="n">books</span><span class="p">);</span>

        <span class="n">sortBooks</span><span class="p">(</span><span class="n">books</span><span class="p">,</span> <span class="k">new</span> <span class="n">SortBook</span><span class="p">()</span> <span class="p">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">double</span> <span class="nf">sortBook</span><span class="p">(</span><span class="n">Book</span> <span class="n">a</span><span class="p">,</span> <span class="n">Book</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="na">getBookName</span><span class="p">().</span><span class="na">length</span><span class="p">()</span> <span class="o">-</span> <span class="n">b</span><span class="p">.</span><span class="na">getBookName</span><span class="p">().</span><span class="na">length</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">});</span>
        <span class="n">printBooks</span><span class="p">(</span><span class="n">books</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="cm">/*</span>
<span class="cm">输出：</span>

<span class="cm">母猪的产后护理 , 20.6</span>
<span class="cm">星火英语 , 32.6</span>
<span class="cm">深网 , 34.2</span>
<span class="cm">计算机网络 , 56.1</span>
<span class="cm">Android开发从入门到精通 , 70.5</span>
<span class="cm">======================</span>
<span class="cm">Android开发从入门到精通 , 70.5</span>
<span class="cm">计算机网络 , 56.1</span>
<span class="cm">深网 , 34.2</span>
<span class="cm">星火英语 , 32.6</span>
<span class="cm">母猪的产后护理 , 20.6</span>
<span class="cm">======================</span>
<span class="cm">深网 , 34.2</span>
<span class="cm">星火英语 , 32.6</span>
<span class="cm">计算机网络 , 56.1</span>
<span class="cm">母猪的产后护理 , 20.6</span>
<span class="cm">Android开发从入门到精通 , 70.5</span>
<span class="cm">======================</span>
<span class="cm">*/</span>
</code></pre></div>
</td></tr></table>
<h4 id="2_2">2. 例二<a class="headerlink" href="#2_2" title="Permanent link">&para;</a></h4>
<p>对输入三个字以上的名字转换格式，如<code>Han Shun Ping</code>转换为<code>Ping,Han .S</code>。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Index</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">method</span><span class="p">(</span><span class="s">&quot;Han Shun Ping&quot;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">method</span><span class="p">(</span><span class="n">String</span> <span class="n">str</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">String</span><span class="o">[]</span> <span class="n">splitStr</span> <span class="o">=</span> <span class="n">str</span><span class="p">.</span><span class="na">split</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">splitStr</span><span class="p">.</span><span class="na">length</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="p">(</span><span class="s">&quot;字符串格式不正确！&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">String</span> <span class="n">ans</span> <span class="o">=</span> <span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&quot;%s,%s .%c&quot;</span><span class="p">,</span> <span class="n">splitStr</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="p">,</span> <span class="n">splitStr</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">,</span> <span class="n">splitStr</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">.</span><span class="na">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">ans</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><strong>编程技巧：</strong></p>
<ol>
<li>
<p>在进行异常处理时，【写出正确情况后直接取反】比起想一系列【不正确的情况】要更加完善和方便。</p>
</li>
<li>
<p>此外，抛出异常也是适用的方法。</p>
</li>
</ol>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Index</span><span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">try</span><span class="p">{</span>
            <span class="n">method</span><span class="p">();</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;成功！&quot;</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">method</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">条件</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="p">(</span><span class="s">&quot;错误信息&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h2 id="_25">九、集合<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h2>
<p><img alt="" src="../img/collection.png" /></p>
<p><img alt="" src="../img/map.png" /></p>
<p>（<code>ConcurrentHashMap</code> 能够处理并发问题，是线程同步的，没有线程安全问题）</p>
<h3 id="collection">（一）Collection<a class="headerlink" href="#collection" title="Permanent link">&para;</a></h3>
<p><img alt="" src="../img/collectionMethod.png" /></p>
<h3 id="iterator">（二）Iterator<a class="headerlink" href="#iterator" title="Permanent link">&para;</a></h3>
<p>用于遍历集合</p>
<p><img alt="" src="../img/Iterator.png" /></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">Collection</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">arr</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="n">arr</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;张三&quot;</span><span class="p">);</span>
<span class="n">arr</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;李四&quot;</span><span class="p">);</span>
<span class="n">arr</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;Khun&quot;</span><span class="p">);</span>

<span class="n">Iterator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">iterator</span> <span class="o">=</span> <span class="n">arr</span><span class="p">.</span><span class="na">iterator</span><span class="p">();</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iterator</span><span class="p">.</span><span class="na">hasNext</span><span class="p">()){</span>
    <span class="n">Object</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">iterator</span><span class="p">.</span><span class="na">next</span><span class="p">();</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 循环结束后，iterator指向最后的元素</span>
<span class="c1">// 需要重置迭代器，才可再次使用</span>
<span class="n">iterator</span> <span class="o">=</span> <span class="n">col</span><span class="p">.</span><span class="na">iterator</span><span class="p">();</span>
</code></pre></div>
</td></tr></table>
<h3 id="list">（三）List<a class="headerlink" href="#list" title="Permanent link">&para;</a></h3>
<ul>
<li>有序、可重复；</li>
<li>有索引，使用<code>list.get()</code>；</li>
</ul>
<p><strong>常用方法：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 增</span>
<span class="n">list</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
<span class="n">list</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;world&quot;</span><span class="p">);</span>
<span class="n">list</span><span class="p">.</span><span class="na">addAll</span><span class="p">(</span><span class="n">list2</span><span class="p">);</span>
<span class="n">list</span><span class="p">.</span><span class="na">addAll</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">list2</span><span class="p">);</span>

<span class="c1">// 删</span>
<span class="n">list</span><span class="p">.</span><span class="na">remove</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="c1">// 改</span>
<span class="n">list</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;hi&quot;</span><span class="p">);</span>

<span class="c1">// 查</span>
<span class="n">list</span><span class="p">.</span><span class="na">indexOf</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">);</span>  <span class="c1">// 首次出现的位置</span>
<span class="n">list</span><span class="p">.</span><span class="na">lastIndexOf</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">);</span>  <span class="c1">// 最后出现的位置</span>
<span class="n">List</span> <span class="n">list3</span> <span class="o">=</span> <span class="n">list</span><span class="p">.</span><span class="na">subList</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="c1">// 返回[0,2)的元素</span>
</code></pre></div>
</td></tr></table>
<h3 id="arraylist">（四）ArrayList<a class="headerlink" href="#arraylist" title="Permanent link">&para;</a></h3>
<ul>
<li>底层由数组实现，<code>ArrayList</code>中维护了一个<code>transient Object[]</code>数组<code>elementData</code>（<code>transient</code>表示属性不会被系列化）；</li>
<li>可以加入null；</li>
<li>线程不安全，执行效率高;</li>
<li>使用无参构造器创建<code>ArrayList</code>对象时，默认大小为<span><span class="MathJax_Preview">0</span><script type="math/tex">0</script></span>，首次扩容时大小扩为<span><span class="MathJax_Preview">10</span><script type="math/tex">10</script></span>，此后扩容时，增大为原来的<span><span class="MathJax_Preview">1.5</span><script type="math/tex">1.5</script></span>倍；</li>
<li>如果使用指定大小的构造器创建<code>ArrayList</code>对象，初始容量为指定大小，之后扩容时，扩大为原来的<span><span class="MathJax_Preview">1.5</span><script type="math/tex">1.5</script></span>倍。</li>
</ul>
<h4 id="1_5">1. 扩容关键源码<a class="headerlink" href="#1_5" title="Permanent link">&para;</a></h4>
<p><img alt="" src="../img/ArrayList%E6%89%A9%E5%AE%B9.png" /></p>
<h4 id="2_3">2. 常用方法<a class="headerlink" href="#2_3" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">List</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="p">();</span>

<span class="c1">// 排序</span>
<span class="n">Collections</span><span class="p">.</span><span class="na">reverse</span><span class="p">(</span><span class="n">list</span><span class="p">);</span>  <span class="c1">// 反转顺序</span>
<span class="n">Collections</span><span class="p">.</span><span class="na">shuffle</span><span class="p">(</span><span class="n">list</span><span class="p">);</span>  <span class="c1">// 打乱元素随机排序</span>
<span class="n">Collections</span><span class="p">.</span><span class="na">sort</span><span class="p">(</span><span class="n">list</span><span class="p">);</span> <span class="c1">// 按元素的自然顺序排序</span>
<span class="n">Collections</span><span class="p">.</span><span class="na">sort</span><span class="p">(</span><span class="n">list</span><span class="p">,</span> <span class="k">new</span> <span class="n">Comparator</span><span class="p">(){</span>    <span class="c1">// 自定义排序顺序</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compare</span><span class="p">(</span><span class="n">Object</span> <span class="n">o1</span><span class="p">,</span> <span class="n">Object</span> <span class="n">o2</span><span class="p">){</span>
        <span class="k">return</span> <span class="p">((</span><span class="n">String</span><span class="p">)</span><span class="n">o1</span><span class="p">).</span><span class="na">length</span> <span class="o">-</span> <span class="p">((</span><span class="n">String</span><span class="p">)</span><span class="n">o2</span><span class="p">).</span><span class="na">length</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// 交换位置为0和1的元素</span>
<span class="n">Collections</span><span class="p">.</span><span class="na">swap</span><span class="p">(</span><span class="n">list</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// 求最大/最小</span>
<span class="n">Collections</span><span class="p">.</span><span class="na">max</span><span class="p">(</span><span class="n">list</span><span class="p">);</span> <span class="c1">// 返回自然顺序排序的最大值</span>
<span class="n">Collections</span><span class="p">.</span><span class="na">max</span><span class="p">(</span><span class="n">list</span><span class="p">,</span> <span class="k">new</span> <span class="n">Comparator</span><span class="p">(){</span> <span class="c1">// 自定义排序顺序中的最大值</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compare</span><span class="p">(</span><span class="n">Object</span> <span class="n">o1</span><span class="p">,</span> <span class="n">Object</span> <span class="n">o2</span><span class="p">){</span>
        <span class="k">return</span> <span class="p">((</span><span class="n">String</span><span class="p">)</span><span class="n">o1</span><span class="p">).</span><span class="na">length</span> <span class="o">-</span> <span class="p">((</span><span class="n">String</span><span class="p">)</span><span class="n">o2</span><span class="p">).</span><span class="na">length</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">});</span>
<span class="n">Collections</span><span class="p">.</span><span class="na">max</span><span class="p">(</span><span class="n">list</span><span class="p">,</span> <span class="k">new</span> <span class="n">Comparator</span><span class="p">(){</span> <span class="c1">// 返回自定义排序顺序中的最大值</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compare</span><span class="p">(</span><span class="n">Object</span> <span class="n">o1</span><span class="p">,</span> <span class="n">Object</span> <span class="n">o2</span><span class="p">){</span>
        <span class="k">return</span> <span class="p">((</span><span class="n">String</span><span class="p">)</span><span class="n">o1</span><span class="p">).</span><span class="na">length</span> <span class="o">-</span> <span class="p">((</span><span class="n">String</span><span class="p">)</span><span class="n">o2</span><span class="p">).</span><span class="na">length</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">});</span>
<span class="n">Collections</span><span class="p">.</span><span class="na">max</span><span class="p">(</span><span class="n">list</span><span class="p">,</span> <span class="k">new</span> <span class="n">Comparator</span><span class="p">(){</span> <span class="c1">// 返回自定义排序顺序中的最小值，或者把max改为min效果也一样</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compare</span><span class="p">(</span><span class="n">Object</span> <span class="n">o1</span><span class="p">,</span> <span class="n">Object</span> <span class="n">o2</span><span class="p">){</span>
        <span class="k">return</span> <span class="p">((</span><span class="n">String</span><span class="p">)</span><span class="n">o2</span><span class="p">).</span><span class="na">length</span> <span class="o">-</span> <span class="p">((</span><span class="n">String</span><span class="p">)</span><span class="n">o1</span><span class="p">).</span><span class="na">length</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// 返回元素出现次数</span>
<span class="n">Collections</span><span class="p">.</span><span class="na">frequency</span><span class="p">(</span><span class="n">list</span><span class="p">,</span><span class="s">&quot;Kun&quot;</span><span class="p">);</span>

<span class="c1">// 赋值list2中的元素到list1 (要求list1.size() ≥ list2.size())</span>
<span class="n">Collections</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span><span class="n">list2</span><span class="p">);</span>

<span class="c1">// 查找Night，并全部替换为Kun</span>
<span class="n">Collection</span><span class="p">.</span><span class="na">replaceAll</span><span class="p">(</span><span class="n">list</span><span class="p">,</span> <span class="s">&quot;Night&quot;</span><span class="p">,</span> <span class="s">&quot;Kun&quot;</span><span class="p">);</span>
</code></pre></div>
</td></tr></table>
<h3 id="vector">（五）Vector<a class="headerlink" href="#vector" title="Permanent link">&para;</a></h3>
<ul>
<li>底层也是由一个对象数组实现：<code>protected Objected[] elementData</code>；</li>
<li><code>Vector</code>是线程安全的，方法都带有<code>synchronized</code>；</li>
<li>扩容机制和<code>ArrayList</code>不同：使用无参构造器创建<code>Vector</code>对象时，默认大小为<code>10</code>；使用有参构造器创建<code>Vector</code>时，大小为指定大小，需要扩容时增大到原来的<span><span class="MathJax_Preview">2</span><script type="math/tex">2</script></span>倍；</li>
</ul>
<h3 id="linkedlist">（六）LinkedList<a class="headerlink" href="#linkedlist" title="Permanent link">&para;</a></h3>
<ul>
<li>底层实现了双向链表，增删效率较高，改查效率较低；</li>
<li>添加元素可以重复，包括<code>null</code>；</li>
<li>线程不安全。</li>
</ul>
<h3 id="set">（七）Set<a class="headerlink" href="#set" title="Permanent link">&para;</a></h3>
<ul>
<li>添加和取出顺序不一致，无索引（即不能用普通<code>for</code>循环遍历）；</li>
<li>元素不可重复（包括<code>null</code>）。</li>
</ul>
<h3 id="hashset">（八）HashSet<a class="headerlink" href="#hashset" title="Permanent link">&para;</a></h3>
<ul>
<li>底层是<code>HashMap</code>；</li>
<li>初始容量为<span><span class="MathJax_Preview">16</span><script type="math/tex">16</script></span>，临界值为<span><span class="MathJax_Preview">16*0.75=12</span><script type="math/tex">16*0.75=12</script></span>，到达临界值就以<span><span class="MathJax_Preview">2</span><script type="math/tex">2</script></span>倍扩容。</li>
</ul>
<h4 id="1_6">1. 构造器<a class="headerlink" href="#1_6" title="Permanent link">&para;</a></h4>
<p><img alt="" src="../img/HashSet_Constructor.png" /></p>
<h4 id="2_4">2. 常用方法<a class="headerlink" href="#2_4" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 增</span>
<span class="n">st</span><span class="p">.</span><span class="na">add</span><span class="p">();</span>   <span class="c1">// 添加成功返回true，否则返回false</span>

<span class="c1">// add的元素不可重复</span>
<span class="n">st</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">);</span> <span class="c1">// T</span>
<span class="n">st</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">);</span> <span class="c1">// F</span>

<span class="n">st</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="n">Dog</span><span class="p">(</span><span class="s">&quot;tom&quot;</span><span class="p">));</span> <span class="c1">// T</span>
<span class="n">st</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="n">Dog</span><span class="p">(</span><span class="s">&quot;tom&quot;</span><span class="p">));</span> <span class="c1">// T</span>

<span class="n">st</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="n">String</span><span class="p">(</span><span class="s">&quot;tom&quot;</span><span class="p">));</span>  <span class="c1">// T</span>
<span class="n">st</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="n">String</span><span class="p">(</span><span class="s">&quot;tom&quot;</span><span class="p">));</span>  <span class="c1">// F，和add的源码有关</span>
</code></pre></div>
</td></tr></table>
<h4 id="3-add">3. add()方法<a class="headerlink" href="#3-add" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="cm">/**</span>
<span class="cm">* Adds the specified element to this set if it is not already present.</span>
<span class="cm">* More formally, adds the specified element {@code e} to this set if</span>
<span class="cm">* this set contains no element {@code e2} such that</span>
<span class="cm">* {@code Objects.equals(e, e2)}.</span>
<span class="cm">* If this set already contains the element, the call leaves the set</span>
<span class="cm">* unchanged and returns {@code false}.</span>
<span class="cm">*</span>
<span class="cm">* @param e element to be added to this set</span>
<span class="cm">* @return {@code true} if this set did not already contain the specified</span>
<span class="cm">* element</span>
<span class="cm">*/</span>
<span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">add</span><span class="p">(</span><span class="n">E</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// put()返回为空表示插入成功，否则返回不为空表示已经有该值，插入失败</span>
    <span class="c1">// map是键值对的形式存储的，而set是单值存储，不需要value,因此用一个静态常量PRESENT占位</span>
    <span class="k">return</span> <span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">PRESENT</span><span class="p">)</span><span class="o">==</span><span class="kc">null</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><strong><code>put</code>中的内容详见<code>HashMap</code>添加元素原理。</strong></p>
<h4 id="4_2">4. 总结<a class="headerlink" href="#4_2" title="Permanent link">&para;</a></h4>
<p><img alt="" src="../img/HashMap_add.png" /></p>
<p><img alt="" src="../img/HashMap_add2.png" /></p>
<h4 id="5">5. 例题<a class="headerlink" href="#5" title="Permanent link">&para;</a></h4>
<p><strong>例一：</strong></p>
<p>创建包含<code>name</code>和<code>age</code>属性的类，要求<code>name</code>和<code>age</code>都相同的对象插入<code>HashSet</code>时认为是相同元素。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span> <span class="n">set</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;&gt;</span><span class="p">();</span>

        <span class="n">set</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="n">Person</span><span class="p">(</span><span class="s">&quot;张三&quot;</span><span class="p">,</span><span class="mi">23</span><span class="p">));</span>
        <span class="n">set</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="n">Person</span><span class="p">(</span><span class="s">&quot;张三&quot;</span><span class="p">,</span><span class="mi">23</span><span class="p">));</span>

        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;set size = &quot;</span><span class="o">+</span><span class="n">set</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>   <span class="c1">// 输出 set size = 1</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">Person</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="p">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">age</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">Person</span><span class="p">(</span><span class="n">String</span> <span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">age</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">age</span> <span class="o">=</span> <span class="n">age</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// 下方代码可以由 idea 中的 alt + insert 自动生成</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">equals</span><span class="p">(</span><span class="n">Object</span> <span class="n">o</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span> <span class="o">==</span> <span class="n">o</span><span class="p">)</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">o</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">getClass</span><span class="p">()</span> <span class="o">!=</span> <span class="n">o</span><span class="p">.</span><span class="na">getClass</span><span class="p">())</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="n">Person</span> <span class="n">person</span> <span class="o">=</span> <span class="p">(</span><span class="n">Person</span><span class="p">)</span> <span class="n">o</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">age</span> <span class="o">==</span> <span class="n">person</span><span class="p">.</span><span class="na">age</span> <span class="o">&amp;&amp;</span> <span class="n">Objects</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="na">name</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">Objects</span><span class="p">.</span><span class="na">hash</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">);</span>    <span class="c1">// name和age共同决定哈希值</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><strong>例二：</strong></p>
<p>已经重写了<code>People</code>的<code>name</code>和<code>id</code>属性的<code>hashCode()</code>和<code>equals()</code>方法，分析下面的过程。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">HashSet</span><span class="o">&lt;</span><span class="n">People</span><span class="o">&gt;</span> <span class="n">people</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="n">People</span> <span class="n">kun</span> <span class="o">=</span> <span class="k">new</span> <span class="n">People</span><span class="p">(</span><span class="s">&quot;Kun&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">People</span> <span class="n">night</span> <span class="o">=</span> <span class="k">new</span> <span class="n">People</span><span class="p">(</span><span class="s">&quot;Night&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

<span class="n">people</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">kun</span><span class="p">);</span>    <span class="c1">// OK</span>
<span class="n">people</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">night</span><span class="p">);</span>  <span class="c1">// OK</span>
<span class="n">night</span><span class="p">.</span><span class="na">setName</span><span class="p">(</span><span class="s">&quot;Rachel&quot;</span><span class="p">);</span>    <span class="c1">// OK</span>

<span class="c1">// 详见后文hashMap的remove源码分析</span>
<span class="c1">// 新传入的night由于hash值变了，因此定位不到原来的位置，删除失败</span>
<span class="n">people</span><span class="p">.</span><span class="na">remove</span><span class="p">(</span><span class="n">night</span><span class="p">);</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">people</span><span class="p">);</span> <span class="c1">// [{&#39;Rachel&#39;, 2}, {&#39;Kun&#39;, 1}]</span>

<span class="n">People</span> <span class="n">rachel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">People</span><span class="p">(</span><span class="s">&quot;Rachel&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">people</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">rachel</span><span class="p">);</span> <span class="c1">// OK，同样的定位方式，新的位置为空，直接插入</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">people</span><span class="p">);</span> <span class="c1">// [{&#39;Rachel&#39;, 2}, {&#39;Rachel&#39;, 2}, {&#39;Kun&#39;, 1}]</span>


<span class="n">People</span> <span class="n">night2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">People</span><span class="p">(</span><span class="s">&quot;Night&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>

<span class="c1">// OK, hash定位到night的位置</span>
<span class="c1">// 但是由于night的名字已经改成了Rachel，因此认为它和night2不一样，直接插入在链尾</span>
<span class="n">people</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">night2</span><span class="p">);</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">people</span><span class="p">);</span> <span class="c1">// [{&#39;Rachel&#39;, 2}, {&#39;Rachel&#39;, 2}, {&#39;Night&#39;, 2}, {&#39;Kun&#39;, 1}]</span>
</code></pre></div>
</td></tr></table>
<p><strong>内存结构：</strong></p>
<p><img alt="" src="../img/HashSet%E4%BE%8B%E9%A2%98%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84.png" /></p>
<h3 id="linkedhashset">（九）LinkedHashSet<a class="headerlink" href="#linkedhashset" title="Permanent link">&para;</a></h3>
<ul>
<li>底层是<code>LinkedHashMap</code>，由数组+双向链表实现（虽然源码中它继承的是<code>HashSet</code>，但是构造器、成员方法等中调用的都是<code>LinkedHashMap</code>的构造器、成员方法等）；</li>
<li>比起<code>HashSet</code>，每个节点多维护了前驱和后继两个指针，从而实现有序；</li>
<li>元素不可重复；</li>
</ul>
<p><img alt="" src="img/linkedHashMap.png" /></p>
<h3 id="treeset">（十）TreeSet<a class="headerlink" href="#treeset" title="Permanent link">&para;</a></h3>
<ul>
<li>底层是<code>TreeMap</code>;</li>
<li>设定了比较器后可以指定排序规则，否则是无序的；</li>
<li>不可重复；</li>
<li><strong>构造时一定要写比较器，或者传入的对象本身已经实现了比较器</strong>（如：<code>String</code>），因为插入元素时需要对大小进行比较。如果没有自定义比较器，底层就会自动使用对象的<code>Compatable</code>接口，如果该对象没有实现比较接口就会发生类型转换异常，详见<code>TreeMap</code>源码分析。</li>
</ul>
<p><strong>注意，能否添加进<code>TreeSet</code>取决于你设定的比较器：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">TreeSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">set</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TreeSet</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="k">new</span> <span class="n">Comparator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">()</span> <span class="p">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compare</span><span class="p">(</span><span class="n">String</span> <span class="n">o1</span><span class="p">,</span> <span class="n">String</span> <span class="n">o2</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">o1</span><span class="p">.</span><span class="na">length</span><span class="p">()</span> <span class="o">-</span> <span class="n">o2</span><span class="p">.</span><span class="na">length</span><span class="p">();</span>   <span class="c1">// 按长度排序</span>
    <span class="p">}</span>
<span class="p">});</span>
<span class="n">set</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;Kun&quot;</span><span class="p">);</span>
<span class="n">set</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;Night&quot;</span><span class="p">);</span>
<span class="n">set</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;Rachel&quot;</span><span class="p">);</span>
<span class="n">set</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;Bob&quot;</span><span class="p">);</span>

<span class="k">for</span> <span class="p">(</span><span class="n">String</span> <span class="n">s</span> <span class="p">:</span> <span class="n">set</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">输出：</span>
<span class="cm">Kun</span>
<span class="cm">Night</span>
<span class="cm">Rachel</span>
<span class="cm">*/</span>
</code></pre></div>
</td></tr></table>
<p>源码如下图所示。无法插入<code>Bob</code>，是因为它的长度和<code>Kun</code>一样，比较器返回<span><span class="MathJax_Preview">0</span><script type="math/tex">0</script></span>时<code>key</code>值不会被修改，对于<code>TreeSet</code>来说相当于直接返回了，因为它的<code>value</code>只是一个占位用的空<code>Object</code>。</p>
<p><img alt="" src="../img/TreeMap_put.png" /></p>
<p>其实它的<code>add()</code>方法底层调用的是<code>TreeMap</code>的<code>put()</code>方法。完整源码详见后文<code>TreeMap</code>的<code>put()</code>方法分析。</p>
<h3 id="map">（十一）Map<a class="headerlink" href="#map" title="Permanent link">&para;</a></h3>
<ul>
<li><code>Map</code>和<code>Collection</code>并列，并没有继承关系，区别是<code>Map</code>中保存的是键值对；</li>
<li><code>Map</code>的<code>key</code>和<code>value</code>封装在<code>Node</code>结点；</li>
<li><code>key</code>不能重复，<code>value</code>可以重复，<code>key</code>值相同的元素会直接替换；</li>
<li><code>key</code>和<code>value</code>均可以为空；</li>
<li>无序，指的是插入和取出的顺序不一致（每次取出的顺序是一致的）。</li>
</ul>
<h4 id="1_7">1. 常用方法<a class="headerlink" href="#1_7" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;key&quot;</span><span class="p">,</span><span class="s">&quot;value&quot;</span><span class="p">);</span>
<span class="n">map</span><span class="p">.</span><span class="na">remove</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<span class="n">map</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<span class="n">map</span><span class="p">.</span><span class="na">size</span><span class="p">();</span>
<span class="n">map</span><span class="p">.</span><span class="na">containsKey</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<span class="n">map</span><span class="p">.</span><span class="na">clear</span><span class="p">();</span>
</code></pre></div>
</td></tr></table>
<h4 id="2_5">2. 遍历方法<a class="headerlink" href="#2_5" title="Permanent link">&para;</a></h4>
<p>(1) 遍历所有<code>key</code>，在取出对应<code>value</code></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;昆&quot;</span><span class="p">,</span> <span class="s">&quot;灯台御史&quot;</span><span class="p">);</span>
<span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;夜&quot;</span><span class="p">,</span> <span class="s">&quot;波道使&quot;</span><span class="p">);</span>
<span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;雷克&quot;</span><span class="p">,</span> <span class="s">&quot;长枪将&quot;</span><span class="p">);</span>
<span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;安德罗西&quot;</span><span class="p">,</span> <span class="s">&quot;狩猎者&quot;</span><span class="p">);</span>

<span class="c1">// 方法 1</span>
<span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">keySet</span> <span class="o">=</span> <span class="n">map</span><span class="p">.</span><span class="na">keySet</span><span class="p">();</span>
<span class="k">for</span> <span class="p">(</span><span class="n">String</span> <span class="n">key</span> <span class="p">:</span> <span class="n">keySet</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="s">&quot; - &quot;</span> <span class="o">+</span> <span class="n">map</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
<span class="p">}</span>

<span class="c1">// 方法 2</span>
<span class="n">Iterator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">iterator</span> <span class="o">=</span> <span class="n">keySet</span><span class="p">.</span><span class="na">iterator</span><span class="p">();</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iterator</span><span class="p">.</span><span class="na">hasNext</span><span class="p">())</span> <span class="p">{</span>
    <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">iterator</span><span class="p">.</span><span class="na">next</span><span class="p">();</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="s">&quot; - &quot;</span> <span class="o">+</span> <span class="n">map</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p>(2)  遍历所有<code>value</code></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 方法 1</span>
<span class="n">Collection</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">values</span> <span class="o">=</span> <span class="n">map</span><span class="p">.</span><span class="na">values</span><span class="p">();</span>
<span class="k">for</span> <span class="p">(</span><span class="n">String</span> <span class="n">value</span> <span class="p">:</span> <span class="n">values</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 方法 2</span>
<span class="n">Iterator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">it</span> <span class="o">=</span> <span class="n">values</span><span class="p">.</span><span class="na">iterator</span><span class="p">();</span>
<span class="k">while</span> <span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="na">hasNext</span><span class="p">())</span> <span class="p">{</span>
    <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">it</span><span class="p">.</span><span class="na">next</span><span class="p">();</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p>(3) 遍历<code>EntrySet</code></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 方法 1</span>
<span class="n">Set</span><span class="o">&lt;</span><span class="n">Map</span><span class="p">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">entries</span> <span class="o">=</span> <span class="n">map</span><span class="p">.</span><span class="na">entrySet</span><span class="p">();</span>
<span class="k">for</span> <span class="p">(</span><span class="n">Map</span><span class="p">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">e</span> <span class="p">:</span> <span class="n">entries</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="na">getKey</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot; - &quot;</span> <span class="o">+</span> <span class="n">e</span><span class="p">.</span><span class="na">getValue</span><span class="p">());</span>
<span class="p">}</span>

<span class="c1">// 方法 2</span>
<span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Map</span><span class="p">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">it3</span> <span class="o">=</span> <span class="n">entries</span><span class="p">.</span><span class="na">iterator</span><span class="p">();</span>
<span class="k">while</span> <span class="p">(</span><span class="n">it3</span><span class="p">.</span><span class="na">hasNext</span><span class="p">())</span> <span class="p">{</span>
    <span class="n">Map</span><span class="p">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="o">=</span> <span class="n">it3</span><span class="p">.</span><span class="na">next</span><span class="p">();</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">entry</span><span class="p">.</span><span class="na">getKey</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot; - &quot;</span> <span class="o">+</span> <span class="n">entry</span><span class="p">.</span><span class="na">getValue</span><span class="p">());</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h3 id="hashmap">（十二）HashMap<a class="headerlink" href="#hashmap" title="Permanent link">&para;</a></h3>
<ul>
<li>底层是<strong>数组+链表+红黑树</strong>实现的；</li>
<li>没有实现<code>sychronized</code>，线程不安全。</li>
</ul>
<p>（<code>ConcurrentHashMap</code>能够处理并发问题，是线程同步的，没有线程安全问题）</p>
<h4 id="1_8">1. 容器内元素的数据结构<a class="headerlink" href="#1_8" title="Permanent link">&para;</a></h4>
<p><strong>结点：</strong></p>
<p>表中结点由<code>Node</code>保存（它实现了<code>Entry</code>接口），包含有键值对、hash值、链表的<code>next</code>指针。</p>
<p><img alt="" src="../img/Node.png" /></p>
<p>节点保存在数组中。</p>
<p><img alt="" src="../img/table.png" /></p>
<h4 id="2-hashmap">2. 遍历<code>HashMap</code><a class="headerlink" href="#2-hashmap" title="Permanent link">&para;</a></h4>
<p>有一个<code>EntrySet</code>集合，保存了指向当前<code>Entry</code>节点的引用（<code>Entry</code>是引用类型，实际运行类型是<code>Node</code>），里面包含了指向<code>Entry</code>结点的迭代器，用于遍历。</p>
<p><img alt="" src="../img/EntrySet.png" /></p>
<p><img alt="" src="../img/EntryIterator.png" /></p>
<p>此外，还有一个<code>KeySet</code>和<code>Values</code>容器，<code>KeySet</code>保存了指向<code>Entry().key</code>的引用，<code>Values</code>保存了指向<code>Entry().value</code>的引用。</p>
<p>以<code>KeySet</code>为例，<code>Values</code>类似：</p>
<p><img alt="" src="../img/KeySet.png" /></p>
<p><img alt="" src="../img/KeyIterator.png" /></p>
<h4 id="3-hashmap">3. <code>HashMap</code>内部结构图<a class="headerlink" href="#3-hashmap" title="Permanent link">&para;</a></h4>
<p><img alt="" src="../img/HashMap%E5%86%85%E9%83%A8%E7%BB%93%E6%9E%84%E5%9B%BE.png" /></p>
<h4 id="4_3">4. 添加元素源码<a class="headerlink" href="#4_3" title="Permanent link">&para;</a></h4>
<ol>
<li><code>put()</code></li>
</ol>
<p><img alt="" src="../img/HashSet_add_put.png" /></p>
<ol>
<li><code>hash()</code></li>
</ol>
<p><img alt="" src="../img/HashSet_add_put_hash.png" /></p>
<p>（对<code>Key</code>进行的<code>hash</code>并不是直接返回的<code>hashCode</code>）</p>
<ol>
<li>核心代码在<code>putVal()</code>中</li>
</ol>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="cm">/**</span>
<span class="cm">* Implements Map.put and related methods.</span>
<span class="cm">*</span>
<span class="cm">* @param hash hash for key</span>
<span class="cm">* @param key the key</span>
<span class="cm">* @param value the value to put</span>
<span class="cm">* @param onlyIfAbsent if true, don&#39;t change existing value</span>
<span class="cm">* @param evict if false, the table is in creation mode.</span>
<span class="cm">* @return previous value, or null if none</span>
<span class="cm">*/</span>
<span class="kd">final</span> <span class="n">V</span> <span class="nf">putVal</span><span class="p">(</span><span class="kt">int</span> <span class="n">hash</span><span class="p">,</span> <span class="n">K</span> <span class="n">key</span><span class="p">,</span> <span class="n">V</span> <span class="n">value</span><span class="p">,</span> <span class="kt">boolean</span> <span class="n">onlyIfAbsent</span><span class="p">,</span> <span class="kt">boolean</span> <span class="n">evict</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;[]</span> <span class="n">tab</span><span class="p">;</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">p</span><span class="p">;</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">tab</span> <span class="o">=</span> <span class="n">table</span><span class="p">)</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="n">tab</span><span class="p">.</span><span class="na">length</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">// table是HashMap中的一个Node[]属性</span>
        <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="n">tab</span> <span class="o">=</span> <span class="n">resize</span><span class="p">()).</span><span class="na">length</span><span class="p">;</span>    <span class="c1">// 初始化容量为16，临界值为12（因子为0.75）</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">p</span> <span class="o">=</span> <span class="n">tab</span><span class="o">[</span><span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">hash</span><span class="o">]</span><span class="p">)</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>  <span class="c1">// (n - 1) &amp; hash 能使下标值不超过数组长度</span>
        <span class="n">tab</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">newNode</span><span class="p">(</span><span class="n">hash</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>   <span class="c1">// 创建一个新的节点放放入数组中</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">e</span><span class="p">;</span> <span class="n">K</span> <span class="n">k</span><span class="p">;</span>

        <span class="c1">// p 在前面一个 if 中指向了当前发生冲突的数组项</span>
        <span class="c1">// 如果他们的hash值和key值（对象or基本数据值）都一样，就执行 e = p;</span>
        <span class="c1">// 因此，对象需要相同的hash值且重写equals()方法才可进入该句, String 就是这样实现的</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="na">hash</span> <span class="o">==</span> <span class="n">hash</span> <span class="o">&amp;&amp;</span> <span class="p">((</span><span class="n">k</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="na">key</span><span class="p">)</span> <span class="o">==</span> <span class="n">key</span> <span class="o">||</span> <span class="p">(</span><span class="n">key</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">key</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">k</span><span class="p">))))</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="k">instanceof</span> <span class="n">TreeNode</span><span class="p">)</span> <span class="c1">// 判断是不是红黑树</span>
            <span class="n">e</span> <span class="o">=</span> <span class="p">((</span><span class="n">TreeNode</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;</span><span class="p">)</span><span class="n">p</span><span class="p">).</span><span class="na">putTreeVal</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">tab</span><span class="p">,</span> <span class="n">hash</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span> <span class="c1">// 插入红黑树</span>
        <span class="k">else</span> <span class="p">{</span>  <span class="c1">// 是链表</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">binCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">;</span> <span class="o">++</span><span class="n">binCount</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">((</span><span class="n">e</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="na">next</span><span class="p">)</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 如果后面节点为空，就新建 Node 并插入到最后</span>
                    <span class="n">p</span><span class="p">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">newNode</span><span class="p">(</span><span class="n">hash</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">binCount</span> <span class="o">&gt;=</span> <span class="n">TREEIFY_THRESHOLD</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">// 是否已经达到8个节点</span>
                        <span class="c1">// 链表转红黑树</span>
                        <span class="c1">// treeifyBin()中还要求表长&gt;=64才能转</span>
                        <span class="c1">// 否则，就给表扩容(oldSize &lt;&lt; 1)，并对原来的数据重新hash更改在表中的位置</span>
                        <span class="n">treeifyBin</span><span class="p">(</span><span class="n">tab</span><span class="p">,</span> <span class="n">hash</span><span class="p">);</span>  
                    <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="c1">// 和前面的比较逻辑一样，如果出现了相同的节点，就直接跳出</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="na">hash</span> <span class="o">==</span> <span class="n">hash</span> <span class="o">&amp;&amp;</span>
                    <span class="p">((</span><span class="n">k</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="na">key</span><span class="p">)</span> <span class="o">==</span> <span class="n">key</span> <span class="o">||</span> <span class="p">(</span><span class="n">key</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">key</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">k</span><span class="p">))))</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">e</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">e</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 如果已经存在一样的节点e</span>
            <span class="n">V</span> <span class="n">oldValue</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="na">value</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">onlyIfAbsent</span> <span class="o">||</span> <span class="n">oldValue</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>  <span class="c1">// onlyIfAbsent传入为false</span>
                <span class="n">e</span><span class="p">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>    <span class="c1">// 替换值</span>
            <span class="n">afterNodeAccess</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">oldValue</span><span class="p">;</span>    <span class="c1">// 返回冲突节点的值</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="o">++</span><span class="n">modCount</span><span class="p">;</span>

    <span class="c1">// 超过临界值就扩容</span>
    <span class="c1">// 并且只要加入一个Node就会size++，不管Node加在链尾还是表项中，超过门限都会扩容</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">++</span><span class="n">size</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">)</span> 
        <span class="n">resize</span><span class="p">();</span>
    <span class="n">afterNodeInsertion</span><span class="p">(</span><span class="n">evict</span><span class="p">);</span>  <span class="c1">// 该方法在HashMap中为空，是为了让它的子类去实现它</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h4 id="5_1">5. 删除元素源码<a class="headerlink" href="#5_1" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="cm">/**</span>
<span class="cm">* Implements Map.remove and related methods.</span>
<span class="cm">*</span>
<span class="cm">* @param hash hash for key</span>
<span class="cm">* @param key the key</span>
<span class="cm">* @param value the value to match if matchValue, else ignored</span>
<span class="cm">* @param matchValue if true only remove if value is equal</span>
<span class="cm">* @param movable if false do not move other nodes while removing</span>
<span class="cm">* @return the node, or null if none</span>
<span class="cm">*/</span>
<span class="kd">final</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="nf">removeNode</span><span class="p">(</span><span class="kt">int</span> <span class="n">hash</span><span class="p">,</span> <span class="n">Object</span> <span class="n">key</span><span class="p">,</span> <span class="n">Object</span> <span class="n">value</span><span class="p">,</span>
                           <span class="kt">boolean</span> <span class="n">matchValue</span><span class="p">,</span> <span class="kt">boolean</span> <span class="n">movable</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;[]</span> <span class="n">tab</span><span class="p">;</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">p</span><span class="p">;</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">index</span><span class="p">;</span>

    <span class="c1">// 同样的，查询被删除元素时，要比较hash值和equals两个方面，全部相同才能删</span>
    <span class="c1">// 所以，如果插入的元素值中途被修改了，有可能删除不成功</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">tab</span> <span class="o">=</span> <span class="n">table</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="n">tab</span><span class="p">.</span><span class="na">length</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span>
        <span class="p">(</span><span class="n">p</span> <span class="o">=</span> <span class="n">tab</span><span class="o">[</span><span class="n">index</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">hash</span><span class="o">]</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// 通过传入的hash值确定元素位置</span>
        <span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">node</span> <span class="o">=</span> <span class="kc">null</span><span class="p">,</span> <span class="n">e</span><span class="p">;</span> <span class="n">K</span> <span class="n">k</span><span class="p">;</span> <span class="n">V</span> <span class="n">v</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="na">hash</span> <span class="o">==</span> <span class="n">hash</span> <span class="o">&amp;&amp;</span>
            <span class="p">((</span><span class="n">k</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="na">key</span><span class="p">)</span> <span class="o">==</span> <span class="n">key</span> <span class="o">||</span> <span class="p">(</span><span class="n">key</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">key</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">k</span><span class="p">))))</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">((</span><span class="n">e</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="na">next</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="k">instanceof</span> <span class="n">TreeNode</span><span class="p">)</span>
                <span class="n">node</span> <span class="o">=</span> <span class="p">((</span><span class="n">TreeNode</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;</span><span class="p">)</span><span class="n">p</span><span class="p">).</span><span class="na">getTreeNode</span><span class="p">(</span><span class="n">hash</span><span class="p">,</span> <span class="n">key</span><span class="p">);</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">do</span> <span class="p">{</span>    <span class="c1">// 遍历链表</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="na">hash</span> <span class="o">==</span> <span class="n">hash</span> <span class="o">&amp;&amp;</span>
                        <span class="p">((</span><span class="n">k</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="na">key</span><span class="p">)</span> <span class="o">==</span> <span class="n">key</span> <span class="o">||</span>
                         <span class="p">(</span><span class="n">key</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">key</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">k</span><span class="p">))))</span> <span class="p">{</span>
                        <span class="n">node</span> <span class="o">=</span> <span class="n">e</span><span class="p">;</span>   <span class="c1">// node记录当前要删的节点</span>
                        <span class="k">break</span><span class="p">;</span>  <span class="c1">// break的时候p指向node的上一个节点</span>
                    <span class="p">}</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="n">e</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">while</span> <span class="p">((</span><span class="n">e</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="na">next</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// matchValue传入为false</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">node</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="n">matchValue</span> <span class="o">||</span> <span class="p">(</span><span class="n">v</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="na">value</span><span class="p">)</span> <span class="o">==</span> <span class="n">value</span> <span class="o">||</span>
                             <span class="p">(</span><span class="n">value</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">value</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">v</span><span class="p">))))</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">node</span> <span class="k">instanceof</span> <span class="n">TreeNode</span><span class="p">)</span>   <span class="c1">// 树上的节点</span>
                <span class="p">((</span><span class="n">TreeNode</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;</span><span class="p">)</span><span class="n">node</span><span class="p">).</span><span class="na">removeTreeNode</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">tab</span><span class="p">,</span> <span class="n">movable</span><span class="p">);</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">node</span> <span class="o">==</span> <span class="n">p</span><span class="p">)</span> <span class="c1">// 节点在表中，也就是链首</span>
                <span class="n">tab</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="na">next</span><span class="p">;</span> <span class="c1">// 被后一个节点覆盖</span>
            <span class="k">else</span>    <span class="c1">// 节点在链表上</span>
                <span class="n">p</span><span class="p">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="na">next</span><span class="p">;</span>     <span class="c1">// p是node的前驱节点，p.next=node.next相当于删掉了node</span>
            <span class="o">++</span><span class="n">modCount</span><span class="p">;</span>
            <span class="o">--</span><span class="n">size</span><span class="p">;</span>
            <span class="n">afterNodeRemoval</span><span class="p">(</span><span class="n">node</span><span class="p">);</span> <span class="c1">// 该方法为空，为子类留下的后续操作</span>
            <span class="k">return</span> <span class="n">node</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h4 id="6">6. 总结<a class="headerlink" href="#6" title="Permanent link">&para;</a></h4>
<p><img alt="" src="../img/HashMap_add.png" /></p>
<h3 id="linkedhashmap">（十三）LinkedHashMap<a class="headerlink" href="#linkedhashmap" title="Permanent link">&para;</a></h3>
<h4 id="1_9">1. 源码分析<a class="headerlink" href="#1_9" title="Permanent link">&para;</a></h4>
<p><strong>节点：</strong></p>
<p>表中存放了<code>head</code>和<code>tail</code>指针来指向起始和终止节点；</p>
<p><img alt="" src="../img/head%26tail.png" /></p>
<p>表内结点由<code>Entry</code>保存，它继承自<code>HashMap</code>的<code>Node</code>，只是多了前驱和后继两个指针。</p>
<p><img alt="" src="../img/Entry.png" /></p>
<p><strong>添加元素：</strong></p>
<p>走的是父类的<code>add()</code>，因此最终调用的还是<code>HashMap</code>的<code>putVal()</code>方法。</p>
<h3 id="treemap">（十四）TreeMap<a class="headerlink" href="#treemap" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>构造时一定要写比较器，或者传入的对象本身已经实现了比较器</strong>（如：<code>String</code>），因为插入元素时需要对大小进行比较。如果没有自定义比较器，底层就会自动使用对象的<code>Compatable</code>接口，如果该对象没有实现比较接口就会发生类型转换异常，详见下方源码分析。</li>
</ul>
<h4 id="1-put">1. put()源码分析<a class="headerlink" href="#1-put" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="cm">/**</span>
<span class="cm">* Associates the specified value with the specified key in this map.</span>
<span class="cm">* If the map previously contained a mapping for the key, the old</span>
<span class="cm">* value is replaced.</span>
<span class="cm">*</span>
<span class="cm">* @param key key with which the specified value is to be associated</span>
<span class="cm">* @param value value to be associated with the specified key</span>
<span class="cm">*</span>
<span class="cm">* @return the previous value associated with {@code key}, or</span>
<span class="cm">*         {@code null} if there was no mapping for {@code key}.</span>
<span class="cm">*         (A {@code null} return can also indicate that the map</span>
<span class="cm">*         previously associated {@code null} with {@code key}.)</span>
<span class="cm">* @throws ClassCastException if the specified key cannot be compared</span>
<span class="cm">*         with the keys currently in the map</span>
<span class="cm">* @throws NullPointerException if the specified key is null</span>
<span class="cm">*         and this map uses natural ordering, or its comparator</span>
<span class="cm">*         does not permit null keys</span>
<span class="cm">*/</span>
<span class="kd">public</span> <span class="n">V</span> <span class="nf">put</span><span class="p">(</span><span class="n">K</span> <span class="n">key</span><span class="p">,</span> <span class="n">V</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">root</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">compare</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">key</span><span class="p">);</span> <span class="c1">// compare中有判空操作，如果为空会抛异常</span>

        <span class="n">root</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Entry</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">modCount</span><span class="o">++</span><span class="p">;</span>
        <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="n">cmp</span><span class="p">;</span>
    <span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">parent</span><span class="p">;</span>
    <span class="c1">// split comparator and comparable paths</span>
    <span class="n">Comparator</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">K</span><span class="o">&gt;</span> <span class="n">cpr</span> <span class="o">=</span> <span class="n">comparator</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">cpr</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">t</span><span class="p">;</span>
            <span class="n">cmp</span> <span class="o">=</span> <span class="n">cpr</span><span class="p">.</span><span class="na">compare</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">t</span><span class="p">.</span><span class="na">key</span><span class="p">);</span>  <span class="c1">// 传入的比较器</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">cmp</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="na">left</span><span class="p">;</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">cmp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="na">right</span><span class="p">;</span>
            <span class="k">else</span>
                <span class="k">return</span> <span class="n">t</span><span class="p">.</span><span class="na">setValue</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>   <span class="c1">// 比较结果相等时不会改变key值，直接替换value值</span>
        <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">t</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">key</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">NullPointerException</span><span class="p">();</span>
        <span class="nd">@SuppressWarnings</span><span class="p">(</span><span class="s">&quot;unchecked&quot;</span><span class="p">)</span>
        <span class="n">Comparable</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">K</span><span class="o">&gt;</span> <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">Comparable</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">K</span><span class="o">&gt;</span><span class="p">)</span> <span class="n">key</span><span class="p">;</span>  <span class="c1">// 用key自带的比较器，所以如果key没有实现比较器接口的话，强转就会失败，报类型转换异常</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">t</span><span class="p">;</span>
            <span class="n">cmp</span> <span class="o">=</span> <span class="n">k</span><span class="p">.</span><span class="na">compareTo</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="na">key</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">cmp</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="na">left</span><span class="p">;</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">cmp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="na">right</span><span class="p">;</span>
            <span class="k">else</span>
                <span class="k">return</span> <span class="n">t</span><span class="p">.</span><span class="na">setValue</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">t</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Entry</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">parent</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">cmp</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">parent</span><span class="p">.</span><span class="na">left</span> <span class="o">=</span> <span class="n">e</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="n">parent</span><span class="p">.</span><span class="na">right</span> <span class="o">=</span> <span class="n">e</span><span class="p">;</span>
    <span class="n">fixAfterInsertion</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
    <span class="n">size</span><span class="o">++</span><span class="p">;</span>
    <span class="n">modCount</span><span class="o">++</span><span class="p">;</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h4 id="2_6">2. 例题<a class="headerlink" href="#2_6" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">TreeMap</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TreeMap</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="k">new</span> <span class="n">Comparator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">()</span> <span class="p">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compare</span><span class="p">(</span><span class="n">String</span> <span class="n">o1</span><span class="p">,</span> <span class="n">String</span> <span class="n">o2</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">o1</span><span class="p">.</span><span class="na">length</span><span class="p">()</span> <span class="o">-</span> <span class="n">o2</span><span class="p">.</span><span class="na">length</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;Kun&quot;</span><span class="p">,</span> <span class="s">&quot;15&quot;</span><span class="p">);</span>
<span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;Night&quot;</span><span class="p">,</span> <span class="s">&quot;15&quot;</span><span class="p">);</span>
<span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;Rachel&quot;</span><span class="p">,</span> <span class="s">&quot;14&quot;</span><span class="p">);</span>
<span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;Bob&quot;</span><span class="p">,</span> <span class="s">&quot;20&quot;</span><span class="p">);</span>

<span class="n">Set</span><span class="o">&lt;</span><span class="n">Map</span><span class="p">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">entries</span> <span class="o">=</span> <span class="n">map</span><span class="p">.</span><span class="na">entrySet</span><span class="p">();</span>
<span class="k">for</span> <span class="p">(</span><span class="n">Map</span><span class="p">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="p">:</span> <span class="n">entries</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">entry</span><span class="p">.</span><span class="na">getKey</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot; - &quot;</span> <span class="o">+</span> <span class="n">entry</span><span class="p">.</span><span class="na">getValue</span><span class="p">());</span>
<span class="p">}</span>

<span class="cm">/* 输出：</span>
<span class="cm">Kun - 20</span>
<span class="cm">Night - 15</span>
<span class="cm">Rachel - 14</span>
<span class="cm">*/</span>
</code></pre></div>
</td></tr></table>
<p>根据源码可知，传入的比较器判断<code>Bub</code>和<code>Kun</code>长度相同，因此将<code>Kun</code>的<code>value</code>改为了<code>20</code>，而后返回。</p>
<h3 id="hashtable">（十五）Hashtable<a class="headerlink" href="#hashtable" title="Permanent link">&para;</a></h3>
<ul>
<li>存放键值对，都不能为<code>null</code>；</li>
<li>继承<code>Dictionary</code>，实现<code>Map</code>接口；</li>
<li>使用方法与<code>HashMap</code>基本一致；</li>
<li>有<code>synchronized</code>关键字，线程安全；</li>
<li><code>key</code>值相同的元素会直接替换；</li>
<li>默认初始化<code>table</code>大小为<span><span class="MathJax_Preview">11</span><script type="math/tex">11</script></span>，门限值为<span><span class="MathJax_Preview">0.75</span><script type="math/tex">0.75</script></span>；</li>
<li>到达门限值时，以原来的大小<span><span class="MathJax_Preview">2</span><script type="math/tex">2</script></span>倍<span><span class="MathJax_Preview">+1</span><script type="math/tex">+1</script></span>的方式扩容。</li>
</ul>
<h4 id="1_10">1. 扩容机制源码<a class="headerlink" href="#1_10" title="Permanent link">&para;</a></h4>
<p><img alt="" src="../img/Hashtable_put.png" /></p>
<p><img alt="" src="../img/Hashtable_addEntry.png" /></p>
<p><img alt="" src="../img/Hashtable_rehash.png" /></p>
<h3 id="properties">（十六）Properties<a class="headerlink" href="#properties" title="Permanent link">&para;</a></h3>
<ul>
<li>继承自<code>Hashtable</code>，并实现了<code>map</code>接口；</li>
<li>键值对的方式保存数据，无序，不能有空值，与<code>Hashtable</code>类似；</li>
<li>若有相同的<code>key</code>值，直接替换；</li>
<li>可以用于从<code>xxx.properties</code>配置文件中加载数据到<code>Properties</code>类对象中。</li>
</ul>
<p><strong>常用方法：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 增</span>
<span class="n">properties</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="n">value</span><span class="p">);</span>

<span class="c1">// 删</span>
<span class="n">properties</span><span class="p">.</span><span class="na">remove</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>

<span class="c1">// 改</span>
<span class="n">properties</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">相同key</span><span class="p">,</span><span class="n">value</span><span class="p">);</span>

<span class="c1">// 查</span>
<span class="n">properties</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<span class="n">properties</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
</code></pre></div>
</td></tr></table>
<p>用法详见 第十四章 IO流 -（三）节点流和处理流 - 6. Properties</p>
<h3 id="_26">（十七）容器的边遍历边删除<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">Vector</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">vec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Vector</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="n">vec</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">vec</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">vec</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="n">vec</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="n">vec</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="n">vec</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>

<span class="c1">// 错误写法：</span>
<span class="k">for</span><span class="p">(</span><span class="n">Integer</span> <span class="n">num</span><span class="p">:</span> <span class="n">vec</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">num</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">vec</span><span class="p">.</span><span class="na">remove</span><span class="p">(</span><span class="n">num</span><span class="p">);</span>    <span class="c1">// 会报错ConcurrentModificationException异常</span>
<span class="p">}</span>

<span class="c1">// 正确写法1：</span>
<span class="n">Iterator</span> <span class="n">it</span> <span class="o">=</span> <span class="n">vec</span><span class="p">.</span><span class="na">iterator</span><span class="p">();</span>
<span class="k">while</span><span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="na">hasNext</span><span class="p">()){</span>
    <span class="n">Integer</span> <span class="n">num</span> <span class="o">=</span> <span class="n">it</span><span class="p">.</span><span class="na">next</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">num</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">it</span><span class="p">.</span><span class="na">remove</span><span class="p">();</span>    <span class="c1">// 使用迭代器的remove()方法</span>
<span class="p">}</span>

<span class="c1">// 正确写法2：</span>
<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">vec</span><span class="p">.</span><span class="na">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
    <span class="n">Integer</span> <span class="n">num</span> <span class="o">=</span> <span class="n">vec</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">num</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">){</span>
        <span class="n">vec</span><span class="p">.</span><span class="na">remove</span><span class="p">(</span><span class="n">num</span><span class="p">);</span>    <span class="c1">// 删除后，容器后面的元素会自动前移</span>
        <span class="n">i</span><span class="o">--</span><span class="p">;</span>    <span class="c1">// 因此指针需要往前一位</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h2 id="_27">十、泛型<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h2>
<h3 id="_28">（一）泛型优点<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h3>
<ol>
<li>直接插入集合对元素类型没有约束，向下转型时不安全；</li>
<li>遍历时需要一个一个向下转型，效率低。</li>
</ol>
<h3 id="_29">（二）使用细节<a class="headerlink" href="#_29" title="Permanent link">&para;</a></h3>
<ol>
<li>泛型不能是基本数据类型；</li>
<li>传入的实际类型可以是泛型的子类类型；</li>
<li>简写：<code>List&lt;String&gt; list = new ArrayList&lt;&gt;();</code></li>
<li>如果创建对象/容器时不指定泛型类型，默认为<code>Object</code>类型；</li>
<li>不能直接初始化，因为编译时无法确定类型；</li>
<li><code>static</code>和泛型不共存，因为静态属性/方法在类加载时确定，而泛型在编译时确定；</li>
<li>实现泛型时不指定类型，默认为<code>Object</code>类型，但是不建议这么写；</li>
<li>泛型不能继承：<code>List&lt;Object&gt; list= new ArrayList&lt;String&gt;();</code> 错误写法。</li>
</ol>
<h3 id="_30">（三） 使用方法<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 泛型类</span>
<span class="kd">class</span> <span class="nc">Animal</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">R</span><span class="o">&gt;</span><span class="p">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">(</span><span class="n">R</span> <span class="n">r</span><span class="p">){</span>   <span class="c1">// 不是泛型方法，是使用了泛型</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="n">Animal</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">animal</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Animal</span><span class="o">&lt;&gt;</span><span class="p">();</span>

<span class="c1">// 泛型接口</span>
<span class="kd">interface</span> <span class="nc">USB</span><span class="o">&lt;</span><span class="n">E</span><span class="p">,</span><span class="n">R</span><span class="o">&gt;</span><span class="p">{</span>
    <span class="n">E</span> <span class="nf">charge</span><span class="p">(</span><span class="n">R</span> <span class="n">r</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nc">Computer</span> <span class="n">inmplements</span> <span class="n">USB</span><span class="o">&lt;</span><span class="n">Integer</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span><span class="p">{</span>    
<span class="p">}</span>

<span class="c1">// 泛型方法</span>
<span class="kd">class</span> <span class="nc">Person</span><span class="p">{</span>
    <span class="kd">public</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">E</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">eat</span><span class="p">(</span><span class="n">T</span> <span class="n">t</span><span class="p">,</span><span class="n">E</span> <span class="n">e</span><span class="p">){</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="n">Person</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Person</span><span class="p">();</span>
<span class="n">p</span><span class="p">.</span><span class="na">eat</span><span class="p">(</span><span class="s">&quot;三&quot;</span><span class="p">,</span><span class="mi">100</span><span class="p">);</span> <span class="c1">// 编译器自动判断类型</span>
</code></pre></div>
</td></tr></table>
<p><strong><code>?</code>符号</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">method</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;?&gt;</span><span class="p">){</span>    <span class="c1">// 可以是任意类型</span>

<span class="p">}</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">method</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;?</span> <span class="n">extend</span> <span class="n">AA</span><span class="o">&gt;</span><span class="p">){</span>  <span class="c1">// 只能是AA或AA的子类</span>

<span class="p">}</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">method</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">AA</span><span class="o">&gt;</span><span class="p">){</span>   <span class="c1">// 只能是AA或AA的父类</span>

<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h2 id="java">十一、<code>Java</code>绘图<a class="headerlink" href="#java" title="Permanent link">&para;</a></h2>
<h3 id="_31">（一）基本语法<a class="headerlink" href="#_31" title="Permanent link">&para;</a></h3>
<p><strong>样例：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyFrame</span> <span class="kd">extends</span> <span class="n">JFrame</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="n">MyPanel</span> <span class="n">mp</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">MyFrame</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">mp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyPanel</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">mp</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">setSize</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">setVisible</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

        <span class="c1">// 点关闭按钮时，程序同时退出(不加这行代码，关闭绘图窗口后程序还在运行)</span>
        <span class="k">this</span><span class="p">.</span><span class="na">setDefaultCloseOperation</span><span class="p">(</span><span class="n">JFrame</span><span class="p">.</span><span class="na">EXIT_ON_CLOSE</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">new</span> <span class="n">MyFrame</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">MyPanel</span> <span class="kd">extends</span> <span class="n">JPanel</span> <span class="p">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">paint</span><span class="p">(</span><span class="n">Graphics</span> <span class="n">g</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">.</span><span class="na">paint</span><span class="p">(</span><span class="n">g</span><span class="p">);</span>
        <span class="n">g</span><span class="p">.</span><span class="na">drawOval</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>   <span class="c1">// (10,10)是其外接矩形左上角点的位置</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><strong>paint()方法被调用的时机：</strong></p>
<ol>
<li>首次创建时；</li>
<li>窗口大小变化时；</li>
<li>窗口最小化后又重新打开时；</li>
<li><code>repaint()</code>方法被调用时。</li>
</ol>
<p><strong>其他图形绘制：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 绘制图片</span>
<span class="n">Image</span> <span class="n">image</span> <span class="o">=</span> <span class="n">Toolkit</span><span class="p">.</span><span class="na">getDefaultToolkit</span><span class="p">().</span><span class="na">getImage</span><span class="p">(</span><span class="n">MyPanel</span><span class="p">.</span><span class="na">class</span><span class="p">.</span><span class="na">getResource</span><span class="p">(</span><span class="s">&quot;/kun.png&quot;</span><span class="p">));</span>  <span class="c1">// MyPanel表示从该类所在的项目根部开始查找文件</span>
<span class="n">g</span><span class="p">.</span><span class="na">drawImage</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>

<span class="c1">// 绘制文字</span>
<span class="n">g</span><span class="p">.</span><span class="na">setColor</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">red</span><span class="p">);</span>
<span class="n">g</span><span class="p">.</span><span class="na">setFont</span><span class="p">(</span><span class="k">new</span> <span class="n">Font</span><span class="p">(</span><span class="s">&quot;隶书&quot;</span><span class="p">,</span> <span class="n">Font</span><span class="p">.</span><span class="na">BOLD</span><span class="p">,</span> <span class="mi">38</span><span class="p">));</span>
<span class="n">g</span><span class="p">.</span><span class="na">drawString</span><span class="p">(</span><span class="s">&quot;Hello World&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>  <span class="c1">// 注意，(100,100)指的是字体左下角位置</span>
</code></pre></div>
</td></tr></table>
<h3 id="_32">（二）键盘事件监听<a class="headerlink" href="#_32" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MoveBall</span> <span class="kd">extends</span> <span class="n">JFrame</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="nf">MoveBall</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">Ball</span> <span class="n">ball</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Ball</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">ball</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">setSize</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">setDefaultCloseOperation</span><span class="p">(</span><span class="n">JFrame</span><span class="p">.</span><span class="na">EXIT_ON_CLOSE</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">addKeyListener</span><span class="p">(</span><span class="n">ball</span><span class="p">);</span>  <span class="c1">// 别忘了添加监听器</span>
        <span class="k">this</span><span class="p">.</span><span class="na">setVisible</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">new</span> <span class="n">MoveBall</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">Ball</span> <span class="kd">extends</span> <span class="n">JPanel</span> <span class="kd">implements</span> <span class="n">KeyListener</span> <span class="p">{</span>  <span class="c1">// 实现按键监听接口</span>
    <span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">y</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">Ball</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">paint</span><span class="p">(</span><span class="n">Graphics</span> <span class="n">g</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">.</span><span class="na">paint</span><span class="p">(</span><span class="n">g</span><span class="p">);</span>
        <span class="n">g</span><span class="p">.</span><span class="na">fillOval</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">keyTyped</span><span class="p">(</span><span class="n">KeyEvent</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">keyPressed</span><span class="p">(</span><span class="n">KeyEvent</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="na">getKeyCode</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;键被按下...&quot;</span><span class="p">);</span>
        <span class="k">switch</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="na">getKeyCode</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">case</span> <span class="n">KeyEvent</span><span class="p">.</span><span class="na">VK_UP</span><span class="p">:</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;向上&quot;</span><span class="p">);</span>
                <span class="n">y</span><span class="o">--</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">KeyEvent</span><span class="p">.</span><span class="na">VK_DOWN</span><span class="p">:</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;向下&quot;</span><span class="p">);</span>
                <span class="n">y</span><span class="o">++</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">KeyEvent</span><span class="p">.</span><span class="na">VK_LEFT</span><span class="p">:</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;向左&quot;</span><span class="p">);</span>
                <span class="n">x</span><span class="o">--</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">KeyEvent</span><span class="p">.</span><span class="na">VK_RIGHT</span><span class="p">:</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;向右&quot;</span><span class="p">);</span>
                <span class="n">x</span><span class="o">++</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="na">repaint</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">keyReleased</span><span class="p">(</span><span class="n">KeyEvent</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h2 id="_33">十二、线程<a class="headerlink" href="#_33" title="Permanent link">&para;</a></h2>
<h3 id="_34">（一）并发与并行<a class="headerlink" href="#_34" title="Permanent link">&para;</a></h3>
<p><strong>并发：</strong>同一时间段内执行多个任务，它们不断切换进行（单核或多核<code>CPU</code>执行多任务）；</p>
<p><strong>并行：</strong>同一时刻执行多个任务（多核<code>CPU</code>执行多任务）。</p>
<p><strong>获取当前电脑的<code>CPU</code>数量：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">Runtime</span> <span class="n">runtime</span> <span class="o">=</span> <span class="n">Runtime</span><span class="p">.</span><span class="na">getRuntime</span><span class="p">();</span>
<span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="n">runtime</span><span class="p">.</span><span class="na">availableProcessors</span><span class="p">();</span>    <span class="c1">// CPU数量</span>
</code></pre></div>
</td></tr></table>
<p><strong>获取线程名：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">();</span>
</code></pre></div>
</td></tr></table>
<p><strong>工具：</strong></p>
<p><code>jconsole</code>工具，可视化线程执行情况。</p>
<p>可以看到，主线程即使运行结束了，若还有其他线程在运行，程序并不会结束。</p>
<h3 id="run">（二）<code>run()</code>方法<a class="headerlink" href="#run" title="Permanent link">&para;</a></h3>
<p>为什么不能直接调用run()方法，而实使用start()启动？</p>
<p>因为直接调用<code>run()</code>方法，相当于启动的是<code>main</code>方法的<code>run()</code>，而不是对应子线程的。</p>
<p><strong>源码：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">start</span><span class="p">()</span> <span class="p">{</span>
    <span class="cm">/**</span>
<span class="cm">     * This method is not invoked for the main method thread or &quot;system&quot;</span>
<span class="cm">     * group threads created/set up by the VM. Any new functionality added</span>
<span class="cm">     * to this method in the future may have to also be added to the VM.</span>
<span class="cm">     *</span>
<span class="cm">     * A zero status value corresponds to state &quot;NEW&quot;.</span>
<span class="cm">     */</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">threadStatus</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalThreadStateException</span><span class="p">();</span>

    <span class="cm">/* Notify the group that this thread is about to be started</span>
<span class="cm">     * so that it can be added to the group&#39;s list of threads</span>
<span class="cm">     * and the group&#39;s unstarted count can be decremented. */</span>
    <span class="n">group</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

    <span class="kt">boolean</span> <span class="n">started</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="n">start0</span><span class="p">();</span>   <span class="c1">// 核心代码在start0()，它是一个本地native方法，由JVM调用</span>
        <span class="n">started</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">started</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">group</span><span class="p">.</span><span class="na">threadStartFailed</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Throwable</span> <span class="n">ignore</span><span class="p">)</span> <span class="p">{</span>
            <span class="cm">/* do nothing. If start0 threw a Throwable then</span>
<span class="cm">                  it will be passed up the call stack */</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><strong><code>start0()</code>是实现多线程的关键，底层是<code>C/C++</code>实现的，由<code>JVM</code>调用。</strong></p>
<h3 id="_35">（三）线程实现的方式<a class="headerlink" href="#_35" title="Permanent link">&para;</a></h3>
<h4 id="thread">方式一、继承<code>Thread</code><a class="headerlink" href="#thread" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">class</span> <span class="nc">MyThread</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="p">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h4 id="runnable">方式二、实现<code>Runnable</code>接口<a class="headerlink" href="#runnable" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Hi</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">SayHi</span> <span class="n">hi</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SayHi</span><span class="p">();</span>
        <span class="n">Thread</span> <span class="n">thread</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="p">(</span><span class="n">hi</span><span class="p">);</span> <span class="c1">// 使用了代理模式</span>
        <span class="n">thread</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">SayHi</span> <span class="kd">implements</span> <span class="n">Runnable</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;咪唔~ &quot;</span> <span class="o">+</span> <span class="n">num</span><span class="o">++</span> <span class="o">+</span> <span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">());</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">num</span> <span class="o">==</span> <span class="mi">80</span><span class="p">)</span>
                <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><strong>区别：</strong></p>
<p>两种方法在功能上完全一样，但是<strong>实现<code>Runnable</code>接口的方式能够复用功能，让多个线程共享资源</strong>，并且避免了单继承的限制。</p>
<p><strong>问题：</strong></p>
<p>多个线程共同执行操作某个资源时，就会出现线程的同步或互斥问题，解决方法详见第十三章<code>sychrnized</code>。</p>
<h3 id="runnable_1">（四） 以<code>Runnable</code>为例的代理模式<a class="headerlink" href="#runnable_1" title="Permanent link">&para;</a></h3>
<p>核心就是：代理类既实现了接口，又通过构造器传入了接口，在其方法中实际调用的是别人的方法。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Index</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">MyCat</span> <span class="n">myCat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyCat</span><span class="p">();</span>
        <span class="n">MyThread</span> <span class="n">myThread</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyThread</span><span class="p">(</span><span class="n">myCat</span><span class="p">);</span>
        <span class="n">myThread</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * 子线程MyCat，实现了MyRunnable接口</span>
<span class="cm"> */</span>
<span class="kd">class</span> <span class="nc">MyCat</span> <span class="kd">implements</span> <span class="n">MyRunnable</span> <span class="p">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;meo—— meo——&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * 接口</span>
<span class="cm"> */</span>
<span class="kd">interface</span> <span class="nc">MyRunnable</span> <span class="p">{</span>
    <span class="kt">void</span> <span class="nf">run</span><span class="p">();</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * 既实现了MyRunnable接口，又通过构造器传入了MyRunnable对象</span>
<span class="cm"> * 虽然使用的是MyThread的start方法，但是实际调用的是MyRunnable的run()方法</span>
<span class="cm"> * （注意，实际线程的start()源码不是这样写的，这里只是便于展示代理模式）</span>
<span class="cm"> */</span>
<span class="kd">class</span> <span class="nc">MyThread</span> <span class="kd">implements</span> <span class="n">MyRunnable</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="n">MyRunnable</span> <span class="n">runnable</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">runnable</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
            <span class="n">runnable</span><span class="p">.</span><span class="na">run</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="nf">MyThread</span><span class="p">(</span><span class="n">MyRunnable</span> <span class="n">runnable</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">runnable</span> <span class="o">=</span> <span class="n">runnable</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="p">(){</span>
        <span class="n">start0</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">start0</span><span class="p">(){</span>
        <span class="n">run</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h3 id="_36">（五）线程终止<a class="headerlink" href="#_36" title="Permanent link">&para;</a></h3>
<p>使用一个变量<code>flag</code>控制</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Index</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="p">{</span>
        <span class="n">ThreadA</span> <span class="n">threadA</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ThreadA</span><span class="p">();</span>
        <span class="n">threadA</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>

        <span class="c1">// 等待五秒关闭线程A</span>
        <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">5000</span><span class="p">);</span>
        <span class="n">threadA</span><span class="p">.</span><span class="na">setFlag</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">ThreadA</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">flag</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">.</span><span class="na">run</span><span class="p">();</span>

        <span class="k">while</span> <span class="p">(</span><span class="n">flag</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">num</span><span class="o">++</span><span class="p">;</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;, num = &quot;</span> <span class="o">+</span> <span class="n">num</span><span class="p">);</span>

            <span class="k">try</span> <span class="p">{</span>
                <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setFlag</span><span class="p">(</span><span class="kt">boolean</span> <span class="n">flag</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">flag</span> <span class="o">=</span> <span class="n">flag</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h3 id="_37">（六）线程常用方法<a class="headerlink" href="#_37" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">setName</span><span class="p">()</span>    <span class="c1">// 设置线程名称</span>
<span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span>    <span class="c1">// 设获取线程名称</span>
<span class="n">thread</span><span class="p">.</span><span class="na">start</span><span class="p">()</span>  <span class="c1">// 开始执行线程</span>
<span class="n">thread</span><span class="p">.</span><span class="na">interrupt</span><span class="p">()</span>  <span class="c1">// 中断线程，一般用于唤醒正在休眠的线程</span>
<span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">()</span>  <span class="c1">// 使当前线程休眠</span>

<span class="c1">// Thread有3个优先级常量，值分别为1、5、10</span>
<span class="n">thread</span><span class="p">.</span><span class="na">setPriority</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">MIN_PRIORITY</span><span class="p">)</span> <span class="c1">// 更改线程优先级为1</span>
<span class="n">thread</span><span class="p">.</span><span class="na">getPriority</span><span class="p">()</span> <span class="c1">// 获取线程优先级</span>

<span class="n">Thread</span><span class="p">.</span><span class="na">yield</span><span class="p">()</span>  <span class="c1">// 线程的礼让，让其他线程先行，但是不一定成功</span>
<span class="n">threa</span><span class="p">.</span><span class="na">join</span><span class="p">()</span>    <span class="c1">// 线程的插队</span>
</code></pre></div>
</td></tr></table>
<p><strong>join()：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TheadJoin</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="p">{</span>
        <span class="n">Thread1</span> <span class="n">thread1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread1</span><span class="p">();</span>
        <span class="n">thread1</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;主线程&quot;</span> <span class="o">+</span> <span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;吃了&quot;</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s">&quot;个包子&quot;</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;==============主线程让子线程先吃&quot;</span><span class="p">);</span>
                <span class="n">thread1</span><span class="p">.</span><span class="na">join</span><span class="p">();</span> <span class="c1">// 主线程中断，直到子线程1运行完再继续</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;==============主线程接着吃&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">Thread1</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="p">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">.</span><span class="na">run</span><span class="p">();</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;线程&quot;</span> <span class="o">+</span> <span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;吃了&quot;</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s">&quot;个包子&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h3 id="_38">（七）用户线程与守护线程<a class="headerlink" href="#_38" title="Permanent link">&para;</a></h3>
<p><strong>用户线程：</strong>又名工作线程，当任务执行完毕或被通知的时候结束线程。</p>
<p><strong>守护线程：</strong>为工作线程服务，所有用户线程结束后，守护线程随之结束。</p>
<p>最典型的守护线程如：垃圾回收机制。</p>
<p><strong>制作守护线程：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Index</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="p">{</span>
        <span class="n">DaemonThread</span> <span class="n">daemonThread</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DaemonThread</span><span class="p">();</span>
        <span class="n">daemonThread</span><span class="p">.</span><span class="na">setDaemon</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>   <span class="c1">// 设置daemonThread为守护线程</span>
        <span class="n">daemonThread</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;MainThread , i = &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
            <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm">* 守护线程</span>
<span class="cm">*/</span>
<span class="kd">class</span> <span class="nc">DaemonThread</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="p">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">.</span><span class="na">run</span><span class="p">();</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;,i=&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>

            <span class="k">try</span> <span class="p">{</span>
                <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h3 id="_39">（八）线程状态<a class="headerlink" href="#_39" title="Permanent link">&para;</a></h3>
<p><img alt="" src="../img/ThreadState.png" /></p>
<p>官方文档中分为六种状态，不过<code>Runnable</code>状态又可以划分为<code>Ready</code>和<code>Running</code>状态。</p>
<p><strong>查看线程状态：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Index</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="p">{</span>
        <span class="n">ThreadB</span> <span class="n">threadB</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ThreadB</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">threadB</span><span class="p">.</span><span class="na">getState</span><span class="p">());</span>
        <span class="n">threadB</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>

        <span class="k">while</span> <span class="p">(</span><span class="n">threadB</span><span class="p">.</span><span class="na">getState</span><span class="p">()</span> <span class="o">!=</span> <span class="n">Thread</span><span class="p">.</span><span class="na">State</span><span class="p">.</span><span class="na">TERMINATED</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">threadB</span><span class="p">.</span><span class="na">getState</span><span class="p">());</span>
            <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">threadB</span><span class="p">.</span><span class="na">getState</span><span class="p">());</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">ThreadB</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">.</span><span class="na">run</span><span class="p">();</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">num</span><span class="o">++</span><span class="p">;</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;, num = &quot;</span> <span class="o">+</span> <span class="n">num</span><span class="p">);</span>

            <span class="k">try</span> <span class="p">{</span>
                <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="cm">/** 输出：</span>
<span class="cm">NEW</span>
<span class="cm">RUNNABLE</span>
<span class="cm">Thread-0, num = 1</span>
<span class="cm">TIMED_WAITING</span>
<span class="cm">Thread-0, num = 2</span>
<span class="cm">TIMED_WAITING</span>
<span class="cm">Thread-0, num = 3</span>
<span class="cm">TIMED_WAITING</span>
<span class="cm">Thread-0, num = 4</span>
<span class="cm">TIMED_WAITING</span>
<span class="cm">Thread-0, num = 5</span>
<span class="cm">TIMED_WAITING</span>
<span class="cm">TERMINATED</span>
<span class="cm">*/</span>
</code></pre></div>
</td></tr></table>
<h2 id="synchronized">十三、synchronized<a class="headerlink" href="#synchronized" title="Permanent link">&para;</a></h2>
<h3 id="_40">（一）线程同步<a class="headerlink" href="#_40" title="Permanent link">&para;</a></h3>
<p>保证数据在同一时刻最多只有一个线程访问；</p>
<p>即，当有一个线程在对内存进行操作时，其他线程不可以对内存进行操作，直到该线程执行完毕。</p>
<h3 id="_41">（二）用法<a class="headerlink" href="#_41" title="Permanent link">&para;</a></h3>
<ol>
<li>为对象加锁（非静态）</li>
</ol>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 同步代码块</span>
<span class="kd">synchronized</span><span class="p">(</span><span class="n">对象</span><span class="p">){</span>
    <span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// 同步方法</span>
<span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">method</span><span class="p">(</span><span class="n">String</span> <span class="n">name</span><span class="p">){</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<ol>
<li>对类加锁（静态）</li>
</ol>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 同步代码块</span>
<span class="kd">synchronized</span><span class="p">(</span><span class="n">类名</span><span class="p">.</span><span class="na">class</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// 同步方法</span>
<span class="kd">public</span> <span class="kd">synchronized</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">method</span><span class="p">(){</span>
    <span class="c1">// ....</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<ul>
<li>
<p>优先选择同步代码块；</p>
</li>
<li>
<p><strong>多个线程操作的必须是同一个锁对象</strong>，反例：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">class</span> <span class="nc">MyThread</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">method</span><span class="p">(){</span>
        <span class="kd">synchronized</span><span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="p">{</span>   <span class="c1">// 错误，该类会产生多个对象，this表示的不是同一个锁</span>
            <span class="c1">// ...</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
</li>
</ul>
<h3 id="_42">（三）锁分类<a class="headerlink" href="#_42" title="Permanent link">&para;</a></h3>
<h4 id="1_11">1. 互斥锁<a class="headerlink" href="#1_11" title="Permanent link">&para;</a></h4>
<ul>
<li>使用<code>synchronized</code>标记同一时刻只能有一个线程访问该对象；</li>
<li>会导致程序执行效率降低；</li>
<li>是非公平锁。</li>
</ul>
<h3 id="_43">（四）死锁<a class="headerlink" href="#_43" title="Permanent link">&para;</a></h3>
<p><strong>产生条件：</strong></p>
<ol>
<li>互斥：所竞争的资源必须互斥，不能共享；</li>
<li>请求与保持：保持当前已有资源，还能申请新的资源；</li>
<li>不剥夺：已获得的资源不能被抢占；</li>
<li>循环等待：至少两个进程形成循环等待。</li>
</ol>
<p><strong>模拟死锁：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DeadLock</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">MyDeadLock</span> <span class="n">myDeadLock1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyDeadLock</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
        <span class="n">MyDeadLock</span> <span class="n">myDeadLock2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyDeadLock</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>

        <span class="n">myDeadLock1</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
        <span class="n">myDeadLock2</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">MyDeadLock</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="p">{</span>
    <span class="c1">// 注意，资源一定要是共享的</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">Object</span> <span class="n">o1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="p">();</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">Object</span> <span class="n">o2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="p">();</span>

    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">flag</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">MyDeadLock</span><span class="p">(</span><span class="kt">boolean</span> <span class="n">flag</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">flag</span> <span class="o">=</span> <span class="n">flag</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">.</span><span class="na">run</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">flag</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">synchronized</span> <span class="p">(</span><span class="n">o1</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;=============== 1&quot;</span><span class="p">);</span>
                <span class="kd">synchronized</span> <span class="p">(</span><span class="n">o2</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;=============== 2&quot;</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="kd">synchronized</span> <span class="p">(</span><span class="n">o2</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;=============== 3&quot;</span><span class="p">);</span>
                <span class="kd">synchronized</span> <span class="p">(</span><span class="n">o1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;=============== 4&quot;</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/* 输出：</span>
<span class="cm">=============== 1</span>
<span class="cm">=============== 3</span>
<span class="cm">*/</span>
</code></pre></div>
</td></tr></table>
<h3 id="_44">（五）释放锁<a class="headerlink" href="#_44" title="Permanent link">&para;</a></h3>
<p><strong>释放锁的情况：</strong></p>
<ol>
<li>正常执行完毕同步代码块；</li>
<li>执行过程中遇到<code>break</code>或<code>return</code>；</li>
<li>出现未处理的<code>Error</code>或<code>Exception</code>；</li>
<li>同步代码块中执行了<code>wait()</code>方法，或其他线程执行了<code>join()</code>。</li>
</ol>
<p><strong>不会释放锁的情况：</strong></p>
<ol>
<li>调用<code>Thread.sleep()</code>或<code>Thread.yield()</code>；</li>
<li></li>
</ol>
<h3 id="_45">（六）实例<a class="headerlink" href="#_45" title="Permanent link">&para;</a></h3>
<h4 id="1_12">1. 例一<a class="headerlink" href="#1_12" title="Permanent link">&para;</a></h4>
<p>使用互斥锁解决问题，三个卖票窗口一起卖100张票。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Tickets</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">TicketThread</span> <span class="n">ticketThread</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TicketThread</span><span class="p">();</span> <span class="c1">// 只创建了一个对象，锁可以加在它身上</span>
        <span class="n">Thread</span> <span class="n">thread1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="p">(</span><span class="n">ticketThread</span><span class="p">);</span>
        <span class="n">Thread</span> <span class="n">thread2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="p">(</span><span class="n">ticketThread</span><span class="p">);</span>
        <span class="n">Thread</span> <span class="n">thread3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="p">(</span><span class="n">ticketThread</span><span class="p">);</span>

        <span class="n">thread1</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
        <span class="n">thread2</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
        <span class="n">thread3</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">TicketThread</span> <span class="kd">implements</span> <span class="n">Runnable</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>

    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">boolean</span> <span class="nf">sale</span><span class="p">()</span> <span class="p">{</span>    <span class="c1">// 为卖票功能加锁</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">num</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;卖完了...&quot;</span><span class="p">);</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">try</span> <span class="p">{</span>
            <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;,剩余票数：&quot;</span> <span class="o">+</span> <span class="o">--</span><span class="n">num</span><span class="p">);</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">boolean</span> <span class="n">flag</span> <span class="o">=</span> <span class="n">sale</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">flag</span><span class="p">)</span>
                <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h4 id="2_7">2. 例二<a class="headerlink" href="#2_7" title="Permanent link">&para;</a></h4>
<p>线程<code>A</code>打印<span><span class="MathJax_Preview">100</span><script type="math/tex">100</script></span>以内的随机整数，直到线程<code>B</code>接收到输入字符<code>Q</code>，结束打印。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Index</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">MyThreadB</span> <span class="n">myThreadB</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyThreadB</span><span class="p">();</span>
        <span class="n">myThreadB</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">MyThreadA</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">flag</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">.</span><span class="na">run</span><span class="p">();</span>

        <span class="k">while</span> <span class="p">(</span><span class="n">flag</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">Random</span> <span class="n">random</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="p">();</span>
            <span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="na">nextInt</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">num</span><span class="p">);</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;======================= A Quit!&quot;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setFlag</span><span class="p">(</span><span class="kt">boolean</span> <span class="n">flag</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">flag</span> <span class="o">=</span> <span class="n">flag</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">MyThreadB</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="n">MyThreadA</span> <span class="n">myThreadA</span><span class="p">;</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">.</span><span class="na">run</span><span class="p">();</span>

        <span class="n">myThreadA</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyThreadA</span><span class="p">();</span>
        <span class="n">myThreadA</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
        <span class="n">getKey</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">getKey</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">in</span><span class="p">);</span>
            <span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="n">scanner</span><span class="p">.</span><span class="na">next</span><span class="p">();</span>
            <span class="kt">char</span> <span class="n">ch</span> <span class="o">=</span> <span class="n">str</span><span class="p">.</span><span class="na">toUpperCase</span><span class="p">().</span><span class="na">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ch</span> <span class="o">==</span> <span class="sc">&#39;Q&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">myThreadA</span><span class="p">.</span><span class="na">setFlag</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;======================= B Quit!&quot;</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h2 id="io">十四、IO流<a class="headerlink" href="#io" title="Permanent link">&para;</a></h2>
<h3 id="_46">（一）文件<a class="headerlink" href="#_46" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 获取当前类所在的绝对路径</span>
<span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">类名</span><span class="o">&gt;</span><span class="p">.</span><span class="na">class</span><span class="p">.</span><span class="na">getResource</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">).</span><span class="na">getPath</span><span class="p">();</span>
</code></pre></div>
</td></tr></table>
<h4 id="1_13">1. 文件流<a class="headerlink" href="#1_13" title="Permanent link">&para;</a></h4>
<p><strong>输入流：</strong>从数据源到程序</p>
<p><strong>输出流：</strong>从成序到输入源</p>
<h4 id="2_8">2. 文件操作<a class="headerlink" href="#2_8" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 创建文件</span>
<span class="n">File</span> <span class="n">file1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="s">&quot;e:/背景/text.txt&quot;</span><span class="p">);</span>    <span class="c1">// 创建File对象</span>
<span class="n">file1</span><span class="p">.</span><span class="na">createNewFile</span><span class="p">();</span>  <span class="c1">// 通过对象创建文件</span>

<span class="n">File</span> <span class="n">file2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="s">&quot;e:/背景/&quot;</span><span class="p">,</span> <span class="s">&quot;text.txt&quot;</span><span class="p">);</span>
<span class="n">file2</span><span class="p">.</span><span class="na">createNewFile</span><span class="p">();</span>

<span class="n">File</span> <span class="n">dir</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="s">&quot;e:/背景/&quot;</span><span class="p">);</span>
<span class="n">File</span> <span class="n">file3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span> <span class="s">&quot;text.text&quot;</span><span class="p">);</span>
<span class="n">file3</span><span class="p">.</span><span class="na">createNewFile</span><span class="p">();</span>

<span class="c1">// 操作文件</span>
<span class="n">file</span><span class="p">.</span><span class="na">getName</span><span class="p">();</span> <span class="c1">// 文件名</span>
<span class="n">file</span><span class="p">.</span><span class="na">getAbsolutePath</span><span class="p">();</span> <span class="c1">// 文件绝对路径</span>
<span class="n">file</span><span class="p">.</span><span class="na">getParent</span><span class="p">();</span>   <span class="c1">// 文件父级目录</span>
<span class="n">file</span><span class="p">.</span><span class="na">length</span><span class="p">();</span>  <span class="c1">// 文件大小（字节）</span>
<span class="n">file</span><span class="p">.</span><span class="na">exists</span><span class="p">();</span>  <span class="c1">// 文件是否存在s</span>
<span class="n">file</span><span class="p">.</span><span class="na">isFile</span><span class="p">();</span>  <span class="c1">// 是否为文件</span>
<span class="n">file</span><span class="p">.</span><span class="na">delete</span><span class="p">();</span> <span class="c1">// 删除文件/目录，返回是否删除成功（目录只能删最后一级）</span>

<span class="c1">// 操作目录</span>
<span class="n">file</span><span class="p">.</span><span class="na">isDirectory</span><span class="p">();</span> <span class="c1">// 是否为目录</span>
<span class="n">dir</span><span class="p">.</span><span class="na">mkdir</span><span class="p">();</span>    <span class="c1">// 创建单级目录</span>
<span class="n">dir</span><span class="p">.</span><span class="na">mkdirs</span><span class="p">();</span>   <span class="c1">// 创建多级目录</span>
</code></pre></div>
</td></tr></table>
<h3 id="io_1">（二）IO流分类<a class="headerlink" href="#io_1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>（抽象基类）</th>
<th>字节流</th>
<th>字符流</th>
</tr>
</thead>
<tbody>
<tr>
<td>输入流</td>
<td>InputStream</td>
<td>Reader</td>
</tr>
<tr>
<td>输出流</td>
<td>OutputStream</td>
<td>Writer</td>
</tr>
</tbody>
</table>
<p><strong>字节流</strong>适用于图片、视频、音频等二进制文件，能够进行无损传输；</p>
<p><strong>字符流</strong>适用于文本传输，效率高。</p>
<p>（传输一个字符相当于多少字节，这取决于文件的编码方式）</p>
<h4 id="1-inputstreamoutputstream">1. InputStream与OutputStream<a class="headerlink" href="#1-inputstreamoutputstream" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>抽象类，是所有字节输入输出流的超类</p>
</li>
<li>
<p>常用子类：</p>
</li>
<li>
<p><code>FileInputStream</code>/<code>FileOutputSteam</code>：文件输入/输出流</p>
</li>
<li><code>BufferInputStream</code>/<code>BufferOutputSteam</code>：缓冲字节输入/输出流</li>
<li><code>ObjectInputStream</code>/<code>ObjectOutputSteam</code>：对象字节输入/输出流</li>
</ul>
<p><img alt="" src="../img/InputStream.png" /></p>
<h5 id="1fileinputstream">（1）FileInputStream<a class="headerlink" href="#1fileinputstream" title="Permanent link">&para;</a></h5>
<p><strong>单个字节读取：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">file</span> <span class="o">=</span> <span class="s">&quot;e:/背景/text.txt&quot;</span><span class="p">;</span>
<span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="k">try</span> <span class="p">{</span>
    <span class="n">inputStream</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">read</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="c1">// 按字节读取，返回int类型的字节码，-1表示文件结束</span>
    <span class="k">while</span> <span class="p">((</span><span class="n">read</span> <span class="o">=</span> <span class="n">inputStream</span><span class="p">.</span><span class="na">read</span><span class="p">())</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span> 
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">((</span><span class="kt">char</span><span class="p">)</span> <span class="n">read</span><span class="p">);</span>  <span class="c1">// 转成char显示</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="n">inputStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>    <span class="c1">// 关闭输入流，需要try-catc包裹</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><strong>一次性读取多个字节：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;e:/背景/text.txt&quot;</span><span class="p">;</span>
<span class="n">FileInputStream</span> <span class="n">fileInputStream</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="k">try</span> <span class="p">{</span>
    <span class="n">fileInputStream</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
    <span class="kt">byte</span><span class="o">[]</span> <span class="n">buf</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">8</span><span class="o">]</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="c1">// 传入byte数组，返回读取到的长度，返回-1表示文件结束</span>
    <span class="k">while</span> <span class="p">((</span><span class="n">len</span> <span class="o">=</span> <span class="n">fileInputStream</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">buf</span><span class="p">))</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// 使用byte数组转String，注意要传入长度，文件末的内容可能不足8个</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="k">new</span> <span class="n">String</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">len</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="n">fileInputStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>    <span class="c1">// 关闭文件输入流</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h5 id="2fileoutputstream">（2）FileOutputStream<a class="headerlink" href="#2fileoutputstream" title="Permanent link">&para;</a></h5>
<p><strong>单个字节写入：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;e:/背景/output.txt&quot;</span><span class="p">;</span>
<span class="n">FileOutputStream</span> <span class="n">fileOutputStream</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

<span class="k">try</span> <span class="p">{</span>
    <span class="c1">// 以覆盖的方式写入文件</span>
    <span class="n">fileOutputStream</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileOutputStream</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
    <span class="n">String</span> <span class="n">words</span> <span class="o">=</span> <span class="s">&quot;Hello,FileOutputStream!&quot;</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">words</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fileOutputStream</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">words</span><span class="p">.</span><span class="na">charAt</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
    <span class="p">}</span>

<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="n">fileOutputStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><strong>多个字节写入：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;e:/背景/output.txt&quot;</span><span class="p">;</span>
<span class="n">FileOutputStream</span> <span class="n">fileOutputStream</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

<span class="k">try</span> <span class="p">{</span>
    <span class="c1">// true表示以追加的方式写入文件</span>
    <span class="n">fileOutputStream</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileOutputStream</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="n">String</span> <span class="n">words</span> <span class="o">=</span> <span class="s">&quot;Hello,FileOutputStream!\n&quot;</span><span class="p">;</span>
    <span class="n">fileOutputStream</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">words</span><span class="p">.</span><span class="na">getBytes</span><span class="p">());</span>   <span class="c1">// String转为字节码写入</span>
    <span class="n">fileOutputStream</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">words</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="c1">//写入前5个字节</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="n">fileOutputStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h5 id="3_2">（3）文件复制<a class="headerlink" href="#3_2" title="Permanent link">&para;</a></h5>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">srcPath</span> <span class="o">=</span> <span class="s">&quot;e:/背景/text.txt&quot;</span><span class="p">;</span>
<span class="n">String</span> <span class="n">decPath</span> <span class="o">=</span> <span class="s">&quot;e:/背景/text2.txt&quot;</span><span class="p">;</span>
<span class="n">FileInputStream</span> <span class="n">fileInputStream</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="n">FileOutputStream</span> <span class="n">fileOutputStream</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

<span class="k">try</span> <span class="p">{</span>
    <span class="n">fileInputStream</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="p">(</span><span class="n">srcPath</span><span class="p">);</span>
    <span class="n">fileOutputStream</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileOutputStream</span><span class="p">(</span><span class="n">decPath</span><span class="p">);</span>

    <span class="kt">byte</span><span class="o">[]</span> <span class="n">buf</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1024</span><span class="o">]</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">((</span><span class="n">len</span> <span class="o">=</span> <span class="n">fileInputStream</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">buf</span><span class="p">))</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fileOutputStream</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="n">fileInputStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="n">fileOutputStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h4 id="2-readerwriter">2. Reader与Writer<a class="headerlink" href="#2-readerwriter" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>抽象类，是所有字符输入输出流的超类</p>
</li>
<li>
<p>常用子类：</p>
</li>
<li>
<p><code>FileReader</code>/<code>FileWriter</code>：文件输入/输出流</p>
</li>
<li><code>BufferReader</code>/<code>BufferWriter</code>：缓冲字符输入/输出流</li>
<li><code>StringReader</code>/<code>StringWriter</code>：字符串输入/输出流</li>
</ul>
<h5 id="1filereader">（1）FileReader<a class="headerlink" href="#1filereader" title="Permanent link">&para;</a></h5>
<p><strong>单个字符读入：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;e:/背景/text.txt&quot;</span><span class="p">;</span>
<span class="n">FileReader</span> <span class="n">fileReader</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

<span class="k">try</span> <span class="p">{</span>
    <span class="n">fileReader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileReader</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">read</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">((</span><span class="n">read</span> <span class="o">=</span> <span class="n">fileReader</span><span class="p">.</span><span class="na">read</span><span class="p">())</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">((</span><span class="kt">char</span><span class="p">)</span> <span class="n">read</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="n">fileReader</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><strong>多个字符读入：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;e:/背景/text.txt&quot;</span><span class="p">;</span>
<span class="n">FileReader</span> <span class="n">fileReader</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

<span class="k">try</span> <span class="p">{</span>
    <span class="n">fileReader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileReader</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
    <span class="kt">char</span><span class="o">[]</span> <span class="n">ch</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="o">[</span><span class="mi">8</span><span class="o">]</span><span class="p">;</span>    <span class="c1">// 使用char数组接收</span>
    <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">((</span><span class="n">len</span> <span class="o">=</span> <span class="n">fileReader</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">ch</span><span class="p">))</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// 文件末尾不一定长度为8，因此一定要按照读取的长度len输出为String</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="k">new</span> <span class="n">String</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">len</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="n">fileReader</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h5 id="2filewriter">（2）FileWriter<a class="headerlink" href="#2filewriter" title="Permanent link">&para;</a></h5>
<p><strong>单个字节写入：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;e:/背景/output.txt&quot;</span><span class="p">;</span>
<span class="n">FileWriter</span> <span class="n">fileWriter</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

<span class="k">try</span> <span class="p">{</span>
    <span class="n">fileWriter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileWriter</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="s">&quot;\nHello,FileWriter&quot;</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">str</span><span class="p">.</span><span class="na">length</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fileWriter</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">str</span><span class="p">.</span><span class="na">charAt</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="n">fileWriter</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><strong>多个字节写入：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;e:/背景/output.txt&quot;</span><span class="p">;</span>
<span class="n">FileWriter</span> <span class="n">fileWriter</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

<span class="k">try</span> <span class="p">{</span>
    <span class="n">fileWriter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileWriter</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="s">&quot;\nHello,FileWriter&quot;</span><span class="p">;</span>
    <span class="n">fileWriter</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
    <span class="n">fileWriter</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="n">fileWriter</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><strong>Writer的write()底层是由OutputStream实现的：</strong></p>
<p><img alt="" src="../img/FileWriter_write.png" /></p>
<h5 id="3_3">（3）文件复制<a class="headerlink" href="#3_3" title="Permanent link">&para;</a></h5>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">srcPath</span> <span class="o">=</span> <span class="s">&quot;e:/背景/text.txt&quot;</span><span class="p">;</span>
<span class="n">String</span> <span class="n">decPath</span> <span class="o">=</span> <span class="s">&quot;e:/背景/text2.txt&quot;</span><span class="p">;</span>
<span class="n">FileWriter</span> <span class="n">fileWriter</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="n">FileReader</span> <span class="n">fileReader</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

<span class="k">try</span> <span class="p">{</span>
    <span class="n">fileReader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileReader</span><span class="p">(</span><span class="n">srcPath</span><span class="p">);</span>
    <span class="n">fileWriter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileWriter</span><span class="p">(</span><span class="n">decPath</span><span class="p">);</span>

    <span class="kt">char</span><span class="o">[]</span> <span class="n">ch</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="o">[</span><span class="mi">1024</span><span class="o">]</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">((</span><span class="n">len</span> <span class="o">=</span> <span class="n">fileReader</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">ch</span><span class="p">))</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fileWriter</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="n">fileReader</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="n">fileWriter</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h3 id="_47">（三）节点流和处理流<a class="headerlink" href="#_47" title="Permanent link">&para;</a></h3>
<p><strong>节点流：</strong>从特定数据源读写数据，是底层流；</p>
<p><strong>处理流（包装流）：</strong>通过装饰器模式对节点流进行了包装，并对其功能进行了扩展；它可以消除不同节点流之间的差异，不会与数据源直接相连。</p>
<p><img alt="" src="../img/%E8%8A%82%E7%82%B9%E6%B5%81%E5%92%8C%E5%8C%85%E8%A3%85%E6%B5%81.png" /></p>
<p><strong>包装流的装饰器模式：</strong></p>
<p><code>BufferedReader</code>继承自<code>Reader</code>，同时它又封装了一个<code>Reader</code>对象，对<code>Reader</code>的功能进行了扩展。<code>BufferedWriter</code>、<code>BufferedInputStream</code>、<code>BufferedOutputStream</code>的结构同理。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BufferedReader</span> <span class="kd">extends</span> <span class="n">Reader</span><span class="p">{</span>
    <span class="kd">private</span> <span class="n">Reader</span> <span class="n">in</span><span class="p">;</span>
    <span class="c1">// ...</span>
<span class="p">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BufferedWriter</span> <span class="kd">extends</span> <span class="n">Writer</span><span class="p">{</span>
    <span class="kd">private</span> <span class="n">Writer</span> <span class="n">out</span><span class="p">;</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p>装饰器模式的类图和代理模式一样，区别在于代理模式是让别的类代为执行自己的功能，而装饰器模式是对原有功能进行了扩展。</p>
<h4 id="1-bufferedreaderbufferedwriter">1. BufferedReader与BufferedWriter<a class="headerlink" href="#1-bufferedreaderbufferedwriter" title="Permanent link">&para;</a></h4>
<h5 id="1bufferedreader">（1）BufferedReader<a class="headerlink" href="#1bufferedreader" title="Permanent link">&para;</a></h5>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;e:/背景/text.txt&quot;</span><span class="p">;</span>
<span class="n">BufferedReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="p">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="p">(</span><span class="n">path</span><span class="p">));</span>
<span class="n">String</span> <span class="n">line</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="k">while</span> <span class="p">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">reader</span><span class="p">.</span><span class="na">readLine</span><span class="p">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// 按行读取效率高</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">reader</span><span class="p">.</span><span class="na">close</span><span class="p">();</span> <span class="c1">// 底层实现了对Reader对象的close</span>
</code></pre></div>
</td></tr></table>
<h5 id="2bufferedwriter">（2）BufferedWriter<a class="headerlink" href="#2bufferedwriter" title="Permanent link">&para;</a></h5>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;e:/背景/output.txt&quot;</span><span class="p">;</span>
<span class="n">BufferedWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedWriter</span><span class="p">(</span><span class="k">new</span> <span class="n">FileWriter</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="kc">true</span><span class="p">));</span>
<span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="s">&quot;Hello, BufferedWriter!&quot;</span><span class="p">;</span>
<span class="n">writer</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
<span class="n">writer</span><span class="p">.</span><span class="na">newLine</span><span class="p">();</span>   <span class="c1">// 换行</span>
<span class="n">writer</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span>
<span class="n">writer</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span>
<span class="n">writer</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div>
</td></tr></table>
<h5 id="3_4">（3）文件复制<a class="headerlink" href="#3_4" title="Permanent link">&para;</a></h5>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">srcPath</span> <span class="o">=</span> <span class="s">&quot;e:/背景/text.txt&quot;</span><span class="p">;</span>
<span class="n">String</span> <span class="n">decPath</span> <span class="o">=</span> <span class="s">&quot;e:/背景/text2.txt&quot;</span><span class="p">;</span>

<span class="n">BufferedReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="p">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="p">(</span><span class="n">srcPath</span><span class="p">));</span>
<span class="n">BufferedWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedWriter</span><span class="p">(</span><span class="k">new</span> <span class="n">FileWriter</span><span class="p">(</span><span class="n">decPath</span><span class="p">));</span>

<span class="n">String</span> <span class="n">line</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="k">while</span> <span class="p">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">reader</span><span class="p">.</span><span class="na">readLine</span><span class="p">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">writer</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
    <span class="n">writer</span><span class="p">.</span><span class="na">newLine</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">reader</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
<span class="n">writer</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div>
</td></tr></table>
<h4 id="2-objectinputstreamobjectoutputstream">2. ObjectInputStream与ObjectOutputStream<a class="headerlink" href="#2-objectinputstreamobjectoutputstream" title="Permanent link">&para;</a></h4>
<p>用于将对象保存到文件中，包括对象的数据与类型。</p>
<p><strong>序列化：</strong>保存数据的值和类型，可用接口：<code>Serializable</code>和<code>Externalization</code>。</p>
<p><strong>反序列化：</strong>恢复数据的值和类型。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 实现了Serializable的类</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Person</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Kun&quot;</span><span class="p">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">age</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">job</span> <span class="o">=</span> <span class="s">&quot;灯台御史&quot;</span><span class="p">;</span>    <span class="c1">// 类中的对象也必须被序列化</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">nation</span><span class="p">;</span> <span class="c1">// static不会被序列化</span>
    <span class="kd">private</span> <span class="kd">transient</span> <span class="n">String</span> <span class="n">color</span><span class="p">;</span> <span class="c1">// transient不会被序列化</span>

    <span class="c1">// 序列化版本号，修改类的内容后不会认为是一个新类，而是原来类的升级版</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">Person</span><span class="p">(</span><span class="n">String</span> <span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">age</span><span class="p">,</span> <span class="n">String</span> <span class="n">job</span><span class="p">,</span> <span class="n">String</span> <span class="n">color</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">age</span> <span class="o">=</span> <span class="n">age</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">job</span> <span class="o">=</span> <span class="n">job</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;Person{&quot;</span> <span class="o">+</span>
                <span class="s">&quot;name=&#39;&quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="s">&quot;, age=&quot;</span> <span class="o">+</span> <span class="n">age</span> <span class="o">+</span>
                <span class="s">&quot;, job=&#39;&quot;</span> <span class="o">+</span> <span class="n">job</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="s">&quot;, nation&#39;&quot;</span> <span class="o">+</span> <span class="n">nation</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="s">&quot;, color=&#39;&quot;</span> <span class="o">+</span> <span class="n">color</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="sc">&#39;}&#39;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h5 id="1objectinputstream">（1）ObjectInputStream<a class="headerlink" href="#1objectinputstream" title="Permanent link">&para;</a></h5>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;e:/背景/object.txt&quot;</span><span class="p">;</span>
<span class="n">ObjectOutputStream</span> <span class="n">output</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectOutputStream</span><span class="p">(</span><span class="k">new</span> <span class="n">FileOutputStream</span><span class="p">(</span><span class="n">path</span><span class="p">));</span>
<span class="n">output</span><span class="p">.</span><span class="na">writeUTF</span><span class="p">(</span><span class="s">&quot;信息：&quot;</span><span class="p">);</span>
<span class="n">Person</span><span class="p">.</span><span class="na">nation</span> <span class="o">=</span> <span class="s">&quot;韩国&quot;</span><span class="p">;</span>
<span class="n">output</span><span class="p">.</span><span class="na">writeObject</span><span class="p">(</span><span class="k">new</span> <span class="n">Person</span><span class="p">(</span><span class="s">&quot;昆&quot;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s">&quot;灯台御史&quot;</span><span class="p">,</span> <span class="s">&quot;blue&quot;</span><span class="p">));</span>
<span class="n">output</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span>
<span class="n">output</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div>
</td></tr></table>
<h5 id="2objectinputstream">（2）ObjectInputStream<a class="headerlink" href="#2objectinputstream" title="Permanent link">&para;</a></h5>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;e:/背景/object.txt&quot;</span><span class="p">;</span>
<span class="n">ObjectInputStream</span> <span class="n">input</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectInputStream</span><span class="p">(</span><span class="k">new</span> <span class="n">FileInputStream</span><span class="p">(</span><span class="n">path</span><span class="p">));</span>
<span class="n">String</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">input</span><span class="p">.</span><span class="na">readUTF</span><span class="p">();</span>
<span class="n">Object</span> <span class="n">person</span> <span class="o">=</span> <span class="n">input</span><span class="p">.</span><span class="na">readObject</span><span class="p">();</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">person</span><span class="p">);</span>
<span class="n">input</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>

<span class="cm">/* 输出：</span>
<span class="cm">Person{name=&#39;昆&#39;, age=15, job=&#39;灯台御史&#39;, nation&#39;null&#39;, color=&#39;null&#39;}</span>
<span class="cm">*/</span>
</code></pre></div>
</td></tr></table>
<p>注意，<strong>反序列化的顺序</strong>一定要和<strong>序列化的顺序</strong>保持一致。</p>
<h5 id="3_5">（3）细节说明<a class="headerlink" href="#3_5" title="Permanent link">&para;</a></h5>
<ol>
<li>读写顺序要一致；</li>
<li>被序列化或反序列化的对象要实现<code>Serializable</code>接口；</li>
<li>序列化类中添加<code>SerialVersionUUID</code>能提高版本兼容性；</li>
<li><code>static</code>和<code>transient</code>成员是不会被序列化的；</li>
<li>序列化类中的属性都要实现序列化接口；</li>
<li>序列化有可继承性。</li>
</ol>
<h4 id="3-inputoutput">3. 标准输入输出流Input与Output<a class="headerlink" href="#3-inputoutput" title="Permanent link">&para;</a></h4>
<p>| 编译类型 | 运行类型 | 代表
---|---|---|---
<strong>System.in</strong>|<code>InputStream</code>类型|<code>BufferedInputStream</code>类型|键盘输入
<strong>System.out</strong>|<code>PrintStream</code>类型|<code>PrintStream</code>类型|显示器输出</p>
<h4 id="4-inputstreamreaderoutputstreamwriter">4. 转换流InputStreamReader与OutputStreamWriter<a class="headerlink" href="#4-inputstreamreaderoutputstreamwriter" title="Permanent link">&para;</a></h4>
<p><strong>InputStreamReader：</strong><code>Reader</code>的子类，可以将<code>InputStream</code>包装成<code>Reader</code>，即字节流转字符流。</p>
<p><img alt="" src="../img/InputStreamReader.png" /></p>
<p><strong>OutputStreamWriter：</strong><code>Writer</code>的子类，可以将<code>OutputStream</code>包装成<code>Writer</code>，即字节流转字符流。</p>
<p><img alt="" src="../img/OutputStreamReader.png" /></p>
<p>它们均可以指定编码格式（如：<code>utf-8</code>、<code>gbk</code>、<code>gb2312</code>、<code>ISO8895-1</code>），适用于处理不同编码的纯文本数据。</p>
<h5 id="1inputstreamreader">（1）InputStreamReader<a class="headerlink" href="#1inputstreamreader" title="Permanent link">&para;</a></h5>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;e:/背景/test_utf_8.txt&quot;</span><span class="p">;</span>
<span class="n">InputStreamReader</span> <span class="n">isReader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InputStreamReader</span><span class="p">(</span><span class="k">new</span> <span class="n">FileInputStream</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="s">&quot;utf-8&quot;</span><span class="p">);</span>
<span class="n">BufferedReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="p">(</span><span class="n">isReader</span><span class="p">);</span>
<span class="n">String</span> <span class="n">line</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="k">while</span> <span class="p">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">reader</span><span class="p">.</span><span class="na">readLine</span><span class="p">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">reader</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div>
</td></tr></table>
<h5 id="2outputstreamwriter">（2）OutputStreamWriter<a class="headerlink" href="#2outputstreamwriter" title="Permanent link">&para;</a></h5>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;e:/背景/test_utf_8.txt&quot;</span><span class="p">;</span>
<span class="n">OutputStreamWriter</span> <span class="n">osWriter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OutputStreamWriter</span><span class="p">(</span><span class="k">new</span> <span class="n">FileOutputStream</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="s">&quot;utf-8&quot;</span><span class="p">);</span>
<span class="n">BufferedWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedWriter</span><span class="p">(</span><span class="n">osWriter</span><span class="p">);</span>
<span class="n">String</span> <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Hello, 转换流!&quot;</span><span class="p">;</span>
<span class="n">writer</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
<span class="c1">// writer.flush();</span>
<span class="n">writer</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div>
</td></tr></table>
<h4 id="5-printstreamprintwriter">5. 打印流PrintStream与PrintWriter<a class="headerlink" href="#5-printstreamprintwriter" title="Permanent link">&para;</a></h4>
<p>打印流只有输出流，没有输入流。</p>
<h5 id="1printstream">（1）PrintStream<a class="headerlink" href="#1printstream" title="Permanent link">&para;</a></h5>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">PrintStream</span> <span class="n">out</span> <span class="o">=</span> <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">;</span>
<span class="n">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Hello，world!&quot;</span><span class="p">);</span>
<span class="n">out</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="s">&quot;呜呜&quot;</span><span class="p">.</span><span class="na">getBytes</span><span class="p">());</span> <span class="c1">// print的底层是write实现的，所以可以直接使用write</span>
<span class="n">out</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div>
</td></tr></table>
<p>设置输出位置：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">System</span><span class="p">.</span><span class="na">setOut</span><span class="p">(</span><span class="k">new</span> <span class="n">PrintStream</span><span class="p">(</span><span class="s">&quot;e:/背景/out.txt&quot;</span><span class="p">));</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Hello,PrintStream!&quot;</span><span class="p">);</span>
</code></pre></div>
</td></tr></table>
<h5 id="2printwriter">（2）PrintWriter<a class="headerlink" href="#2printwriter" title="Permanent link">&para;</a></h5>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">PrintWriter</span> <span class="n">printWriter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PrintWriter</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">);</span>
<span class="n">printWriter</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="s">&quot;Hello,PrintWriter!&quot;</span><span class="p">);</span>
<span class="n">printWriter</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div>
</td></tr></table>
<p>改变输出位置：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">PrintWriter</span> <span class="n">printWriter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PrintWriter</span><span class="p">(</span><span class="k">new</span> <span class="n">FileWriter</span><span class="p">(</span><span class="s">&quot;e:/背景/out.txt&quot;</span><span class="p">));</span>
<span class="n">printWriter</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="s">&quot;Hello,PrintWriter!&quot;</span><span class="p">);</span>
<span class="n">printWriter</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div>
</td></tr></table>
<h4 id="6-properties">6. Properties<a class="headerlink" href="#6-properties" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">BufferedReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="p">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="p">(</span><span class="s">&quot;e:/背景/mysql.properties&quot;</span><span class="p">));</span>
<span class="n">String</span> <span class="n">line</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="k">while</span> <span class="p">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">reader</span><span class="p">.</span><span class="na">readLine</span><span class="p">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">String</span><span class="o">[]</span> <span class="n">split</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="na">split</span><span class="p">(</span><span class="s">&quot;=&quot;</span><span class="p">);</span>   <span class="c1">// 按=划分</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">split</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">+</span> <span class="s">&quot;的值是：&quot;</span> <span class="o">+</span> <span class="n">split</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">reader</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div>
</td></tr></table>
<p><strong>其他常用方法：</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">load</span>
<span class="n">list</span>
<span class="n">getProperty</span>
<span class="n">setProperty</span>
<span class="n">store</span>
</code></pre></div>
</td></tr></table>
<p><strong>例一：</strong></p>
<p>读取<code>properties</code></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">Properties</span> <span class="n">properties</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Properties</span><span class="p">();</span>
<span class="n">properties</span><span class="p">.</span><span class="na">load</span><span class="p">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="p">(</span><span class="s">&quot;e:/背景/mysql.properties&quot;</span><span class="p">));</span>
<span class="n">properties</span><span class="p">.</span><span class="na">list</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">);</span>

<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;======================&quot;</span><span class="p">);</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;姓名：&quot;</span> <span class="o">+</span> <span class="n">properties</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">));</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;年龄：&quot;</span> <span class="o">+</span> <span class="n">properties</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="s">&quot;age&quot;</span><span class="p">));</span>

<span class="cm">/*</span>
<span class="cm">输出：</span>
<span class="cm">-- listing properties --</span>
<span class="cm">nation=Korea</span>
<span class="cm">name=kun</span>
<span class="cm">job=灯台使</span>
<span class="cm">age=15</span>
<span class="cm">======================</span>
<span class="cm">姓名：kun</span>
<span class="cm">年龄：15</span>
<span class="cm">*/</span>
</code></pre></div>
</td></tr></table>
<p><strong>例二：</strong></p>
<p>修改/添加新键值对</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">Properties</span> <span class="n">properties</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Properties</span><span class="p">();</span>

<span class="c1">// key不存在则创建新属性，否则修改</span>
<span class="n">properties</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="s">&quot;飒弥亚·伊沐洛·巴瑟兰&quot;</span><span class="p">);</span>
<span class="n">properties</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="s">&quot;age&quot;</span><span class="p">,</span> <span class="s">&quot;17&quot;</span><span class="p">);</span>
<span class="n">properties</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="s">&quot;袍级&quot;</span><span class="p">,</span> <span class="s">&quot;黑袍&quot;</span><span class="p">);</span>

<span class="n">properties</span><span class="p">.</span><span class="na">store</span><span class="p">(</span><span class="k">new</span> <span class="n">FileOutputStream</span><span class="p">(</span><span class="s">&quot;e:/背景/mysql2.properties&quot;</span><span class="p">),</span> <span class="s">&quot;comment messages&quot;</span><span class="p">);</span>
</code></pre></div>
</td></tr></table>
<h3 id="_48">（四）习题<a class="headerlink" href="#_48" title="Permanent link">&para;</a></h3>
<h4 id="1_14">1. 例一<a class="headerlink" href="#1_14" title="Permanent link">&para;</a></h4>
<ol>
<li>创建目录<code>mytemp</code></li>
<li>目录<code>mytemp</code>下创建文件<code>hello.txt</code></li>
<li>文件<code>hello.txt</code>中写入<code>Hello,world!</code></li>
</ol>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;e:/背景/mytemp/&quot;</span><span class="p">;</span>
<span class="n">File</span> <span class="n">dir</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">dir</span><span class="p">.</span><span class="na">exists</span><span class="p">())</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;mytemp文件夹已存在&quot;</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">dir</span><span class="p">.</span><span class="na">mkdir</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;目录创建成功&quot;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="p">(</span><span class="s">&quot;目录创建失败&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">String</span> <span class="n">filePath</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s">&quot;hello.txt&quot;</span><span class="p">;</span>
<span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">filePath</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">file</span><span class="p">.</span><span class="na">exists</span><span class="p">())</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;文件已存在&quot;</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">file</span><span class="p">.</span><span class="na">createNewFile</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;文件创建成功&quot;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="p">(</span><span class="s">&quot;文件创建失败&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">FileWriter</span> <span class="n">fileWriter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileWriter</span><span class="p">(</span><span class="n">filePath</span><span class="p">);</span>
<span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="s">&quot;Hello,world!&quot;</span><span class="p">;</span>
<span class="n">fileWriter</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
<span class="n">fileWriter</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div>
</td></tr></table>
<h4 id="2_9">2. 例二<a class="headerlink" href="#2_9" title="Permanent link">&para;</a></h4>
<p>读取文件，并在每一行前加上编号</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Index</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="p">{</span>
        <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;e:/背景/test.txt&quot;</span><span class="p">;</span>
        <span class="n">String</span> <span class="n">srcPath</span> <span class="o">=</span> <span class="s">&quot;e:/背景/test2.txt&quot;</span><span class="p">;</span>
        <span class="n">BufferedReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="p">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="p">(</span><span class="n">path</span><span class="p">));</span>
        <span class="n">BufferedWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedWriter</span><span class="p">(</span><span class="k">new</span> <span class="n">FileWriter</span><span class="p">(</span><span class="n">srcPath</span><span class="p">));</span>
        <span class="n">String</span> <span class="n">line</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">reader</span><span class="p">.</span><span class="na">readLine</span><span class="p">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">line</span><span class="p">);</span>
            <span class="n">writer</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">line</span><span class="p">);</span>
            <span class="n">writer</span><span class="p">.</span><span class="na">newLine</span><span class="p">();</span>
            <span class="o">++</span><span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">reader</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">writer</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<h4 id="3_6">3. 例三<a class="headerlink" href="#3_6" title="Permanent link">&para;</a></h4>
<ol>
<li><code>dog.properties</code>中创建名字、年龄、颜色三个属性</li>
<li>使用<code>Properties</code>读取，并打印；</li>
<li>将读取到的内容保存到<code>Dog</code>对象中，并序列化保存；</li>
<li>反序列化输出保存的内容。</li>
</ol>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Index</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="p">{</span>
        <span class="n">String</span> <span class="n">scrPath</span> <span class="o">=</span> <span class="s">&quot;e:/背景/dog.properties&quot;</span><span class="p">;</span>
        <span class="n">Properties</span> <span class="n">properties</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Properties</span><span class="p">();</span>
        <span class="n">properties</span><span class="p">.</span><span class="na">load</span><span class="p">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="p">(</span><span class="n">scrPath</span><span class="p">));</span>

        <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">properties</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">age</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">properties</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="s">&quot;age&quot;</span><span class="p">));</span>
        <span class="n">String</span> <span class="n">color</span> <span class="o">=</span> <span class="n">properties</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="s">&quot;color&quot;</span><span class="p">);</span>

        <span class="n">Dog</span> <span class="n">dog</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Dog</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">color</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">dog</span><span class="p">);</span>

        <span class="c1">// 序列化保存</span>
        <span class="n">String</span> <span class="n">decPath</span> <span class="o">=</span> <span class="s">&quot;e:/背景/dog.dat&quot;</span><span class="p">;</span>
        <span class="n">ObjectOutputStream</span> <span class="n">ooStream</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectOutputStream</span><span class="p">(</span><span class="k">new</span> <span class="n">FileOutputStream</span><span class="p">(</span><span class="n">decPath</span><span class="p">));</span>
        <span class="n">ooStream</span><span class="p">.</span><span class="na">writeObject</span><span class="p">(</span><span class="n">dog</span><span class="p">);</span>
        <span class="n">ooStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>

        <span class="c1">// 反序列化输出</span>
        <span class="n">ObjectInputStream</span> <span class="n">oiStream</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectInputStream</span><span class="p">(</span><span class="k">new</span> <span class="n">FileInputStream</span><span class="p">(</span><span class="n">decPath</span><span class="p">));</span>
        <span class="n">Object</span> <span class="n">dog2</span> <span class="o">=</span> <span class="n">oiStream</span><span class="p">.</span><span class="na">readObject</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">dog2</span><span class="p">);</span>
        <span class="n">oiStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>

    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">Dog</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="p">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">age</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">color</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">Dog</span><span class="p">(</span><span class="n">String</span> <span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">age</span><span class="p">,</span> <span class="n">String</span> <span class="n">color</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">age</span> <span class="o">=</span> <span class="n">age</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;Dog{&quot;</span> <span class="o">+</span>
                <span class="s">&quot;name=&#39;&quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="s">&quot;, age=&quot;</span> <span class="o">+</span> <span class="n">age</span> <span class="o">+</span>
                <span class="s">&quot;, color=&#39;&quot;</span> <span class="o">+</span> <span class="n">color</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="sc">&#39;}&#39;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
                
                  
                
                
                  
                  <hr>
                  <div class="md-source-date">
                    <small>
                      
                        最后更新: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">July 16, 2022 10:57:39</span>
                      
                    </small>
                  </div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Java%E5%9F%BA%E7%A1%80/" title="Java基础" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  上一页
                </span>
                Java基础
              </span>
            </div>
          </a>
        
        
          <a href="../Java%E9%AB%98%E7%BA%A7/" title="Java高级" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  下一页
                </span>
                Java高级
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/WOC-BUG" target="_blank" rel="noopener" title="github" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://github.com/YanhuiJessica" target="_blank" rel="noopener" title="github" class="md-footer-social__link fa fa-github"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c33a9706.js"></script>
      
        
        
          
          <script src="../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../assets/javascripts/lunr/lunr.ja.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.2.3",url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>